http://winhlp.com/node/16
HTTP/1.1 200 OK
Date: Thu, 24 Jul 2014 15:19:31 GMT
Server: Apache
Set-Cookie: SESS1937754657f0f6408b9a16f7d1962456=tun12arh3s3bkri1479ojq39g7; expires=Sat, 16-Aug-2014 18:52:51 GMT; path=/; domain=.winhlp.com
Expires: Sun, 19 Nov 1978 05:00:00 GMT
Last-Modified: Thu, 24 Jul 2014 15:19:31 GMT
Cache-Control: store, no-cache, must-revalidate
Cache-Control: post-check=0, pre-check=0
X-Powered-By: PleskLin
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 50274
Connection: close
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>Systray icons missing | Windows Problem Solver</title>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/files/favicon.ico" type="image/x-icon" />
 <link type="text/css" rel="stylesheet" media="all" href="/modules/aggregator/aggregator.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/poll/poll.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system-menus.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/forum/forum.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/comment/comment.css?m" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/newspaper/style.css?m" />
 <script type="text/javascript" src="/misc/jquery.js?m"></script>
<script type="text/javascript" src="/misc/drupal.js?m"></script>
<script type="text/javascript" src="/sites/all/modules/poormanscron/poormanscron.js?m"></script>
<script type="text/javascript" src="/misc/tableheader.js?m"></script>
<script type="text/javascript" src="/sites/all/themes/newspaper/commentlink.js?m"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "cron": { "basePath": "/poormanscron", "runNext": 1406217480 } });
//--><!]]>
</script>
 <!--script type="text/javascript"> </script-->
</head>
<body class="not-front not-logged-in page-node node-type-forum two-sidebars">

  <div id="header">
        <a href="/"><img src="/files/logo.png" alt="Home" class="logo" /></a>
    
        <form action="/node/16"  accept-charset="UTF-8" method="post" id="search-theme-form">
<div><div id="search" class="container-inline">
  <div class="form-item" id="edit-search-theme-form-1-wrapper">
 <label for="edit-search-theme-form-1">Search this site: </label>
 <input type="text" maxlength="128" name="search_theme_form" id="edit-search-theme-form-1" size="15" value="" title="Enter the terms you wish to search for." class="form-text" />
</div>
<input type="submit" name="op" id="edit-submit-2" value="Search"  class="form-submit" />
<input type="hidden" name="form_build_id" id="form-nyVBF3McCBtvKtIN64-XYXy2164QWXnBP_CcPVWSXj4" value="form-nyVBF3McCBtvKtIN64-XYXy2164QWXnBP_CcPVWSXj4"  />
<input type="hidden" name="form_id" id="edit-search-theme-form" value="search_theme_form"  />
</div>

</div></form>
    
        <h1 class="site-name"><a href="/">Windows Problem Solver&#x20;</a></h1>
    
        <p class="site-slogan">Open information exchange</p>
    
        <div class="navigation">
            <div class="navigation-primary">
        <ul class="links"><li class="menu-113 first"><a href="/node/17" title="General help, standard procedures, and instructions on how to use this interactive web site. New user help.">Start</a></li>
<li class="menu-81"><a href="/tracker" title="All new information, latest at the top. If you have created an account for yourself, you get those messages tagged (&quot;new&quot;, &quot;updated&quot;) that you have not yet read.">Recent posts</a></li>
<li class="menu-50"><a href="/blog" title="Read users&#039; private blogs.">Blogs</a></li>
<li class="menu-58"><a href="/forum" title="Discussion forums - the main content of the web site">Forums</a></li>
<li class="menu-93 last"><a href="/sitemap" title="Complete table of contents of this web site including RSS feeds">Site map</a></li>
</ul>      </div>
      
          </div>
    
      </div>
  <table id="main" class="clear-block">
  <tr>
        <td id="left-sidebar" class="sidebar"><div id="block-user-1" class="block block-user">
    <div class="title">Navigation</div>
  
  <div class="content"><ul class="menu"><li class="leaf first"><a href="/node/142" title="Chat with other users about any topic in real-time or in the chat forum.">Chat</a></li>
<li class="collapsed"><a href="/aggregator">News ticker</a></li>
<li class="leaf"><a href="/poll">Polls</a></li>
<li class="collapsed last"><a href="/search">Search</a></li>
</ul></div>
</div>

<div id="block-statistics-0" class="block block-statistics">
    <div class="title">Popular content</div>
  
  <div class="content"><div class="item-list"><h3>Today's:</h3><ul><li class="first"><a href="/node/10">DMA reverts to PIO</a></li>
<li><a href="/node/16" class="active">Systray icons missing</a></li>
<li><a href="/node/488">How does one restore a &#039;desktop&#039; when it is displayed as a solid blue screen, with cursor only?</a></li>
<li><a href="/node/39">Cannot delete file or folder</a></li>
<li><a href="/node/40">Not enough server storage</a></li>
<li><a href="/node/77">Registry</a></li>
<li><a href="/node/125">Windows XP Service Pack 2/3 Problem Solver</a></li>
<li><a href="/node/858">How digital detectives deciphered Stuxnet</a></li>
<li><a href="/node/598">Sign in Username and password do not match.</a></li>
<li class="last"><a href="/node/180">ForFiles - delete old files, etc.</a></li>
</ul></div></div>
</div>

<div id="block-forum-0" class="block block-forum">
    <div class="title">Active forum topics</div>
  
  <div class="content"><div class="item-list"><ul><li class="first"><a href="/node/916" title="1 comment">Middle button not working</a></li>
<li><a href="/node/915">How to Prolong Lithium-based Batteries</a></li>
<li><a href="/node/914" title="1 comment">using forfiles</a></li>
<li><a href="/node/912">Email addresses in postings</a></li>
<li><a href="/node/911" title="1 comment">System restore problem in XP</a></li>
<li><a href="/node/910" title="1 comment">Sharing</a></li>
<li><a href="/node/909">Desktop Management</a></li>
<li><a href="/node/908" title="1 comment">USB Problem On Windows XP</a></li>
<li><a href="/node/907">Welches Android-Smartphone sollte ich im Jahr 2014 kaufen?</a></li>
<li class="last"><a href="/node/16" title="149 comments" class="active">Systray icons missing</a></li>
</ul></div><div class="more-link"><a href="/forum" title="Read the latest forum topics.">more</a></div></div>
</div>

<div id="block-comment-0" class="block block-comment">
    <div class="title">Recent comments</div>
  
  <div class="content"><div class="item-list"><ul><li class="first"><a href="/node/916#comment-2636">Google Chrome?</a><br />4 weeks 3 days ago</li>
<li><a href="/node/914#comment-2635">Deleting folders is different.</a><br />6 weeks 3 days ago</li>
<li><a href="/node/911#comment-2634">Repair installation</a><br />13 weeks 2 days ago</li>
<li><a href="/node/910#comment-2632">File and folder access rights</a><br />19 weeks 6 hours ago</li>
<li><a href="/node/908#comment-2631">Hardware defect?</a><br />24 weeks 3 days ago</li>
<li><a href="/node/16#comment-2630" class="active">Windows 7</a><br />35 weeks 3 days ago</li>
<li><a href="/node/10#comment-2629">Unbelievably useful and helpful post</a><br />35 weeks 4 days ago</li>
<li><a href="/node/16#comment-2628" class="active">windows 7</a><br />38 weeks 2 hours ago</li>
<li><a href="/node/16#comment-2627" class="active">Windows 7</a><br />38 weeks 3 days ago</li>
<li class="last"><a href="/node/16#comment-2626" class="active">Systray icons missing</a><br />38 weeks 4 days ago</li>
</ul></div></div>
</div>

<div id="block-user-2" class="block block-user">
    <div class="title">Who's new</div>
  
  <div class="content"><div class="item-list"><ul><li class="first">SloppyGoat</li>
<li>gillypalm</li>
<li>Leftie</li>
<li>Katarina</li>
<li class="last">dgutman</li>
</ul></div></div>
</div>

<div id="block-user-3" class="block block-user">
    <div class="title">Who's online</div>
  
  <div class="content">There are currently <em>0 users</em> and <em>11 guests</em> online.</div>
</div>

<div id="block-block-6" class="block block-block">
  
  <div class="content"><p style="font-size: smaller"><script type="text/javascript" language="javascript" src="/counter/?page=winhlp.com"></script> hits since 2010-03-12 · <a href="/plesk-stat/webstat/">Statistics</a><br />
<a href="http://phpjunkyard.com/">Free PHP scripts by PHPJunkYard.com</a></p>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2492100-2");
pageTracker._initData();
pageTracker._trackPageview();
</script></div>
</div>

<div id="block-system-0" class="block block-system">
  
  <div class="content"><a href="http://drupal.org"><img src="/misc/powered-blue-80x15.png" alt="Powered by Drupal, an open source content management system" title="Powered by Drupal, an open source content management system" width="80" height="15" /></a></div>
</div>

</td>
    
    <td id="page">
            <div class="breadcrumb"><a href="/">Home</a> » <a href="/forum">Forums</a> » <a href="/forum/15">Software</a> » <a href="/forum/16">Windows</a></div>      
      
      
      
            <h1 class="title">Systray icons missing</h1>
      
      
      
      <div id="node-16" class="node node-forum">

  <div class="picture">
  </div>

  
    <span class="date">Sun, 2007-07-15 21:05</span>
  <span class="author"> by admin</span>
  
    <span class="terms"> &#183; Forum/category:&#x20;<ul class="links inline"><li class="taxonomy_term_16 first"><a href="/forum/16" rel="tag" title="Windows-related topics that do not fit in any other forum">Windows</a></li>
<li class="taxonomy_term_23 last"><a href="/taxonomy/term/23" rel="tag" title="Problems related to the system tray, also called notification area, which carries icons and is usually located in the end of the task bar (typically in the lower right of the screen)">Systray</a></li>
</ul></span>
  
  <div class="content">
<div style="float: right; width: 40%; border: 1px solid #8ad; margin: 0.5em 0 0.2em 0.5em; padding-right: 0.2em; padding-bottom: 0.7em;">
<p style="margin-bottom: 0; padding-bottom: 0; text-align: center; font-weight: bold; color: darkblue">Table of contents</p>
<p style="margin-top: 0; padding-top: 0; text-align: center; font-size: smaller; color: darkblue">for this article</p>
<ul>
<li><a href="#The_Problem">The Problem</a></li>
<li><a href="#Main_problem_and_complete_solution">Main problem and complete solution</a></li>
<li><a href="#Task_Manager_problems">Task Manager problems</a></li>
<li><a href="#Two_simple_workarounds">Two simple workarounds</a></li>
<li><a href="#The_most_successful_workarounds">The most successful workarounds</a></li>
<li><a href="#Cannot_create_shell_notification_icon">Cannot create shell notification icon</a></li>
<li><a href="#Other_known_triggers">Other known triggers</a></li>
<li><a href="#Other_possible_triggers_and_workarounds">Other possible triggers and workarounds</a></li>
<li><a href="#Closing_remarks">Closing remarks</a></li>
<li><a href="#Comments_vote">Comments, vote, attachment</a></li>
</ul>
</div>
<p><a href="/node/96">Result statistics</a>&#151;please report your results.</p>
<h1><a id="The_Problem" name="The_Problem">The Problem</a></h1>
<h2>General</h2>
<p>The system tray (in short: systray, nowadays also called taskbar notification area) 
is the icon strip normally located near the right end of the task bar, next to 
the clock.</p>
<p>Some Windows XP installations show a peculiar defect in that some systray icons 
disappear or, rather, do not appear, when the system is booted and the user logs 
on. The problem is even more prevalent on systems with autologon. The most frequently 
affected icons seem to be the speaker icon (sound volume) and the power/energy 
icon.</p>
<p>Please note that the problem has been completely solved. You can find the solution in the next chapter, <a href="#Main_problem_and_complete_solution">Main problem and complete solution</a>.
<h2>Hide inactive icons</h2>
</p><p>This has nothing to do with the hide inactive icons settings. The defect shows 
up when you don't have any icons set for hiding.</p>
<p>In any case, please make sure for now that you haven't activated that setting. 
Right-click the task bar, click on Properties, uncheck the last check box. You 
can reactivate it later if all other problems are identified or solved.</p>
<p>In Vista, if the Clock, Network, Volume and Power icons have disappeared and
when you go into properties on the taskbar and look at "System Icons" under the
"Notification Area" tab, Volume, Network, and Power are greyed out, then visit
<a href="http://www.paulsxp.com/forum/viewtopic.php?f=16&t=152">Paul's Forum</a>
and run his fixing program.</p>
<p>2006-08-14 – Glenn S. reminds us that, if other icons disappear for good and 
never reappear, we should check first whether the programs are started at all.</p>
<p>Check your Startup folder and the starter registry entries through Start, Run..., 
type: msconfig, press Enter, to check whether the programs are really started 
at system start, or use Task Manager (Ctrl + Shift + Esc) to see whether the processes 
are running.</p>
<h2>Sound volume</h2>
<p>A particular and special problem is that only the sound volume icon disappears, 
but the others are there. In this case the main solutions below will not work. 
Instead you have to look at the sound driver. Try to reinstall it. But first read 
the chapter &quot;Other known causes&quot; further below for some specific symptoms and 
solutions.</p>
<h2>Task Manager</h2>
<p>There are a few other problems that can cause similar behavior and can mislead 
you into believing that they are the same problem. If you are not sure, read the 
entire article first, because a few more are described later. The ones concerning 
Task Manager are described in the next chapter, because they can be too easily 
mistaken for the main problem described in the other chapters.</p>
<h2>Entire taskbar</h2>
<p>If, however, your entire taskbar or any major part of it is missing altogether, 
then the rest of this article is irrelevant to you. Instead the Kelly's Korner 
tool <a href="http://www.kellys-korner-xp.com/taskbarplus!.htm">Taskbar Plus!</a> 
may or may not help you. I don't know what exactly it does and can only recommend 
to use it carefully and to use only the function that pertains to solve your immediate 
problem, then test the result.</p>
<h2>UPnP and some general remarks</h2>
<p>Often, but not always, the phenomenon of the missing systray icons seems to be
triggered by the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> User Interface, but more on that later. (By the way, don't mistake
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> for <a href="http://www.webopedia.com/TERM/P/plug_and_play.html">PnP</a>, 
Plug-n-Play, which is mostly a different thing.)</p>
<p>Microsoft has not taken notice. The causes are obscure. Some users report successes 
with various changes that influence the boot and logon timing, but these changes 
do not reliably solve the problem. Often they make the problem occur less often 
though and make it bearable.</p>
<p>Be careful not to be fooled by others or by your own brain that may see causality 
where there is none. People try the weirdest things, then they get all their icons 
and conclude sharply, but wrongly, that whatever they did solved the problem. 
About the weirdest and totally wrong recommendation I have seen was to switch 
off your computer and let it sit without power for three hours. Don't fall into 
such a trap. The web has a lot of snake oil, particularly in relation to the problem 
of the disappearing systray icons.</p>
<p>Then there is the fact that some change solves the problem, just by changing 
the boot and logon process sequence or timing a little bit. Thus I receive hundreds 
of emails, detailing ever more different solutions to the problem, each of which 
has been tried and worked on one computer. We have to suspect that each of these 
many solutions works only on a few computers. If defragmenting the hard disk can 
solve the problem for some, then anything can solve it, and the solution may not 
be long-lived either.</p>
<h1><a id="Main_problem_and_complete_solution">Main problem and complete solution</a></h1>
<p>2010-10-09 &ndash; <a href="/user/3651">nars</a> has posted a <a href="#comment-2246">patcher tool</a> (<a href="http://nars.aloj.net/download/shell32patch.zip">direct download link</a>, also attached here—see below) that solves the problem even for future versions and makes patching very easy and quick. Thanks a lot, <a href="/user/3651">nars</a>!</p>
<p>The main cause of the more common problem is that the systray program 
is temporarily unable to process icon inclusion requests. An earlier 
hypothesis, that systray.exe is loaded too late, has been refuted by Thomas 
Gregory Platt (see his email below).</p>
<p>According to the excellent analysis in the
<a href="/node/16#comment-406">Problem analysis and proposed solution</a> comment by
<a href="/user/868" title="View user profile.">tasmanian</a> this is caused by a timing
defect in the Windows function Shell_NotifyIcon in shell32.dll, which has a timeout fixed
at 4 seconds. Combined with an unfavorable Windows API message this causes the
problem, which befalls many heavily loaded computers that don't have ultra-fast hard
disks. Changing the timeout to one minute and removing the unwanted message solves
the problem, and in the <a href="/node/16#comment-822">Complete solution</a> comment user <a href="/user/1618" title="View user profile.">depassp</a> has perfected the
procedure of patching shell32.dll to solve the problem, at least until a new version of
that DLL is delivered by Microsoft that re-introduces the problem and requires another
patch session. In fact, exactly this has happened around July 2010, but the solution is already here: <a href="#comment-2155">Offsets for NEW 6.0.2900.6018 file</a> by <a href="/user/3428">mcrealize</a>, corrected by <a href="/user/3466">TeaRex</a></p>
<p>Unfortunately patching a system DLL is not an entirely simple procedure and can only be done with a certain minimum of computer handling experience, but this is the best we can offer for now.</p>
<h1><a id="Task_Manager_problems" name="Task_Manager_problems">Task Manager problems</a></h1>
<p>A few special problems concern the Task Manager and its systray icon only, 
the green one that dynamically shows the CPU load. If your problem is the disappearing 
Task Manager icon, then read on. If, however, other systray icons disappear as 
well, then you should first skip this chapter and continue with the next.</p>
<p>Mike Newhall contributed the following information on 2005-12-10. Thanks a 
lot, Mike!</p>
<p>One problem is the disappearance of the Task Manager systray symbol when you 
start Task Manager the second time or subsequent times.</p>
<p>This problem appears to be related to the Classic desktop theme. When you change 
your desktop to the XP style, the problem no longer occurs. Do this for a test.</p>
<p>The cause is as yet unknown. The simplest workaround is to never close Task 
Manger.</p>
<p>Another problem is that the icon or the entire Task Manager never appears at 
all. This can be caused by a registry setting that is not present in a default 
installation:</p>
<blockquote>
  <p>HKEY_CURRENT_USER<br />
&nbsp;\Software<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \System<br />
&quot;DisableTaskMgr&quot;=dword:00000001</p>
</blockquote>
<p>You can set this value to zero or, to recreate the default situation, remove 
the value entirely. To have the value removed automatically,
<a href="/tools/task_manager_enable.reg">click here</a> and give permission when 
asked.</p>
<p>In fact, the entire System key does not exist in a default installation, so 
you can even delete that key if you are sure there's nothing in it that you need.</p>
<h1><a id="Two_simple_workarounds" name="Two_simple_workarounds">Two simple workarounds</a></h1>
<p>If any of these solve your problem,
<a href="/node/96">please report here</a>.</p>
<h2>Log off, log on again</h2>
<p>Now we're getting back to the main problem, the sporadic missing of various 
icons, particularly after the first logon after booting. Typically missing are 
the power icon or the sound volume icon, but many others can be affected just 
as well.</p>
<p>The immediate workaround is to log off and log on again (do not reboot, only 
log off). In many cases the icons then reappear. If not, you can try to repeat 
the procedure until you have all of them.</p>
<p>If this works, then most likely you have the central problem described in this 
article.</p>
<h2>Wait a minute!</h2>
<p>The other workaround is, the next time you boot your computer, wait for a full 
minute after the logon dialog appears or, better, watch the hard disk light and 
wait until disk activity subsides entirely for at least 5 seconds. Only then log 
on and check whether this solves your problem.</p>
<p>On two of my computers this solves the problem entirely, even though other 
workarounds, like the systray_cleanup.reg file mentioned below, don't work. This 
also means that you have to log on as quickly as possible when you're trying to 
test other workarounds.</p>
<p>2006-02-03 – Eric Maier mentioned that you can only delay the logon when you 
have at least two active user profiles to log on to, or one with a password. If 
you have neither, the logon prompt wouldn't appear, and there would be no delay.</p>
<p>And, as a final remark, retest from time to time whether the problem has
disappeared on its own, particularly after installing a service pack.</p>
<h1><a id="The_most_successful_workarounds" name="The_most_successful_workarounds">The most successful workarounds</a></h1>
<div style="float: right; width: 45%; border: 1px solid #200060; padding: 0 0.1em 0.1em 0.5em; margin: 1em 0 0.1em 0.5em; font-size: 88%">
  <p style="font-weight: bold">Some excerpts from the many earlier mails I have received (for later responses see <a href="#Comments_vote">Comments, vote</a> below)</p>
  <p>Wow, after over a year of having this problem. And general 
  slow/buggy operation of winxp. I finally reinstalled, only to have the same 
  problem on a clean machine (made even worse by SP2 this time). Weeks of steady 
  research into this problem and I came across your page ... I disabled upnp almost 
  2 weeks ago and have had no problems with my computer since. This has solved 
  strange out of memory errors, dialog boxes missing buttons, and many other strange 
  issues. I don't know why it happens on my particular hardware, and the solution 
  does not make _any_ sense, but it solved it.</p>
  <p>I have tried virtually every so-called &quot;fix&quot; I could find online, 
  and NONE of them worked, until today, when someone pointed me to your site. 
  I tried the &quot;uninstall the UPnP User Interface&quot; fix, and am happy to report 
  that it worked. All tray icons appeared on reboot.<br />
  I have had an ongoing dialogue with Microsoft Tech Support about this situation, 
  and they seem absolutely clueless. Needless to say, my next email to them will 
  report the fix.</p>
  <p>Thanks for the very helpful and time saving article I found 
  on the internet</p>
  <p>Amazing that the solution from Francesco Saverio Ostuni, such 
  an obscure and seemingly unrelated setting would restore the icons to the system 
  tray. My hat is off to him.<br />
  Now if only the setting to hide inactive icons would work I would be pleased 
  indeed.<br />
  Thank you for helping to save what little hair I have.</p>
  <p>Thank you so much for your web page on solving the disappearing 
  system tray icons problem. I've looked all over the internet for advice on how 
  to solve the problem and what you wrote was the only thing I found that worked!</p>
  <p>I am very glad to read your article concerning the Systray 
  problem. I have been struggling with exactly the same problem for long and Microsoft 
  could not get at any reasonable solution.<br />
  On the net ... I found the trick removing &quot;UPnP User Interface&quot; from Windows 
  Components and and that worked perfect: everything in the Systray is now in 
  perfect order.</p>
  <p>UPnP worked for me! Thanks to all. It was driving me crazy 
  ...</p>
  <p>The Ostuni Workaround<br />
  Worked fine on a quite a few ( ~ 10 ) Dell GX110's with AC97 audio, we use at 
  work - Thanks for posting this info</p>
  <p>This article was a relief to me - I thought I was the only 
  one suffering from &quot;disappearing icons&quot;.</p>
  <p>After years of having my systray icons disappear and playing 
  with very limited success with msconfig, disabling services and re-installing 
  apps and numerous rebuilds…….<br />
  I tried the Ostuni Workaround, and all of my icons instantly came back and are 
  now stable !!!!<br />
  Very happy !</p>
  <p>The UPnP suggestion worked for me, amazingly. I have no idea 
  how something so seemingly unrelated could cause such an annoying and difficult 
  to diagnose problem, but many thanks for posting this info on your site!</p>
  <p>Great! This problem was driving me crazy since over one year 
  and most people didn&#39;t even understand what the issue was. Now it works perfectly 
  and I&#39;m really grateful for this tip! Thanks a lot.</p>
  <p>This problem has been bugging me off and on for many months, 
  and none of my computer savvy friends and associates could offer any practical 
  solutions (I figured FDISK was a bit over the top). However, a Google search 
  brought up about 352,000 hits - and yours was the second.<br />
  I applied the Ostuni Workaround this evening and my errant icons have returned. 
  Many thanks to all contributors.</p>
  <p>Thanks for putting together this page. The Ostuni Workaround 
  lives up to the hype. You've ended months of frustration and computer problems!</p>
  <p>Thanks for your article on this, tried the Ostuni method and 
  it totally resolved my missing icons on reboot. Many reboots later no more missing 
  icons. Quite brilliant.</p>
  <p>I want to thank you for your website and the solution to my 
  missing systray icons. It is a very rare occasion that I google to an immediate 
  solution (you were number one using &quot;systray icon missing&quot;!). Usually these 
  sort of problems are a month long search.<br />
  For the record, the UPnP solution worked ... and brought back the speaker icon 
  as well! This was on a Gateway P4 laptop.<br />
  I like people that help others. You just saved my Saturday so I can have fun.<br />
  Thanks again.</p>
  <p>very very useful<br />
  worked first time<br />
  ? why has microsoft not fixed disappearing icons in one of their many sp's and 
  upgrades</p>
  <p>Tried the Ostuni Workaround, so far it's solved the problem.<br />
  My god man, THANK YOU for providing this information. I was about ready to do 
  like that duck with the hammer you always see on people's desks...</p>
  <p>Man, if I hadn't found your site I would have gone crazy over 
  this. It's the most anoying I've ever experienced.<br />
  But then I found your site and <br />
  <span style="font-weight: bold">The Ostuni Workaround</span><br />
  I have never been happier in my life (well thats not entierly true), but anyway 
  it works fine!<br />
  Thanks for a great site!</p>
  <p>The Ostuni workaround is awesome. I have been trying to figure 
  this out for ages, since I had XP home and it seems to have carried over to 
  XP Pro and it is so annoying. I love having a full system tray, and now with 
  this somewhat fix, it has worked for me!! Like a dream come true, :-)<br />
  Thanks So Much, [...]<br />
  P.S. It works, it really really works!! ;)</p>
  <p>Many thanks for this. The Ostuni workaround worked for me. 
  It was driving me crazy! Great help!!!!</p>
  <p>The Ostuni Workaround did work for me 100%. I had that problem 
  for months and it was getting worse … finally decided to try to fix it today 
  and found your page … my 10 icons are now showing up at every reboot.<br />
  Thank you very much for your page!</p>
  <p>My good-man Hans,<br />
  I want to thank you so much for having this page online! I was getting so annoyed 
  about those missing icons in the system tray. I used <span style="font-weight: bold">The 
  Ostuni Workaround</span> simply by going to My Network Places and then clicking 
  on Hide UPnP Devices. A simple restart and everything was there. Normally I 
  had to kill the 'missing-icon' programs and restart them. And some of them you 
  can't kill with Task Manager, e.g. ZoneAlarm Pro v6.1.737 [zlclient.exe]. Or 
  another trick I did was logging off and back on. Most of the time it restored 
  all icons, but not always. So:<br />
  Thank you so much! You really made my day.</p>
  <p>I've tried the systray.reg script and the vbs hack that 
  delays the startup to avoid &quot;unable to create shell notification icon&quot; error. 
  Both tricks seem to have worked just fine!<br />
  The systray.reg has restored the always missing volume icon as well as the occasionally 
  missing outlook icon (outlook is started automatically &quot;minimized to tray&quot; on 
  system startup).<br />
  The delay trick works excellent with Asus Probe.<br />
  This is absolutely brilliant!<br />
  Thanks a lot!</p>
</div>
<h2>Rooting out the problem&#151;patching shell32.dll</h2>
<p>Oour users cooperated to find and program the fundamental solution to the problem.
The cause has been determined as a defect in shell32.dll, a Windows component. Please see <a href="#Main_problem_and_complete_solution">Main problem and complete solution</a> above.</p>
<h2>The Ostuni Workaround</h2>
<p>2004-11-11 – Francesco Saverio Ostuni wrote: &quot;... I found a solution for me 
that works perfectly. I simply went to My network Places and on the left pane 
I chose to Hide
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> devices. This operation does not disable the service (which I need).&quot;</p>
<p>To see this choice, you have to have Tools, Folder Options, Show Common Tasks 
selected.</p>
<p>This is still one of the most successful and not very intrusive workarounds, 
so you could try it first. I keep getting emails stating that the Ostuni Workaround 
worked well and solved the problem.</p>
<p>See also the subchapter on some more details below.</p>
<h2>Cleaning up the registry</h2>
<p>The following text contains links to registry setting files, which, except 
for the first one, are a bit stronger than the straight Ostuni workaround. If 
you want to check what they do before actually applying them, you can right-click 
on the link and elect to save the file to your hard disk. Then you can open it 
with a text editor like the Windows notepad editor and see what they do.</p>
<p>After two emails (see emails from Mark Medrano and Ingo Schupp below), the 
suspicion grows that the PastIconsStream registry entry can grow beyond proportions 
and hinder the systray icons. The solution is to click on
<a href="/tools/systray_cleanup.reg">systray_cleanup.reg</a>, confirm the execution, 
then confirm the registry change, <span style="font-weight: bold">reboot your computer</span> 
and test.</p>
<p>These registry entries can safely be deleted, because Windows automatically 
recreates them after the next two reboots. By the way, this registry file does 
about the same as running systray.reg and then systray_undo.reg (see below).</p>
<p>2007-01-16 – Thanks to Haris J. S. for the following information: This and 
the fixes below reset the inactive icons timers, so for some time like a week 
or two there will be no inactive icons. They will come back later on their own.</p>
<h2>More radical: stop UPnP services</h2>
<p>If the workarounds described don't work for you for any reason, read on. Before 
we go into the details, if you still want a quick solution and don't mind that 
a few settings, including any Explorer policies, are reset to their defaults, 
you can click on <a href="/tools/systray.reg">systray.reg</a>, confirm the execution, 
then confirm the registry change, <span style="font-weight: bold">reboot your computer</span> 
and test. Unlike the softer Ostuni workaround this disables both services, SSDP 
and
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a>, altogether and also cleans up the registry as described above. Since 
the Windows Media Player network sharing service depends on the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> service, it also gets stopped, so if you need that, you cannot use this 
workaround.</p>
<p>If this still doesn't cut the bill, you can try this stronger one:
<a href="/tools/systray_plus.reg">systray_plus.reg</a>, and again confirm, reboot, 
and test. However, the old poll results show that few users actually did this successfully,
so we may consider this workaround undesirable and not waste time on it. I leave it here
just in case somebody wants to experiment with it.</p>
<p>You need to do this only once. The changed registry settings are permanent, 
until you undo them.</p>
<p>If none of the above works for you or if you later need the UPnP services, 
you can undo the nonstandard changes and reset them to their defaults with
<a href="/tools/systray_undo.reg">systray_undo.reg</a>, but note that any previously 
removed non-standard settings, like Explorer policies, cannot be reinstated. In 
a normal installation there shouldn't be any such settings. A reboot is again 
required to make the change effective.</p>
<p>If you've tried these, <a href="/node/96">please report here</a>
which one worked or didn't work for you. Please try them in the order below, like this:</p>
<ol>
  <li>Apply the file by double-clicking on it and giving permission for the change.</li>
  <li><span style="font-weight: bold">Reboot</span>, log on.</li>
  <li>Check whether all icons are there.</li>
</ol>
<p>Please test more than just once if the problem is sporadic. It is important 
for all of us to also learn which one didn't work.</p>
<p>Results from since 2006-11-10:</p>
<ul>
  <li>systray_cleanup.reg : 16</li>
  <li>systray.reg : 13 (earlier reports: 26)</li>
  <li>systray_plus.reg : 1 (earlier reports: 3)</li>
  <li>neither, i.e. both failed : 0 (earlier reports: 1)</li>
</ul>
<p>If you want to know what these files do or if you just want to keep them, you 
can store them by right-clicking on the above links and choose to save the target 
on your computer. Then you can open each file with the Notepad editor (Open with 
...) and, if you like, make the registry changes by hand. They do a bit more than 
what is described below. The minus signs in the files indicate deletions.</p>
<h2>A new program</h2>
<p>Alex Milner has written the new program
<a href="http://am.vghost.ru/TrayIconsOK.zip">TrayIconsOK!</a>, downloadable from
<a href="http://am.vghost.ru/">http://am.vghost.ru/</a>, which purportedly solves 
the problem permanently (but not the sound volume problem). Thanks, Alex! The 
program delays desktop loading by some adjustable seconds, and that seems to do 
the trick for many installations, but not for all.</p>
<p>This is shareware with a single-digit $ price. The unregistered version is 
fully functional for 30 days and has a nag screen. You can test it thoroughly 
before having to pay up.</p>
<p>If you've tried this program, <a href="/node/96">please report here</a>
if it worked for you. Older results of 2007-02-06 to 2007-07-21:</p>
<ul>
<li>It works: 8 reports</li>
<li>It doesn't work: 6 reports</li>
</ul>
<h2>The Diez Workaround</h2>
<p>2006-06-30 – Steve Kreideweiss wrote from Cairns, Australia: &quot;I tested the 
tip from Jose Luis Diez setting SSDP and UpnP to Automatic. This seems to work 
fine for me as well. I was wondering why it was on Manual at all?&quot;</p>
<p>So please read the hint from Jose Luis Diez below or just read on. Apparently 
this changes the boot and logon timing enough on some computers to make things 
work. On one of my computers just setting the SSDP service start type to automatic 
did actually solve the problem.</p>
<p>Here's the quick way to test it. Click on the desired setting, then confirm 
as often as needed, then <span style="font-weight: bold">reboot</span> and test.</p>
<p>Change settings to automatic:</p>
<ul>
  <li><a href="/tools/ssdp_automatic.reg">ssdp_automatic.reg</a> (test this first)</li>
  <li><a href="/tools/upnp_automatic.reg">upnp_automatic.reg</a></li>
</ul>
<p>Change them back to their default setting of manual:</p>
<ul>
  <li><a href="/tools/ssdp_manual.reg">ssdp_manual.reg</a></li>
  <li><a href="/tools/upnp_manual.reg">upnp_manual.reg</a></li>
</ul>
<p>You have to <span style="font-weight: bold">reboot</span> each time to apply the settings 
and test.
</p><p>If any variant of the Diez workaround solved your problem,
<a href="/node/96">please report here</a>.</p>
<p>Emails received before 2007-07-21:</p>
<ul>
  <li>ssdp_automatic.reg – 3 successes, 1 failure</li>
  <li>Both – 2 successes, 3 failures</li>
</ul>
<p>Unfortunately the statistics don't look too good. If we don't get a number 
of successes soon, this subsection will have to disappear. But read also the following:</p>
<p>2006-10-11 – J. L. Heath wrote:</p>
<blockquote>
  <p>I solved the problem using your page by 1st doing the Ostuni workaround (hiding 
  UPnP) and then clicking on both Diez automatic links, and rebooting.</p>
  <p>I think the key might be doing both workarounds in succession, instead of 
  one or the other.</p>
  <p>Worked like a charm-- thanks!&nbsp; J.</p>
</blockquote>
<h2>More details of the Ostuni Workaround</h2>
<p>Francesco Ostuni further mentioned that the same can be done through Control 
Panel, Add or Remove Programs, on the left side: Add/Remove Windows components; 
select Networking Services, click on the Details... button, remove the checkmark 
for the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> User Interface, then click on OK. The result is the same. Now the icons 
are back every time at each reboot.</p>
<p>This has meanwhile been confirmed by many other users and consistently kept 
a success rate of well over 90%, so we can conclude that this solves the problem 
on all but the most unusual Windows XP installations.</p>
<p>Thanks, Francesco, in the name of the many systray users you've made happy!</p>
<p>Apparently this option is only there after Service Pack 2 is installed. I'm 
not sure whether and how this would work in Windows XP installations without SP2.</p>
<p>It is as yet unclear what exactly the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> User Interface does, beside opening two ports. Any information is welcome.</p>
<p>Several people including myself suspect that the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> interface does not directly cause the problem, instead there seems to 
be something wrong with the load order or timing. Perhaps the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> interface hogs the system in a way that blocks the systray for too long 
on some computers.</p>
<p>2005-03-13 – Volker Severt wrote that a side effect of having the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> User Interface installed already makes the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> devices visible, namely that the relevant ports are opened in the firewall. 
If you uninstall the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> User Interface, these ports are automatically closed, but you can reopen 
them by hand. They are TCP 2869, subnet, and UDP 1900, subnet. Thus you can still 
have the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> devices visible.</p>
<p>2005-06-15 – Jose Luis Diez wrote the following intriguing email (see also 
the subchapter &quot;Diez workaround&quot; above for the short step by step instructions).</p>
<blockquote>
  <p>I had been dealing with this problem for a week and followed all the hints 
  in your page to no avail. I followed the Ostuni workaround and it didn't help 
  either. (SSDP and
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> were already disabled.)</p>
  <p>I tried the Startright program and it worked great. I highly recommend that 
  program.</p>
  <p>Hoewever, I got bored about having an extra loader and kept playing with 
  the settings and guess what. I turned SSDP and
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> to Automatic under Administrative Tools -&gt; Services and IT FIXED THE 
  PROBLEM. :D</p>
  <p>Funny thing is that I have uninstalled Internet Gateway and
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> under Windows Components uninstall but the
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> still shows in the Services settings under Administrative Tools.</p>
  <p>All in all very strange.</p>
  <p>After playing with my system for a while I agree and I'm 100% sure that the 
  problem of the icons disapearing is due to the systray not ready to place the 
  icons when the application loads. SSDP and
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> just fix this by a collateral of changing the way things boot.</p>
</blockquote>
<p>2005-07-17 – Michael Fornoff wrote:</p>
<blockquote>
  <p>The Ostuni Workaround worked for me too! </p>
  <p>It seems that it solved another problem too: when I activated a network connection 
  (plugging in the network cable, opening a dialup or a VPN connection) very often 
  the explorer was locked for about 2 to 5 minutes. I had already found out, that 
  it was sending UPnP requests over the network at that time, but did not really 
  know what to do, as simply disabling the UPnP service did not help.</p>
  <p>&quot;Hide UPnP devices&quot; in &quot;My Network Places&quot; did it. It solved both problems: 
  the missing tray icons and the temporary system lock nearly every time I connect 
  to a network.</p>
</blockquote>
<p>2005-07-18 – M. D. Harper wrote:</p>
<blockquote>
  <p>This definitely seems to be a startup sequencing/timing problem. I did the 
  &quot;Ostuni Workaround&quot; my icons came back and I stopped getting a driver failed 
  to start error when my PCI Latency Tool tries to change the PCI devices' latency 
  automatically on startup (I previously had to start the program manually after 
  the computer starts and apply the new settings).</p>
</blockquote>
<p>2005-10-15 – Drystan Brod wrote:</p>
<blockquote>
  <p>I was intrigued by all the references to the UPnP service on your web page—I 
  always disable it as part of installing windows and didn't think that would 
  be my problem. I checked anyway and was rather irritated to discover that it 
  had been misteriously re-enabled, possibly by a windows &quot;security update&quot;. Seconds 
  later, using Steve Gibson's UnPlug n' Pray utility (which is free from
  <a href="http://www.grc.com/">www.grc.com</a>) the problem was solved. Please 
  find room on your web page to pass on my recommendation of this excellent tool.</p>
</blockquote>
<p>Done, but instead of using a big, obscure program, you can just as well use 
the tiny, open-source systray.reg registry script to stop the UPnP services (see 
above), or you can even disable them by hand in less time than it takes you to 
download the program.</p>
<p>2005-10-19 – Richard (Rick) Murphy wrote:</p>
<blockquote>
  <p>I just wanted to say &quot;Thanks&quot; for the info on the Systray Icons Missing page. 
  This has been bugging me for months and I finally decided to try and solve it 
  – found your page and bingo!</p>
  <p>You might like to know that to completely solve the problem, I combined two 
  methods.</p>
  <p>(1) I used the Ostuni method, utilising the GRC &quot;unpnp&quot; tool recommended 
  by Drystan Brod. This brought back the &quot;loudspeaker&quot; sound icon and a few others.</p>
  <p>(2) Then I used the (fantastic) tool by Cliff Cawley &quot;Startup Delayer&quot; 
 (<a href="http://www.r2.com.au/software.php?show=startdelay">http://www.r2.com.au/software.php?show=startdelay</a>) to 
  put delays in for &quot;non essential&quot; items such as Seti at Home, Yahoo Messenger, 
  Backup Exec, Bluetooth, Skype, DynDns and the like, delaying these by upto 2 
  minutes after startup and spacing the delays by 10 seconds.</p>
  <p>This brought back everything!</p>
  <p>I'm so pleased that I've sent you a donation, something I've never done for 
  any other &quot;free advice&quot; site (as they usually have mediocre advice).</p>
  <p>Thanks again!</p>
</blockquote>
<p>Thank you too, Rick, for your good report and, of course, for the generous 
donation!</p>
<p>2006-04-03 – D.K. Kraft wrote:</p>
<blockquote>
  <p>Greetings from Lynnwood, WA USA —</p>
  <p>I'm e-mailing with a success story for r2 Studios' Startup Delayer (<a href="http://www.r2.com.au/software.php?show=startdelay">http://www.r2.com.au/software.php?show=startdelay</a>) for a 
  self-built dual-core (AMD) computer put together Dec. 2005, running Win XP Pro 
  SR2 and all recent patches. All went swimmingly until around the end of March 
  2006, when certain program icons supposed to show up in the system tray began 
  not loading at boot, usually in groups of three. After much frustration uninstalling 
  and reinstalling, Google (is my friend; yes, I should remember that) provided 
  the background on this weird and <span style="font-weight: bold">very</span> annoying Win 
  XP bug.</p>
  <p>After no success whatsoever from the registry hacks and the manual log-in 
  method, I tried Startup Delayer with a jaundiced eye, thinking that delaying 
  loading of just the four programs in my Startup folder wouldn't do much good. 
  I was very pleasantly surprised to find that the program could take over control 
  of <span style="font-weight: bold">all</span> startup programs. Delaying my Startup folder 
  programs along with one program controlled by a registry entry, plus a delay 
  to load my antivirus software <span style="font-weight: bold">last</span> did the trick. 
  The initial delay before the first program allows SystemTray to get going and 
  deal with the basics, and <span style="font-weight: bold">then</span> it's able to properly 
  bring up those icons for subsequent programs. I think the key is to have Startup 
  Delayer delay only as many programs as needed to allow others to load their 
  icons properly. I'm fairly certain my antivirus software (GMHB Avira AntiVir) 
  was hogging resources from the get-go that prevented a number of icons from 
  being loaded—including its own!</p>
  <p>Now, all ten icons show up in the system tray. Additionally, Startup Delayer's 
  small graphic bar gives me time to kill certain programs at boot if I just don't 
  need them to load for whatever reason. I'm very grateful to r2 Studios for making 
  this nifty little program available as freeware, given that the two alternatives 
  I found cost $20-$25. Would that everyone else could achieve icon happiness 
  with this program. As they say, it did the trick. ;-D</p>
  <p>Purrs — D.K. &quot;Cat&quot; Kraft</p>
</blockquote>
<p>D.K., thanks for the good information and the nice story!</p>
<p>2006-04-20 – Dwayne Osbaldeston wrote that disabling the two services solved 
the systray problem, but also disabled a Palm Pilot hotsync function. He was able 
to get that to work again by reserving a fixed IP address for the computer and 
using that for hotsyncing.</p>
<p>2006-04 – In some web forums it was reported that Windows Live OneCare (WOC, 
WLOC) or Defender triggered the problem, but the above workarounds worked for 
them.</p>
<p>If disabling the
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a> service altogether solves the systray icon problem, but you needed
  <a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
  UPnP</a>, you can work around it by using a fixed IP address and opening 
ports on the router directly. If you use a router that allows you to assign a fixed IP address to a certain 
computer (by MAC address), fine. If not, simply give the computer a fixed address 
outside the router's DHCP range.</p>
<h2>Analysis of possible causes—PastIconStreams and timing</h2>
<p>2006-11-10 – Mark Medrano sent in the following intriguing information. Please 
note that the newer file <a href="/tools/systray_cleanup.reg">systray_cleanup.reg</a> 
already cleans out the big registry entries he mentions, so try this first and 
move on to the more severe <a href="/tools/systray.reg">systray.reg</a> only if 
the former fails to solve the problem. Here is Mark's email:</p>
<blockquote>
  <p>I just wanted to write in. I've been having problems getting systray icons 
  to appear (power, sound, and recently Ultramon which was giving an error). I 
  ran across your page searching for an answer and started to pick through it. 
  I already had UPnP disabled, so I moved on to the first registry file (systray.reg). 
  For various reasons I ended up going through it manually and was surprised when 
  I got to the &quot;PastIconsStream&quot; key that it was positively huge. So long that 
  I could not scroll to the bottom of the &quot;edit binary data&quot; window (each time 
  it would snap back up to the top for some bizarre reason).</p>
  <p>I manually deleted about 1/4 of the screen at a time (as much as it would 
  let me scroll the window) until I could select the rest of it and erase it entirely. 
  On a hunch I stopped there and lo and behold everything comes up perfectly again. 
  I suspect that at least in my case that key was just grown way beyond what was 
  expected for it's size. I suspect sys tray icons that change frequently may 
  be a contributer (like wireless card settings) or applications that create tray 
  icons only when they're running (ffdshow filters for instance, sometimes if 
  a system filter is used by a game I can see 30 or 40 of these icons in the tray 
  at once, usually they disappear before the game exits and you'ld never see them), 
  perhaps even applications that use the tray for active notification, like color 
  coded icons and the like, I'm not entirely sure, but I do think that most of 
  the people who have written in that Systray.reg worked for them probably only 
  needed to drop the &quot;PastIconsStream&quot; key. I will be sure to keep an eye on it, 
  though it's taken 2 1/2 years for the problem to occur originally, so I don't 
  expect it'll be happening again soon :)</p>
</blockquote>
<p>2006-11-16 – Ingo Schupp confirms this as follows:</p>
<blockquote>
  <p>Thank you very much for your fine work with the webpage concerning the disappeared 
  systray icons. I can only confirm what Mark Medrano wrote on 2006-11-10: the 
  critical registry entry actually seems to be &quot;PastIconsStream&quot;.</p>
  <p>I tried manually deactivating SSDP and UPnP before, which did not work for 
  me. Then, I wanted to manually edit my registry entries one by one, starting 
  with the aforementioned one, but after logging out and in again directly after 
  this, the icons reappeared! This was not the case before - a break alone did 
  not do the trick.</p>
</blockquote>
<p>2006-12-15 – James Covington sent these Microsoft support instructions, some 
of which overlap information already given on this web page. But he wrote that 
this procedure always fixed the missing icons problem for some time, then needed 
to be repeated.</p>
<blockquote>
  <ol>
    <li>Run regedit: click on Start &gt; click on Run &gt; type: regedit</li>
    <li>Navigate to<br />
    HKEY_CURRENT_USER<br />
&nbsp;\Software<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Explorer</li>
    <li>In the Explorer folder change the value of EnableAutoTray to 0.</li>
    <li>Right click Start (or anywhere on the taskbar) and select Properties.</li>
    <li>Click the Taskbar tab.</li>
    <li>Clear the Lock the taskbar option.</li>
    <li>Check Hide inactive icons.</li>
    <li>On the Taskbar tab, click Customize.</li>
    <li>In the Current Items section, select each of the items as &quot;Always Hide&quot;. 
    Click OK, then OK again.</li>
    <li>Start all over, re-open the properties dialog box, and select each item 
    as &quot;Hide when inactive&quot; in the Current items section. Click OK, then OK again.</li>
    <li>Navigate in the registry to<br />
    HKEY_CURRENT_USER<br />
&nbsp;\Software<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Explorer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \TrayNotify</li>
    <li>Delete the IconStreams and PastIconStreams values.</li>
    <li>Close the Registry Editor.</li>
    <li>Close all open programs.</li>
    <li>Open Task Manager: click on Start &gt; click on Run &gt; type: taskmgr</li>
    <li>Click on the Processes tab.</li>
    <li>Click on explorer.exe in the image name column.</li>
    <li>Click on the End Process button.</li>
    <li>Confirm Yes to kill the process. This will close the desktop except for 
    Task Manager.</li>
    <li>In Task Manager select the File menu command.</li>
    <li>Click on the Create New Task button.</li>
    <li>In the Open box type: explorer</li>
    <li>Click OK.</li>
  </ol>
</blockquote>
<p>2007-05-19 – Thomas Gregory Platt confirms that cleaning out these registry 
entries solves the problem for him too. He also wrote the following, 
intriguing message, whose core, I believe, is true or close to the truth and 
refutes my earlier suspicion that systray.exe is loaded too late. Thanks, 
Thomas! I have already amended this whole web page accordingly, so the 
following message now no longer appears as a correction:</p>
<blockquote>
  <p>I have to make one correction to what you and others seem to suspect is going 
  on with the systray application. From my observations of boot-time behavior 
  here, I honestly don't think the problem is that systray isn&#39;t loaded yet when 
  the icons that fail to appear are posted. On the contrary. From what I've seen, 
  I can plainly <span style="font-style: italic">see</span> that systray
  <span style="font-style: italic">is</span> present and has been active for some time because 
  it already HAS icons IN the tray (some of them like Network Connection, System 
  Volume Control and the &quot;Safely Remove Hardware&quot; icon were visible in the tray) 
  when the &quot;Clipmate-loads-but-its-icon-doesn&#39;t-appear&quot; problem occurred on my 
  system. So I&#39;m convinced you&#39;re wrong in assuming systray isn&#39;t active yet.</p>
  <p>One scenario that would explain part of what&#39;s going on is that the system 
  and systray are so BUSY in the midst of the startup bedlam (perhaps systray 
  is processing or rebuilding that long-long list of old icons?) that systray 
  fails to finish processing the request from one app (like ClipMate) fast enough 
  before another app (like the starting antivirus) comes in and issues a SECOND 
  request to add an icon to the system tray. It could be that the second incoming 
  request clobbers the first one and knocks it completely out of systray&#39;s queue. 
  That assumes of course that systray even HAS a queue. It could be systray app 
  wasn't designed to queue requests because its designers assumed it would be 
  able to process incoming requests to add a new icon VERY fast (within a few 
  CPU cycles). If the designers made that assumption, systray might only provide 
  a few memory locations where other apps can &quot;poke&quot; a copy of their icon and 
  the name and location of the program to be called when that icon is clicked 
  and then flip an in-memory switch that tells systray &quot;Here's a new icon for 
  you to process.&quot;. Without queuing, if two requests from different apps occur 
  in rapid succession while systray is &quot;busy&quot; doing something else (e.g. updating 
  that long list of prior icons, perhaps?), the arrival of a second request might 
  just obliterate the first one thus causing the earlier request to get lost.</p>
  <p>There's a second scenario that would also explain both this behavior AND
  <span style="font-style: italic">another</span> phenomenon I've observed that no one else 
  on your site has explicitly mentioned—the now-you-see-it-now-you-don't system 
  tray icon glitch. It appears that some apps (like Clipmate) are designed to 
  issue a request to add their icon to the System Tray and just go on without 
  waiting (i.e. they're not designed to wait for a confirmation that their icon 
  was added), while others (e.g. anti-viruses) seem to be designed so that, if their 
  request <span style="font-style: italic">isn't</span> <span style="font-style: italic">acknowledged</span> 
  by systray within a few clock-ticks, they &quot;get impatient&quot; and issue a
  <span style="font-style: italic">new</span> START request for systray—thus causing it 
  to lose track of ALL earlier &quot;add my icon&quot; requests. THIS scenario would explain 
  why some requests seem to get lost. It would <span style="font-style: italic">also</span> 
  explain why some icons can be seen to appear in the tray for a brief moment 
  or two, but suddenly disappear from it later. That's EXACTLY what was happening 
  on MY system with both the speaker volume control and the &quot;Safely Remove Hardware&quot; 
  icons. One second those icons would <span style="font-style: italic">appear</span> in the 
  system tray and moments later they would <span style="font-style: italic">vanish</span>! 
  I&#39;ve seen remarks from several posters (including you) that suggest they assume 
  lack of a fast reply from systray means it &quot;hasn&#39;t started yet&quot; or that it &quot;should 
  start earlier&quot;. Knowing how programmers think, that tells me some developers 
  might decide to &quot;take matters into their own hands&quot; and issue their
  <span style="font-style: italic">own</span> request to start systray if they don&#39;t get a 
  reply from it fast enough. If systray is already running but BUSY, issuing a 
  second start request probably causes systray to lose track of all icons it has 
  previously loaded – thus producing the &quot;now-you-see-it-now-you-don't&quot; vanishing 
  icons phenomena and the &quot;my icon never appeared&quot; phenomena too. If I was a betting 
  man, I&#39;d bet on this scenario. Programmers are notorious for such high-handed 
  tactics.</p>
  <p>Call it an EWAG (Educated Wild Ass Guess) Hans, but as a 40 year software 
  pro, what I see suggests that if the CPU is busy enough and the prior icons 
  list systray must process is LONG, systray can't react FAST enough before a 
  second request arrives. When that happens, for SOME reason (whether it's lack 
  of queuing or an impatient programmer who tries to start systray) a second request 
  that arrives while systray is <span style="font-style: italic">busy</span> wipes out the 
  requests that preceded it – both the one systray hasn't finished processing 
  yet AND any that HAD been completed earlier and were already in the tray.</p>
</blockquote>
<h1><a id="Cannot_create_shell_notification_icon" name="Cannot_create_shell_notification_icon">Cannot create shell notification icon</a></h1>
<p>This is an error message that some programs, apparently all written in Delphi, 
show when they cannot reach the systray task to put their icon into the system 
tray. The most prevalent of these programs is Asus Probe. Most other programs 
don't throw an error message, but instead simply forgo creating an icon if they 
can't do it instantly. Both behaviors are insufficient, as we know.</p>
<p>This problem can be solved with Startup Delayer (see below) and by other means 
of delaying the startup. One of the simplest is to enable a splash screen like 
described here:</p>
<p>2006-09-14 – Eric-Jan Damen writes that his problem with the Asus Probe systray 
icon appeared after he removed the check mark to &quot;show up on next execution&quot; in 
the splash screen. The delay caused by the splash screen may be enough to make 
it work.</p>
<p>To re-enable the splash screen for Asus Probe, after you've already disabled 
it, click on <a href="/tools/AsusProbeShowSplashScreen.reg">AsusProbeShowSplashScreen.reg</a>, 
confirm as often as needed, then log off and log on again to test it. (Works only 
for Asus Probe, other programs have their settings at a different location in 
the registry or elsewhere.)</p>
<p>If that doesn't solve the problem and if you want to do it yourself, you can 
do it as follows.</p>
<p>Write a little program in Visual Basic Script that delays the start. Create 
a text file (File, New, Text file, or just open an Editor) and copy the following 
two lines into it:</p>
<blockquote>
  <p>Wscript.Sleep 240000 ' 4 minutes</p>
  <p>WScript.CreateObject(&quot;WScript.Shell&quot;).Run &quot;&quot;&quot;C:\Program Files\Asus\Probe\AsusProb.exe&quot;&quot;&quot;, 
  2</p>
</blockquote>
<p>The delay time is in milliseconds, 240,000 in the example. Everything to the 
right of the apostroph (') is only a comment, has no function, and is not required. 
To solve the problem here, a delay of 30 to 60 seconds suffices, but if you also 
have the problem that a regulated fan triggers an alarm when cold-started, 4 to 
8 minutes may be required.</p>
<p>Save the file under the name DelayedStartup.vbs into the folder where the AsusProb.exe 
file resides. If the path is different from the one in the second line, change 
it accordingly. Actually, the file can be anywhere else, if you like, if only 
you enter its path into the registry as described below.</p>
<p>Test it. Close Asus Probe, then double-click on the VBS file in Windows Explorer, 
but double-click only once. There is no apparent reaction and no window opening. 
You have to wait for Asus Probe to appear after the given time. If you're in a 
hurry, you can shorten the time to a few seconds for the test, then change it 
back after the test.</p>
<p>Open regedit (Start, Run..., regedit) and change the following value.</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Run<br />
  &quot;ASUS Probe&quot;=&quot;C:\Program Files\ASUS\Probe\AsusProb.exe&quot;</p>
</blockquote>
<p>Double-click on &quot;ASUS Probe&quot; on the right side and change the value to read:</p>
<blockquote>
  <p>&quot;ASUS Probe&quot;=&quot;C:\Program Files\ASUS\Probe\DelayedStart.vbs&quot;</p>
</blockquote>
<p>The path given in the above example may not be the same as on your computer. 
Adapt it accordingly.</p>
<p>Log off and log on again to test the change. Asus Probe should appear after 
4 minutes or after whatever time you entered.</p>
<p>If you want to use this program to start several programs delayed, use the 
following example.</p>
<blockquote>
  <p>Set WsShell = WScript.CreateObject(&quot;WScript.Shell&quot;)</p>
  <p>Wscript.Sleep 240000 ' 4 minutes</p>
  <p>WsShell.Run &quot;&quot;&quot;C:\Program Files\Asus\Probe\AsusProb.exe&quot;&quot;&quot;, 2</p>
  <p>Wscript.Sleep 20000 ' 20 seconds</p>
  <p>WsShell.Run &quot;&quot;&quot;put the path to the next program here&quot;&quot;&quot;</p>
</blockquote>
<p>Repeat the last two lines as needed.</p>
<p>Note that some programs may reinstate the original situation when they are 
installed, reinstalled, or updated. Then you have to make the changes to the registry 
again.</p>
<p>User <a href="/user/1210">ClearAsMud</a> remarked that this method can be used for systray icons as well, if you write the program such that it starts the respective programs with delays. Of course, the normal start of the programs would have to be disabled and the delaying program amended whenever a new program with a systray icon is installed or an old one removed.</p>
<h1><a id="Other_known_triggers" name="Other_known_triggers">Other known triggers</a></h1>
<p>Make sure first that you either don't have the following registry values at 
all or, if you have any of them, that it is set to zero. Deleting the value entirely 
is easiest and safest. If you want to have all of them removed or set automatically, 
just <a href="/tools/trayreset.reg">click here</a>, then give the permissions when 
asked.</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \Explorer<br />
  &quot;NoTrayItemsDisplay&quot;=dword:00000000</p>
</blockquote>
<p>2005-04-05 – Reagan Wiliams reports that in Windows XP (2002) a similar value 
with the same effect is here (meanwhile confirmed):</p>
<blockquote>
  <p>HKEY_CURRENT_USER<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \Explorer<br />
  &quot;NoTrayItemsDisplay&quot;=binary:00000000</p>
</blockquote>
<p>It is easiest and safest to just delete that value, but if it is all zeros, 
it should have no effect either. If it is non-zero, that may be the cause of your 
problem.</p>
<p>2005-10-06 – Christian from Germany wrote that you should make sure you do 
have the following value, which should exist in a normal installation. Its absence 
may cause the problem:</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \ShellServiceObjectDelayLoad<br />
  &quot;SysTray&quot;=&quot;{35CEC8A3-2BE6-11D2-8773-92E220524153}&quot;</p>
</blockquote>
<p>Check also the message &quot;2007-04-21 – Karel&quot; below, which also refers to this 
GUID and shows how to restore a missing InprocServer32.</p>
<p>2005-10-25 – Keith Sagona wrote that the DisableLocalUserRun registry value 
should be set to 0, not 1. Even a repair installation of Windows XP does not appear 
to fix this.</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\Software<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \Explorer<br />
  &quot;DisableLocalUserRun&quot;=dword:00000000</p>
</blockquote>
<p>If this value is set to 1, that may be the cause of the problem. Search the 
registry for other instances of that setting, particularly in HKEY_CURRENT_USER, 
and set those to 0 also. Then reboot. In many installations this value doesn't 
even exist. In fact, in many normal installations the entire registry key Explorer 
does not exist. You can try to back up that key by exporting it, then delete the 
entire key for a test.</p>
<p>Unfortunately the absence or presence of these keys and values does not guarantee 
that it all works, and it is not clear whether some of these values work only 
for some people because they change the logon timing.</p>
<p>Also make sure that you don't have the taskbar set up the wrong way. Make sure 
that the quickstart icons are on the left side, not on the right, and the running 
programs area is in the middle of the taskbar. If they are arranged the other 
way around, then unlock the taskbar and drag the program icon area far to the 
right, between the quickstart icons and the system tray (system notification area). 
Then use the sliders to use the available space optimally and relock the taskbar. 
If this solves your problem, be happy. The problem for which most people visit 
this web page is much more intractable.</p>
<p>2006-05-12 – Asa Jay Laughton wrote that Norton AntiVirus has a specific setting 
to hide its systray icon, so if that is the only icon is missing on your computer, 
please read:
<a href="http://service1.symantec.com/SUPPORT/ent-security.nsf/552ba2f7636bedf088256818006f78bf/3ddfe6366551aab388256a2200272b2a?OpenDocument&src=bar_sch_nam&seg=ag">
How to hide the Norton AntiVirus Corporate Edition icon from the desktop of NAVCE 
servers or unmanaged clients</a> on Symantec's web site.</p>
<p>2006-05-13 – Poul Eric Madsen wrote that the spyware program regperf.exe caused 
his Norton AntiVirus icon to disappear, and only spyware removal, followed by 
a repair installation of the Norton program brought the icon back into the systray. 
A full Norton reinstallation didn't do the trick, only the repair function worked.</p>
<p>It may be worth noting that various malware attempts to deactivate some well-known 
antivirus and anti-spyware programs, and that may also affect their systray icons. 
Also, Symantec/Norton software is generally not recommended, because it causes 
a variety of other problems.</p>
<p>2006-07-14 – Steve McAfee wrote:</p>
<blockquote>
  <p>Found another way to lose the volume tray icon to add to your site. Tracked 
  this one down myself as it had me pulling my hair out.</p>
  <p>Basically my registry had lost some entries for sound drivers that microsoft 
  installs with XP. Reinstalling the sound card, etc did not help. All sound features 
  seemed to work except I did not get the volume systray icon and in the control 
  panel applet for sound the button to &quot;play&quot; a selected sound was ghosted. In 
  there registry under the following key there are a number of sound drivers which 
  are defined on a fresh XP install:</p>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows NT<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Drivers32</p>
  <p>The sound tray icon and control panel try to open the driver called &quot;wavemapper&quot; 
  and if it&#39;s not there the sound icon does not display. The registry entry is 
  a string entry that looks like this:</p>
  <p>wavemapper&nbsp;&nbsp; REG_SZ&nbsp;&nbsp; msacm32.drv</p>
  <p>Once I added this back it started working. I then exported a .reg file for 
  this drivers32 key from a fairly fresh XP installation and imported that on 
  the system because wavemapper was not the only key I had lost. I have a theory 
  that this somehow happened due to installing and uninstalling codecs, but I&#39;m 
  not sure.</p>
  <p>-steve</p>
</blockquote>
<p>2006-08-09 – Mikael Tilly wrote to confirm Steve's findings.</p>
<p>2006-08-10 – Hakan Turan also confirmed:</p>
<blockquote>
  <p>I had the same problem, no volume icon. Only mp3 and wav files were playing 
  fine and no midi file was audible.<br />
  </p>
  <p>Steve McAfee's solution to add:</p>
  <p class="center">wavemapper REG_SZ msacm32.drv</p>
  <p>to the registry solved my problem.</p>
  <p>Later I remembered that I had uninstalled a DivX codec package lately. I 
  think that caused the problem.</p>
</blockquote>
<p>2006-09-10 – Tomer confirmed.</p>
<p>2007-03-19 – Bruno Zumella wrote:</p>
<blockquote>
  <p>[The relevant text on this web page] reminded me that I uninstalled XviD 
  1.x.0 and then reinstalled the last XviD 1.1.2 on my two computers. Then the 
  registry key was missing.</p>
  <p>I recreated the wavemapper REG_SZ entry and all works well know. The sound 
  icon is back.</p>
</blockquote>
<p>2007-04-05 – Nalin confirmed.</p>
<p>2007-04-14 – Joe confirmed and mentioned that the problem appeared after he 
uninstalled the quite popular ffdshow codec.</p>
<p>2007-04-21 – Karel wrote:</p>
<blockquote>
  <p>One of the points to look for, when the systray is missing or behaving weird, 
  is the presence of the systray inprocserver. For some silly reason, it got lost 
  in my registry. This lead to the following behaviour:</p>
  <ul>
    <li>Systray was present with the clock symbol.</li>
    <li>Custom symbols, which come from minimized applications worked also.</li>
    <li>Taskmanager symbol was OK.</li>
    <li>Soundsymbol was missing.</li>
    <li>The USB-Stick symbol did not appear, neither the sound which you get when 
    plugging in.</li>
    <li>If you enabled &quot;Show Volume Control in Taskbar&quot; from multimedia settings, 
    it was back again, but just for the session. After reboot, still missing.</li>
  </ul>
  <p>The following registry update puts the missing entries back in place:</p>
  <blockquote>
    <p>Windows Registry Editor Version 5.00</p>
    <p>[HKEY_CLASSES_ROOT\CLSID\{35CEC8A3-2BE6-11D2-8773-92E220524153}]</p>
    <p>@=&quot;SysTray&quot;</p>
    <p>[HKEY_CLASSES_ROOT\CLSID\{35CEC8A3-2BE6-11D2-8773-92E220524153}\InprocServer32]</p>
    <p>@=&quot;C:\\WINDOWS\\system32\\stobject.dll&quot;</p>
    <p>&quot;ThreadingModel&quot;=&quot;Both&quot;</p>
  </blockquote>
</blockquote>
<p>These entries are there in every normal Windows XP with Service Pack 2 installation, 
so it usually doesn't hurt to re-enter them. If they are already there, nothing 
will change. You have the following choices:</p>
<ul>
  <li>Open the file by clicking on <a href="/tools/systray_inprocserver.reg">systray_inprocserver.reg</a> 
  and give permission to change.</li>
  <li>Copy and paste the registry update shown above into a text file with the 
  extension .reg and double-click on it.</li>
  <li>Enter the keys and values by hand. The @= entries are the &quot;(Standard)&quot; values.</li>
</ul>
<h1><a id="Other_possible_triggers_and_workarounds" name="Other_possible_triggers_and_workarounds">Other possible triggers and workarounds</a></h1>
<p>New information is added at the end of this chapter, so you can read on, but 
skip to the last paragraphs if you get bored. Thanks to everybody who contributed 
useful information!</p>
<p>In spite of the apparent effectiveness of the Ostuni workaround, I'm still 
looking for a way to make the systray icons show up without having to disable 
or uninstall anything. So the search is still continuing.</p>
<p>Anything that streamlines or delays the boot and logon process appears to help 
in many cases, though not all, for example thoroughly defragmenting the hard disk 
with a good defragmenter like PerfectDisk by Raxco. Other examples keep being 
reported, but none is a real solution. They all work on some computers, but not 
on others, usually by disabling something and thereby changing the boot timing. 
Typical culprits are slow, inefficient virus checkers that are set to automatic, 
like Norton Antivirus 2005 Pro.</p>
<p>First give your user account a password, so the computer cannot rush through 
a quick auto-logon.</p>
<p>It clearly helps (on at least one of my own computers) if the user waits until 
he actually logs on. You may enter your password, but do not immediately press 
return or click on the OK button. For a few thorough tests wait at least a full 
minute before logging on, or wait until disk activity subsides. You could watch 
the hard disk light, memorize the rhythm of the bursts, which is usually always 
the same, and the next time wait until after the last big loading burst. If this 
helps, it probably does so by getting some system (particularly network) loading 
processes out of the way.</p>
<p>As mentioned above, disabling the
<a href="http://www.microsoft.com/windowsxp/using/setup/expert/crawford_02july22.mspx">
UPnP</a> (Universal Plug and Play) service or the
<a href="http://www.google.com/search?q=ssdp+discovery">SSDP</a> (Simple Service 
Discovery Protocol) service or both solves the problem. Microsoft proposes the 
latter in <a href="http://support.microsoft.com/kb/841571/">http://support.microsoft.com/kb/841571/</a>. 
However, this is not a very good solution because you may want to have these services 
running. Another proposal is to set the start type of these services to Automatic. 
They are by default set to Manual, and at least the
<a href="http://www.google.com/search?q=ssdp+discovery">SSDP</a> service is nonetheless 
started automatically by other means. Setting the
<a href="http://www.google.com/search?q=ssdp+discovery">SSDP</a> service to Automatic 
would likely let this service start earlier, so it doesn't get in the way of other 
software that is loaded later.</p>
<p>2005-03-10 – Rob Nunn wrote that his Systray icons fail to appear exactly on 
those days when his antivirus program, NOD32, updates its virus definitions, which 
it does after first being loaded, i.e. just after system boot. This, of course, 
uses the network connection. My first thought is that, if one could delay the 
antivirus update by a minute, the problem might not show up.</p>
<p>2005-04-10 – Stein Bjorndal reported: &quot;... a process named sdmcp.exe crashed 
on me. After a bit of investigation, this turns out to be a part of the DesktopX 
application by Stardock (<a href="http://www.stardock.com/products/desktopx/">http://www.stardock.com/products/desktopx/</a>), 
...&quot; Uninstalling the program didn't work for him either, so he just erased all 
traces that could be found, including the start of the exe file. That solved his 
problem.</p>
<p>This has meanwhile been confirmed by two other users, Gary Melady and David 
Perry. The culprit may be Stardock Central.</p>
<p>2005-05-21 – Daron Brewood wrote: Solved my icon problem in the end by disabling 
WindowBlinds 4 (I had to as it conflicts with the new Pocket PC Active Sync program) 
– but it has the side effect of fixing the icon problem, so in my case it looks 
like it is/was due to WB4.</p>
<p>2005-06-14 – Ansgar Nell sent an intriguing hint, originally written by Guloso 
on a discussion board—just restart systray.exe, for example by putting a shortcut 
to it into the startup folder. No need to provide a path, since the program is 
in the search path. I have meanwhile received an email confirming this, but it 
doesn't work at all on my own computers. Another of those solutions that work 
for some, but not for most. I have heard of one case in which systray.exe didn't 
get loaded at all, and using this method or the one below fixed the problem.</p>
<p>A similar, possibly better method to start systray.exe is through the Run key 
in the registry. Unfortunately this also doesn't bring any missing icons back 
on my computers, but if you want to try it nonetheless, the procedure is as follows.</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Run<br />
  &quot;systray&quot;=&quot;systray.exe&quot;</p>
</blockquote>
<p>Step-by-step instructions:</p>
<ol>
  <li>Click on Start, Run..., type: regedit</li>
  <li>Press return</li>
  <li>In Registry Editor, navigate the left directory tree to: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</li>
  <li>Right click in the right window pane, select New, then String value.</li>
  <li>Give the new string value the name: systray</li>
  <li>Your new value should now have the name &quot;systray&quot;, the type &quot;REG_SZ&quot;, and 
  no data. Right click on this new systray value and select: Modify</li>
  <li>Enter the value: systray.exe</li>
  <li>Click: OK</li>
  <li>Close Registry Editor.</li>
  <li>Restart your computer.</li>
</ol>
<p>Another of these hints (thanks to John Erikson) is that emptying the Prefetch 
folder (C:\WINDOWS\Prefetch in a normal installation) helps. The file Layout.ini 
is automatically recreated at some later time and is not essential anyway. Just 
cleaning out the prefetch folder did not solve the problem on my test computers 
and I also get reports from other users that it doesn't solve the problem there, 
so it is obviously not a universal solution. I guess that it merely speeds up 
the logon process a little.</p>
<p>2006-10-23 – WvU wrote that deleting Prefetch\Layout.ini, then defragmenting 
the hard disk, solves the problem for him. He supposes that the defragmenter has 
a defect in relation to rearranging the boot files according to Layout.ini.</p>
<p>Yet another hint came from Harold Collins. He used the MSCONFIG utility to 
disable the Adobe Reader Speed Load, which solved the problem for him. This is 
apparently yet another way to accelerate the loading process for the other systray 
icons and may work for some.</p>
<p><a href="http://www.tech-pro.net">www.tech-pro.net</a> provides a tool set 
named Tech-Pro Utilities Startup (<a href="http://www.tech-pro.net/startup.html">http://www.tech-pro.net/startup.html</a> 
Version 1.1 as of 2004-11-22), which contains one tool named Startup Manager. 
You need only the Startup Manager for this particular problem. This program can 
delay the loading of programs from your Startup menu and allegedly solves the 
missing systray icon problem.</p>
<p>I have my doubts though, because most of the possibly offending programs aren't 
started from the Startup menu at all, mine is empty, for example. I guess we need 
something to delay the loading from the Run key in the registry. But if you try 
any of these programs, please let me know your results.</p>
<p>2005-01-26 – Found a program named SysTrayHack at
<a href="http://desktopian.org/addons/systray2kfix.zip">http://desktopian.org/addons/systray2kfix.zip</a> 
and tested it. It claims to solve the problem of not appearing systray icons when 
another shell is used in place of Windows Explorer. I tried it, although I do 
use Windows Explorer. As expected, it didn't solve the problem for me, but I have 
received 2 confirmations that it worked for other users.</p>
<p>2005-02-16 – Lutz-R. Frank wrote:</p>
<blockquote>
  <p>I could work around the issue using PS Tray Factory. It allows to restore 
  all the tray icons after a crash of explorer. Just testing it but it looks very 
  promising - and offers some additional benefits as minimizing any application 
  to the tray. See <a href="http://www.pssoftlab.com/">www.pssoftlab.com</a> for 
  more details.</p>
</blockquote>
<p>Thanks, Lutz! This is indeed promising. The program is try-before-you-buy shareware 
and costs $24.95. I haven't tested it yet and will wait for independent confirmation.</p>
<p>2005-02-17 – Cliff Cawley of r2 Studios contacted me and recommended his freeware 
program Startup Delayer, available from
<a href="http://www.r2.com.au/software.php?show=startdelay">http://www.r2.com.au/software.php?show=startdelay</a>. 
2005-04-01 - Bruce Sylvester reports that he tried Startup Delayer after the Ostuni 
Workaround hadn't helped. His statement: &quot;Voila! Works perfectly and problem gone.&quot; 
2005-10-12 – I finally got to testing it myself and can recommend it with some 
reservations. The program itself works very well and does exactly what it should 
do—delay starting the automatically started programs. Unfortunately it does not 
solve the entire problem on my computer. Some of the missing or disappearing icons 
will still not appear if delayed, or they will never appear when delayed. Examples 
are the Bluetooth icon and other icons that depend on it, like that of the Nokia 
PC Suite. Startup Delayer seems to work well with the SoundMan icon though (the 
speaker symbol to control the sound volume) and with several others, like Asus 
Probe. It also appears to have a perfect installer and uninstaller, so there is 
apparently no risk in trying.</p>
<p>2005-05-16 – IceBear wrote:</p>
<blockquote>
  <p>This solution might not be comfortable when the problems with missing icons 
  appear at every boot, but it's very useful if it only happens sometimes. The 
  12ghostTray has a function that can restart just the systray. When it does, 
  all icons become visible as they should.
  <a href="http://12ghosts.com/ghosts/tray.htm">http://12ghosts.com/ghosts/tray.htm</a></p>
</blockquote>
<p>2005-07-20 – Dan Berger wrote:</p>
<blockquote>
  <p>I found another rather simple way of correcting the missing notification 
  tray icon problem. [...]</p>
  <p>Since it appears that load order or load timing may be responsible, I simply 
  moved the command to load the problem program from its registry key location 
  to the startup menu. It worked. </p>
  <p>I imagine that just moving things around among the six registry load keys 
  and the startup folder will solve most problems of this sort. Doesn't solve 
  the &quot;why&quot; question, but at least it seems to work.</p>
</blockquote>
<p>2005-10-11 – Vivek Tanna outlined the following procedure:</p>
<blockquote>
  <p>Usually to get back the missing icons one can use the following steps to 
  kill and restart Windows Explorer:</p>
  <ol>
    <li>Press Ctrl + Shift + Esc to get Task Manager</li>
    <li>In Processes click on explorer.exe and click on the End task button</li>
    <li>Select the command File, Run and type in: explorer (or alternatively click 
    on the Applications tab, then on the lower right button, New task ... and 
    enter explorer there)</li>
  </ol>
  <p>This brings back the missing icons 99% of the time.</p>
</blockquote>
<p>Unfortunately I cannot confirm this. Sometimes it works for me, but usually 
it doesn't. Some icons do not return, even if I repeat the procedure. But try 
it anyway, perhaps it works well enough for you.</p>
<p>2005-10-21 – Anastasia wrote that one method of last resort is to give up the 
user profile, create an entirely new user, and copy as much data and settings 
as possible from the old user to the new. She then wrote:</p>
<blockquote>
  <p>In any case, I must say that copying &quot;My Documents&quot; from one administrator 
  account to another was very quick. [...] If they see tray icons if they logon 
  in &quot;guest account&quot; [...], then create a new user all together and cut-paste 
  [My Documents]. Unfortunately they will also have to re-do all the little tweaks 
  on the way they want windows to look (e.g. start menu items, internet explorer 
  buttons etc), but nevertheless it took me about 20 mins to configure everything 
  the way I wanted it. Important to note if you do this method: copy outlook .pst 
  on my (new) documents and import to outlook. Copy also the favourites folder 
  before you delete the account (these are the only two actions I made when switching 
  users, as all my programs are configured to be used for all users).</p>
</blockquote>
<p>A remaining problem is any software that had been installed for this user only, 
because that would have to be reinstalled. But if all else fails, this is still 
a way out.</p>
<p>2006-01-16 – Larry Bowman wrote about a last resort workaround. You can create 
shortcuts to the programs that belong to the missing icons. For example, you can 
create a shortcut to sndvol32, so you can always get the volume control, albeit 
the big one. Or you can right-click the Sounds and Multimedia applet in Control 
Panel and create a shortcut to that, so you can get your volume icon back with 
a few more mouse clicks (disable the icon, apply, enable the icon, OK). With similar 
shortcuts you may be able work around all or most missing icons. Another example 
for such a shortcut is this, which you could call Hardware Unplug:</p>
<p class="center">rundll32.exe shell32.dll,Control_RunDLL hotplug.dll</p>
<p>2006-09-28 – Bart van de Beek wrote:</p>
<blockquote>
  <p>In Windows XP Professional you can delay the automatic windows logon by doing 
  the following, see if that helps:</p>
  <p>Start -&gt; Run... -&gt; type: gpedit.msc -&gt; press the enter key -&gt; navigate to:
  <br />
  Local Computer Policy -&gt; Computer configuration -&gt; Administrative Templates 
  -&gt; System -&gt; Logon</p>
  <p>Enable: Always wait for the network at computer startup and logon</p>
</blockquote>
<p>Unfortunately on many computers this delay is not enough to prevent the problem, 
but, like many other workarounds, it seems to solve the problem on some.</p>
<p>2006-11-22 – Lawrence LaCroix wrote:</p>
<blockquote>
  <p>I tried most of your suggestions and some would restore one icon, but then 
  another would disappear. Then quite by accident I stumbled on a solution that 
  seems to work 100% (at least for the time being).</p>
  <p>I was looking for the menu to hide network UPnP devices as suggested on your 
  page and I found that in Network Connections/Advanced/Advanced Settings, my 
  1394 connection (which is disabled) was my first device in priority order. So 
  I moved the local network to the top of the priority list and when I rebooted 
  the next time it seemed to cure the problem totally. All of my tray icons have 
  returned.</p>
</blockquote>
<p>2006-11-28 – Lawrence LaCroix wrote about an interesting point again:</p>
<blockquote>
  <p>In the taskbar properties menu, there is an option to control the systray 
  icon properties, like &quot;show always&quot; &quot;hide when inactive&quot; and &quot;hide always&quot;. 
  Below the active icons is a cache of recently used systray icons that for some 
  reason Windows likes to remember. Over time this list can get longer and longer 
  if you have installed and removed a lot of applications that have systray icons. 
  In this storage area, there are also sometimes &quot;folder&quot; icons. These can represent 
  temporary information that was in the tray that never had an icon, or it can 
  represent deleted program icons for which Windows no longer has the original 
  icon available to display, so instead Windows simply displays the standard Windows 
  folder icon with a description.</p>
  <p>When I use the registry fix with the two keys that are deleted (IconStreams 
  and PastIconsStream), all of the recognized icons are deleted, but I still had 
  at least 20 of the &quot;folder icons&quot; described above that were not removed. Even 
  after rebooting these were still there, and even after rebooting I had some 
  current systray icons that were still missing from the notification area. When 
  I used the longer method to use Task Manager to shut down Windows Explorer and 
  restart it in the current session (Run: explorer), all of the &quot;folder icons&quot; 
  disappeared and my systray icons started working properly again. I am fairly 
  sure that this missing systray icon issue has something to do with how Windows 
  reads that list of systray icons, current &amp; recently used, held in this taskbar 
  properties file.</p>
  <p>Instead of steps 1 to 4 below, you can also run
  <a href="/tools/systray_cleanup.reg">systray_cleanup.reg</a> or another of the 
  related registry fix files described in the chapter &quot;The most successful workarounds&quot; 
  above. They all remove the two registry keys.</p>
  <ol>
    <li>Click Start &gt; Run &gt; Regedit</li>
    <li>Navigate to<br />
    HKEY_CURRENT_USER<br />
&nbsp;\Software<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \Explorer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \TrayNotify</li>
    <li>Delete the IconStreams and PastIconsStream values.</li>
    <li>Close Regedit.</li>
    <li>Open Task Manager, click Processes tab, click explorer.exe, then click 
    End Process.</li>
    <li>Still in Task Manager, click File, click New Task, type explorer, then 
    click OK.</li>
  </ol>
  <p>I think that the other fix [see above] that rearranges the default network 
  search order worked on one of my computers because it changed the order that 
  the icons were loaded, again this points toward some quirk or glitch in that 
  icon storage information. This fix also has some interesting side effects, on 
  my home computer the systray now loads about twice as fast since I moved the 
  1394 network adapter down the list and put my local network at the top. Now 
  figure that one out!</p>
</blockquote>
<p>2006-12-13 – Pete Green wrote:</p>
<blockquote>
  <p>Simply using the '<i>Optimize System</i>' option within Microsoft's <i>Bootvis</i> 
  program does the trick for me.&nbsp; Bear in mind though that if, after running 
  it, new programs are installed that load at startup, it may be necessary to 
  re-run <i>Bootvis</i>.</p>
  <p>Whilst <i>Bootvis</i> is apparently no longer available for download from 
  the Microsoft site, a search on Google will reveal several sources.</p>
</blockquote>
<p>Windows XP has a similar automatic function already built in, which is enabled 
by default, so it is a question why that didn't already solve the problem, but 
Pete mentioned that, even in a test with an earlier disk image, it was only Bootvis 
that solved the problem in his installation.</p>
<p>2007-04-29 – Bob Malcolm confirmed that the <span style="font-style: italic">Bootvis</span> 
optimization function solved the problem for him too.</p>
<p>2007-02-17 – Paul Santangelo wrote that he had one particular case of the disappearing 
systray icons where he found that something was wrong with the .NET 2.0 Framework 
installation. Calling up the installer again and electing to repair the .NET installation 
fixed it permanently.</p>
<p>2007-05-11 – John Smallridge wrote:</p>
<blockquote>
  <p>Problem was missing systray icons, specifically printer icons (and sometimes 
  others) after Avast anti-virus was installed. Computer was heavily loaded with 
  software, so tried extra memory, which improved performance but didn't cure 
  problem. Kicked out some unnecessary startups, which interestingly did not have 
  any effect either.</p>
  <p>Uninstalled Avast and installed AVG to see what happened, and icons re-appeared.</p>
  <p>Uninstalled AVG and again installed Avast, icons gone again! (Processes were, 
  however, running, when I checked).</p>
  <p>Investigated registry with no joy and lots of other possibles until I hit 
  on it.</p>
  <p>Right clicking avast gives access to program settings and next level &quot;troubleshooting&quot;, 
  where you can delay the loading of avast services. This fixed the problem after 
  a re-boot, so in this case at least it seems to indicate that it is purely the 
  systray not being able to keep up with the demand or maybe just a question of 
  timing. My guess is that the demand of the loading services limits the resources 
  available to the systray load.</p>
</blockquote>
<p>Thanks, John, for this interesting observation! This also indicates that my 
earlier suspicion, that systray.exe loads too late, is wrong, and that a more 
likely cause is some kind of overload on systray.exe.</p>
<p>2007-05-13 – TUPOLEV wrote from France that deleting the following registry 
value solved the problem for him:</p>
<blockquote>
  <p>HKEY_LOCAL_MACHINE<br />
&nbsp;\SOFTWARE<br />
&nbsp; \Microsoft<br />
&nbsp;&nbsp; \Windows<br />
&nbsp;&nbsp;&nbsp; \CurrentVersion<br />
&nbsp;&nbsp;&nbsp;&nbsp; \ShellServiceObjectDelayLoad<br />
  &quot;UPnPMonitor&quot;=&quot;{e57ce738-33e8-4c51-8354-bb4de9d215d1}&quot;</p>
</blockquote>
<p>If you don't like to delete the value altogether, you can just make it temporarily 
unusable for a test, for example by adding DISABLED in front of the opening brace 
of the string value.</p>
<p>2007-06-14 – Brian Burdett wrote:</p>
<blockquote>
  <p>I tried all of the different suggestions with various results but this 
  worked 100%. I downloaded the freeware Startup Delayer program from:
http://www.snapfiles.com/get/startdelay.html [Homepage: <a href="http://www.r2.com.au/software.php?show=startdelay">http://www.r2.com.au/software.php?show=startdelay</a>]</p>
  <p>Startup Delayer allows you to specify which programs to start first and 
  which ones to delay. You can set a custom delay for each one, even drag the 
  visual display graph which shows you exactly how your programs are starting 
  and allows you to easily modify the order or adjust delay times.</p>
  <p>It appears that windows does not load the icons if several programs try to 
  start at once. I&#39;m loading eleven programs at start up in eight seconds in 
  the order I want them to load with no problem now.</p>
</blockquote>
<p>2007-06-21 – Jali Pajula wrote from Finland:</p>
<blockquote>
  <p>I just found out that the reason for my disappearing systray icons is 
  ZoneAlarm Security Suite.</p>
  <p>I can reproduce the situation _every time_ when I install ZA SS and the 
  problem diappears every time when I uninstall the program.</p>
  <p>This is kinda mystery to me, because I cannot make this happen with my 
  other PC, also ZA Security Suite installed.</p>
  <p>But as said, with this computer I can make it happen every time.</p>
</blockquote>
<h1><a id="Closing_remarks" name="Closing_remarks">Closing remarks</a></h1>
<p>Cited emails can be edited and abridged to fit this web page.</p>
<p>Thanks to everybody who wrote! If you have any further relevant information 
or found one of the above hints to work, please click 
on <em>Add new comment</em>
or on <em>reply</em> to reply to an existing comment (below, account required;
if you don't have an account yet, <a href="/user/register">create one first</a>).</p>
<p>Please check also the <a href="/node/96">result statistics</a> and report your results there.</p>
<h1><a id="Comments_vote" name="Comments_vote">Comments, vote, attachment</a></h1>
<p><a href="/node/96">Result statistics</a>&#151;please report your results.</p><table id="attachments" class="sticky-enabled">
 <thead><tr><th>Attachment</th><th>Size</th> </tr></thead>
<tbody>
 <tr class="odd"><td><a href="http://winhlp.com/files/shell32patch.zip">shell32patch.zip - Patch by nars. Some people had problems downloading it from the original site.</a></td><td>165.22 KB</td> </tr>
</tbody>
</table>
  <div class="forum-topic-navigation clear-block">
          <a href="/node/908" class="topic-previous" title="Go to previous forum topic">‹ USB Problem On Windows XP</a>
              <a href="/node/39" class="topic-next" title="Go to next forum topic">Cannot delete file or folder ›</a>
      </div>
</div>

  <div class="links"><ul class="links inline"><li class="comment_forbidden first"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
<li class="statistics_counter last"><span>1051358 reads</span></li>
</ul></div>
</div>

<div id="comments">
  <a id="comment-2626"></a>
<div id="comment-2626" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2626" class="active">Systray icons missing</a>  </h1>
    
    <p>
    <span class="date">Sun, 2013-10-27 12:52</span>
    <span class="author"> by David15</span>
  </p>
  
  <div class="content"><p>Hello Guys,</p>
<p>I'm not a computer expert and  i ended up in this site looking for a solution of the "Systray icons missing".<br />
Am using windows 7 and the only thing that work to restore the icons is to log off and log on again.<br />
I tried the nars patcher tool but it is only for XP..</p>
<p>Now anyone has a solution that work on 7 too?</p>
<p>THX</p>
<p>David</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2627"></a>
<div id="comment-2627" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2627" class="active">Windows 7</a>  </h1>
    
    <p>
    <span class="date">Mon, 2013-10-28 07:04</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>I didn't even know such a problem exists in Windows 7. We may be dealing with a different cause here. Unfortunately I don't know any solution for Windows 7.</p>
<p>Are the Systray icons always missing at your first boot-up or only sometimes? You could try some of the other solutions that worked in Windows XP, for example the delays.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2630"></a>
<div id="comment-2630" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2630" class="active">Windows 7</a>  </h1>
    
    <p>
    <span class="date">Sun, 2013-11-17 23:14</span>
    <span class="author"> by MRCS</span>
  </p>
  
  <div class="content"><p>"I didn't even know such a problem exists in Windows 7."<br />
Never had a problem on XP, but I sure do on Win7.  And, I haven't yet been able to find any pattern to it.  Doesn't happen at login.</p>
<p>"Now anyone has a solution that work on 7 too?"<br />
Any progress?</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2628"></a>
<div id="comment-2628" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2628" class="active">windows 7</a>  </h1>
    
    <p>
    <span class="date">Thu, 2013-10-31 12:56</span>
    <span class="author"> by David15</span>
  </p>
  
  <div class="content"><p>on my laptop it always happen..and a simple log off and log on will fix  it...but u know it's annoying after a couples of time...</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div></div><a id="comment-2611"></a>
<div id="comment-2611" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2611" class="active">Some insight into this problem</a>  </h1>
    
    <p>
    <span class="date">Fri, 2013-04-05 14:47</span>
    <span class="author"> by MrPeach</span>
  </p>
  
  <div class="content"><p>After having this happen to me twice, I think I may have some insight into what triggers this.</p>
<p>The first time was with a dual core HTPC build. At the time I didn't associate the dual core with the problem. However after I got a six core the problem came back in spades.  </p>
<p>It had been quite a while since the first occurrence, so I'd completely forgotten that I'd patched it prior. I wasted hours fiddling around with my startup items figuring one of them in particular was causing a problem before giving up and searching the net for a solution - hence arriving here. In the process of trying to fix it I discovered it was already patched.</p>
<p>Since it wasn't working (and knowing how long startup takes now with the six core) I quadrupled the timeout value (version 6.0.2900.6242 offset 00069ac4: 80 A9 03) and after some wrestling to replace shell32.dll (never thought I'd appreciate my dual boot Win8) got back all my icons. Some I hadn't seen in months!</p>
<p>Conclusion: The reason most people don't see this is twofold - they are running a single core or are not running enough heavy startup items. In the past I'd always kept my startups to an absolute minimum and never seen this problem even on dual cores. It was only after setting up this particular system with lots of heavy startups (email, ftp, Plex, PlayOn, Motocast, webcam, Bluetooth, process lasso, NPVR, etc.) that I saw this problem. </p>
<p>Hope this helps!</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2612"></a>
<div id="comment-2612" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2612" class="active">Thanks for the info</a>  </h1>
    
    <p>
    <span class="date">Sun, 2013-04-07 21:13</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>It is appreciated.</p>
<p>In a situation like this, with a range of bigger programs being started, perhaps starting them with much longer delays would solve the problem better. The helper program mentioned in an earlier comment below, that does exactly this, may solve the problem. Or one could program individual solutions, perhaps using batch files.</p>
<p>But if an additional patch to shell32.dll indeed solved the problem and if the solution is stable and reliable, then that may be good enough.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2606"></a>
<div id="comment-2606" class="comment not-by-node-author">

  <div class="picture">
  <img src="http://winhlp.com/files/pictures/picture-7535.jpg" alt="Wisewiz&#039;s picture" title="Wisewiz&#039;s picture"  /></div>

    <h1 class="title">
    <a href="/node/16#comment-2606" class="active">All of my systray icons are back!</a>  </h1>
    
    <p>
    <span class="date">Tue, 2013-02-05 15:15</span>
    <span class="author"> by Wisewiz</span>
  </p>
  
  <div class="content"><p>I had been struggling with the disappearing-icons problem for a week, and searching the Net in vain to find the solution. Finally, Google got me to winhlp.com, and the rest is simple history. The *nars* 2010 fix did the trick perfectly. Thanks to all of you who worked on this pesky problem. When it attacks your *frequently used tool* icons, it's especially frustrating. Like an earlier poster, I depend on a clipboard-extender every day, and I was going nuts without its icon in the tray, even though the program was running. I have Win 7 and Win 8 running on two of my household machines, but I still use a pair of older XP SP3 machines most frequently, and they were the sad victims of this sudden icon-absence. Fixed! Merci toute la gang!</p>
<p>This site is now an important part of my computing life.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2591"></a>
<div id="comment-2591" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2591" class="active">Volume and power icons</a>  </h1>
    
    <p>
    <span class="date">Sat, 2012-09-29 21:26</span>
    <span class="author"> by defro</span>
  </p>
  
  <div class="content"><p>thanks a lot man that was very successful it solved all of my problems</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2576"></a>
<div id="comment-2576" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2576" class="active">Offsets for NEW shell32.dll version 6.0.2900.6242</a>  </h1>
    
    <p>
    <span class="date">Fri, 2012-08-03 15:28</span>
    <span class="author"> by Paul C</span>
  </p>
  
  <div class="content"><p>shell32.dll was updated on my system on 8 June 2012 to version 6.0.2900.6242 from version 6.0.2900.6072.</p>
<p>The new offsets and changed bytes (in hex) for the patch are as follows:</p>
<p>00069ac4 change a0 to 60<br />
00069ac5 change 0f to ea<br />
00069ac9 change 03 to 01</p>
<p>I'm sure the patcher tool documented will work fine for the updated shell32.dll. I have a dual-boot system and boot into Linux and edit shell32.dll with the binary file editor GHex. I make a backup copy of the original shell32.dll and take a belt-and-braces image backup of my Windows system first before making such changes!</p>
<p>One again, I noticed that various tray icons were missing again at Windows start-up recently, so I checked shell32.dll and, it came as no surprise to me that shell32.dll had been updated on my system on 8 June 2012. The above patch is the only thing that will reliably fix this bug on my system. I have tried writing various programs over the years to fix this problem, the most successful being start-up delay programs; but even they don't work with 100% reliability.</p>
<p>I find it incredible that this problem has been around for so many years, and I understand that it even appears to have been carried forward to Windows 7. I tend to use Linux these days for most of my work and just keep a copy of Windows XP going to run programs I can't port to Linux.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2577"></a>
<div id="comment-2577" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2577" class="active">Patcher tool works for this new version</a>  </h1>
    
    <p>
    <span class="date">Fri, 2012-08-03 17:35</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>Thanks for the good information!</p>
<p>Yes, I can confirm that the patcher tool works fine on my German version of Windows XP.</p>
<p>Generally I am stunned by the number and severity of software errors in most software, particularly in widely used systems like Windows. On one side the software enables us to get things done, on the other side we waste an immense effort to identify and work around these defects, flaws, gaps in the functionality, etc. It is eye-opening to try to calculate the damage in a common currency. The cost of fixing a defect is probably minute compared to the damage it otherwise does.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2575"></a>
<div id="comment-2575" class="comment not-by-node-author">

  <div class="picture">
  <img src="http://winhlp.com/files/pictures/picture-5538.gif" alt="Brian E&#039;s picture" title="Brian E&#039;s picture"  /></div>

    <h1 class="title">
    <a href="/node/16#comment-2575" class="active">Found a solution to my problem</a>  </h1>
    
    <p>
    <span class="date">Wed, 2012-08-01 16:25</span>
    <span class="author"> by Brian E</span>
  </p>
  
  <div class="content"><p>I was having trouble with quite a few icons being missing on loading Windows 7 and then I just happened to read about the fact that it might be due to having a lot of programs trying to launch all at once (I do have a lot of applications on my PC). I thought I was probably on the right track when I discovered that if I logged off and back on again, the missing icons would reappear. I then noticed a suggestion about trying Startup Delayer (a program I used to have on my PC a long time ago but which I removed during the switchover to the latest version as some of the older features at that time had not been carried over to the new version). So I navigated to the developers web site and had a look at the latest version. I was pleased to note that all the missing earlier features were back and many new ones too, so I decided to give it a try. Well, I can report that using that little utility has completely solved my missing icons problem. I would probably still be looking for a solution if I hadn't spotted it on this site, so I'm very glad to have found this web site. Thank you to all who contribute - you are doing a fine job.</p>
<p>Best Regards</p>
<p>Brian E</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2562"></a>
<div id="comment-2562" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2562" class="active">Steve Kreideweiss solution works !!</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-02-26 03:38</span>
    <span class="author"> by SHCA</span>
  </p>
  
  <div class="content"><p>I'm on Vista Business, but had exactly the same problem of the volume icon not appearing, and the checkbox greyed out.  I just clicked the "ssdp automatic" registry patch.  That didn't work on its own.  Rebooted and then clicked the "Upnp automatic" registry patch.  Reboot and it's been working for several weeks with no failure.  No need to patch and then keep repatching shell32.dll at all.</p>
<p>Thanks also for the analysis that it's just a problem with timing between startup and user logon.  I could not figure out why it was so seemingly random.  Yes indeed if I just wait for boot to complete before logging on, everything is fine. Now with the registry patches I don't need to wait.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2563"></a>
<div id="comment-2563" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2563" class="active">Congratulations</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-02-26 10:22</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>You were lucky. Reading this discussion you will find dozens of similar solutions that worked on one computer, but sadly not on the next. The idea behind all of them is to do something that changes the timing.</p>
<p>On a particular computer, changing the timing may lead to a relatively stable solution, so what you did is something everybody could try first—follow some of the hints and see whether they suffice.</p>
<p>If it works, fine. But there is no guarantee that it will still work after you install the next piece of software, not even that it will still work tomorrow. But anyway, as long as it works, enjoy.</p>
<p>If such trials don't lead to a solution, or if the solution does not survive the passage of time, you would have to go to the fundamental solution and patch shell32.dll.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2555"></a>
<div id="comment-2555" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2555" class="active">The patch that Nars made doesn&#039;t work on my XP machine anymore. </a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-02-19 02:56</span>
    <span class="author"> by solidsnake44</span>
  </p>
  
  <div class="content"><p>The patch nars made worked on my machine and then I did windows update and then it stopped working. When I reapply the patch it still doesn't work. How can I get this to work?</p>
<p>Windows XP machine.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2556"></a>
<div id="comment-2556" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2556" class="active">Need more info</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-02-19 16:27</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>What is your version of shell32.dll? Here I have 6.0.2900.6072, and this version has been patched successfully.</p>
<p>What exactly do you mean by "stopped working"? How do you know it stopped working?</p>
<p>To all: Has anybody else seen any problem?</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2558"></a>
<div id="comment-2558" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2558" class="active">I have the 6.0.2900.6072</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-02-19 23:08</span>
    <span class="author"> by solidsnake44</span>
  </p>
  
  <div class="content"><p>I have the 6.0.2900.6072 version.</p>
<p>By stopped working I mean that after I did the windows updates awhile back, when I log into the computer right as I turn it on, all the icons do not load in the tray, but if I wait around 2 minutes and then log on, they will. Also if I log on fast, and then log off and log back on around a minute later it fixes.</p>
<p>The nars patch fixed this before so that I can log on immediately and then all the icons would load.</p>
<p>I used to be able to run the patch in normal mode but now it gives me errors that the unit was already patched or unrecognized version. Going into safe mode works and I was able to restore original and then repatch. The windows file protection never came up in safe mode, even though the patcher said it should.</p>
<p>This still did not work.</p>
<p>Temporarily I have disabled the SSDP service for the network discovery and have used BootVis optimize system along with the patch and it is now working. If I re enable the SSDP service it does not work anymore.</p>
<p>Before I could keep it on and now I can not. Therefore I don't think the patch did anything as that service is affecting me now. Or maybe they are working together?</p>
<p>The ideal solution would be to have the service on and have all the icons load still.</p>
<p>Thanks.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2559"></a>
<div id="comment-2559" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2559" class="active">Strange</a>  </h1>
    
    <p>
    <span class="date">Mon, 2012-02-20 06:53</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>Something does not work as expected, but I cannot tell what it is.</p>
<p>You can do a binary file compare, using the "fc /b …" command, to find out whether your shell32.dll is patched or not, by comparing it to the original file.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2560"></a>
<div id="comment-2560" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2560" class="active">I used beyond compare to see</a>  </h1>
    
    <p>
    <span class="date">Wed, 2012-02-22 03:09</span>
    <span class="author"> by solidsnake44</span>
  </p>
  
  <div class="content"><p>I used beyond compare to see that there are differences between the files. I'm not sure how to read if the differences are correct but they are different.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2561"></a>
<div id="comment-2561" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2561" class="active">Patched</a>  </h1>
    
    <p>
    <span class="date">Wed, 2012-02-22 06:57</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>If there are differences, but the files are of the same length, then the file is patched.</p>
<p>In that case we may have a new, as yet unknown problem.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2565"></a>
<div id="comment-2565" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2565" class="active">They are</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-03-18 04:44</span>
    <span class="author"> by solidsnake44</span>
  </p>
  
  <div class="content"><p>They are the same size. I'm still having the issue :( its upsettting.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2566"></a>
<div id="comment-2566" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2566" class="active">Different cause?</a>  </h1>
    
    <p>
    <span class="date">Sun, 2012-03-18 08:07</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>Perhaps your computer is one of the few where the problem comes from something other than the main cause described here. That would be bad luck. Please report, if you ever find out.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div></div></div></div></div></div></div><a id="comment-2508"></a>
<div id="comment-2508" class="comment not-by-node-author">

  <div class="picture">
  <img src="http://winhlp.com/files/pictures/picture-4695.gif" alt="hitbit&#039;s picture" title="hitbit&#039;s picture"  /></div>

    <h1 class="title">
    <a href="/node/16#comment-2508" class="active">Missing Icons</a>  </h1>
    
    <p>
    <span class="date">Thu, 2011-09-01 14:41</span>
    <span class="author"> by hitbit</span>
  </p>
  
  <div class="content"><p>Installed Windows Essentials &amp; Comodo Firewall. Icons would not appear in notification area. Contacted Microsoft help who seemed to think I had a virus and had me run full scans with MalWareBytes, ( which I already had installed on my system ) Vipre Online Scan, Norton Power Eraser and finally Microsoft Safety Scanner. ( None of them found a problem ). This took about 30 hrs due to the amount of files on my system. They then had me check my date and time settings. ( which were ok ) This was followed by running a trouble shooter to "fix" windows. Then it was uninstall and re-install Essentials. After all this the icons were still missing. Then I posted a request for help on Comodo support which directed me to a patch for solving this problem developed by Paul &amp; Nara and available on this site. I duly installed the patch and immediately the Essentials and Comodo icons appeared along with the safely remove hardware and volume icons which were missing for 2 years. My deepest thanks to those who developed this patch and to this site for making it available. Its a pity Microsoft could not be honest and acknowledge this XP problem and direct people to this site if they themselves are unable to develop a problem solving patch. Good one Winhlp. Bad one Microsoft.</p>
<p>hitbit</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2488"></a>
<div id="comment-2488" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2488" class="active">The solution is very simple</a>  </h1>
    
    <p>
    <span class="date">Sat, 2011-05-14 17:35</span>
    <span class="author"> by wildbill24</span>
  </p>
  
  <div class="content"><p>Don't listen to these people telling you to disable plug/play and other such services, all you will do is screw things up even further, they don't have a clue what they are talking about. All you need to do is password protect your username then when the startup screen containing your username comes up simply let the computer load until all hard drive activity stops, punch in your password and windows will load all system tray icons as it should. very simple. I have done this on two very different machines that I was having this exact same problem with and it works perfectly every single time without exception. No need for all this techno babel and poking around the registry. Like to old saying goes........"Keep it simple stupid!"</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2489"></a>
<div id="comment-2489" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2489" class="active">Works for some</a>  </h1>
    
    <p>
    <span class="date">Sat, 2011-05-14 17:41</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>Yes, it works for some, but not for others. The problem appears in different magnitudes on different computers.</p>
<p>The best solution still seems to be the shell32.dll patch.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2463"></a>
<div id="comment-2463" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2463" class="active">Offsets for NEW shell32.dll version 6.0.2900.6072</a>  </h1>
    
    <p>
    <span class="date">Wed, 2011-02-16 02:24</span>
    <span class="author"> by sob8</span>
  </p>
  
  <div class="content"><p>I used nars' patcher tool, and it worked perfectly for me too on the new 6.0.2900.6072 file.  I then opened the original version and the patched version side by side in a hex editor and ran a comparison.  Below are the offsets that the patcher tool modified.</p>
<p>00069a1c  changed from  a0 to  60<br />
00069a1d  changed from  0f to  ea<br />
00069a21  changed from  03 to  01</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2461"></a>
<div id="comment-2461" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2461" class="active">Nar&#039;s Routine for Patching shell32.dll Worked for me</a>  </h1>
    
    <p>
    <span class="date">Sat, 2011-02-12 18:05</span>
    <span class="author"> by rcwaszak</span>
  </p>
  
  <div class="content"><p>HipServ Agent (media storage) returned "Could not set icon" error message at startup on 1 of 2 XP SP3 home computers.  After much searching I found this thread on missing icons.  After reading (and multiple re-readings) of this thread I tried 2 approaches.  First, I disabled all the unnecessary startup programs and that "fixed" the problem.  Being the inquesitive type I then re-enabled all my startup programs and received the same error message upon restart.  I also stopped and restarted explorer.exe after startup and found that my HipServ icon was restored via that process.  I then applied Nar's process to patch and replace the shell32.dll (ver 6.0.2900.6072).  Worked well for me.  Thank you all for the incredible amount of time spent on this problem.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2459"></a>
<div id="comment-2459" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2459" class="active">logout+login</a>  </h1>
    
    <p>
    <span class="date">Mon, 2011-02-07 15:04</span>
    <span class="author"> by danielsoft</span>
  </p>
  
  <div class="content"><p>Thanks for this article. At home, I use mostly Linux, but I have this systray problem at my Windows computer at work. The Ostuni workaround did not work for me. Additionaly, I am not comfortable with patching a system DLL library in our corporate environment: I am capable to do this, but our sysadmins will not be happy after that I guess - so my workaround is this:</p>
<p>When the computer boots, I log in. I wait after all the icons appear, they are wrong. After the system sort of "settles", all desktop icons are loaded etc. I log off and then I log in again. After that, the systray icons are displayed correctly. </p>
<p>Because I boot my computer only few times a week, I am sort of happy with this workaround.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2430"></a>
<div id="comment-2430" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2430" class="active">Finally!</a>  </h1>
    
    <p>
    <span class="date">Mon, 2010-12-27 16:32</span>
    <span class="author"> by CharlesW66</span>
  </p>
  
  <div class="content"><p>Thank you nars and tasmanian.  The nars patcher tool worked perfect.  It fixed the volume icon problem when everything else I tried failed!</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2409"></a>
<div id="comment-2409" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2409" class="active">Startright got it right for me</a>  </h1>
    
    <p>
    <span class="date">Mon, 2010-11-22 02:05</span>
    <span class="author"> by Berzerk</span>
  </p>
  
  <div class="content"><p>After years of ghostly events in my Systray regarding a few disappearing icons including VOLUME (speaker thing) and annoying PC sound 'beeps' which automatically took the place of some usual windows sounds (alerts, warnings, etc.), everything is now sorted out. I tried to apply the Ostuni which seems very popular around here, but the option was already correct on my system, so Ostuni got me nowhere. I read a comment about 'startright' software and decided to give it a try. Result: wow! SOundi icon is back, windows sounds have taken the place of the annoying PC "beeps". Miracle. Me not being a computer expert, I can only say thanks Startright :D!</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2302"></a>
<div id="comment-2302" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2302" class="active">What worked for me. (10-25-10)</a>  </h1>
    
    <p>
    <span class="date">Mon, 2010-10-25 20:19</span>
    <span class="author"> by mjbahr007</span>
  </p>
  
  <div class="content"><p>I rebooted my computer pressing F8, went to safe mode in XP, made another user account, then did a restore, (earlier restores under my bad account did not take), the restore took under the new account and when I restarted my computer under my old account name the toolbar came back.  My computer did an automatic Windows XP update, (16 files) because of the restore date I chose, but seems to have kept working with the system tray restored.  Note this is a real pain in the a$$ problem does anyone know what is causing it?</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2303"></a>
<div id="comment-2303" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2303" class="active">Read!</a>  </h1>
    
    <p>
    <span class="date">Mon, 2010-10-25 21:07</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>There seem to be some people who can only write, but not read. You haven't even read that every comment already has its date automatically and that therefore nobody else here adds another date by hand, particularly not to the heading.</p>
<p>Not to mention that your solution is already explained in the main article above, along with much better ones.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2246"></a>
<div id="comment-2246" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2246" class="active">patcher tool</a>  </h1>
    
    <p>
    <span class="date">Sat, 2010-10-09 22:59</span>
    <span class="author"> by nars</span>
  </p>
  
  <div class="content"><p>First I would like to say thanks to tasmanian for the real solution for this problem, and shame on MS that didn't fixed it...</p>
<p>I do use the suggested patch for more than 1 year now and it works perfectly! however tired of applying it each time MS updates shell32.dll, or on new Windows installs, I did decided to create a small patcher tool, I think it can be useful for other people having the same problem, you can download it at:</p>
<p><a href="http://nars.aloj.net/download/shell32patch.zip" title="http://nars.aloj.net/download/shell32patch.zip">http://nars.aloj.net/download/shell32patch.zip</a></p>
<p>The patcher tool should work with every new version of shell32.dll as it will find offset automatically and will take care of Windows File Protection obviously...</p>
<p>If anyone finds any problem with the tool please let me know.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2474"></a>
<div id="comment-2474" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2474" class="active">Many, many thank yous!!!</a>  </h1>
    
    <p>
    <span class="date">Sun, 2011-03-06 00:21</span>
    <span class="author"> by Jake</span>
  </p>
  
  <div class="content"><p>Your patch did the trick!  I have been pulling my hair working on this customer’s laptop.  He caused the problem playing with "registry optimizing" tools; people please stay away from those products!  I had followed some of the registry entries shown in this forum with a little success but this patch TOTALLY fixed the issue of the notification icons (speaker, network, power/battery and more) that had disappeared.  He was VERY close to a reformat and fresh install!  Microsoft’s tech site is useless in solving this icon disappearing issue.</p>
<p>Thank you for all your hard work and I thank everyone here for all the incredible information and comments on this site!!!</p>
<p>Jake...</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2251"></a>
<div id="comment-2251" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2251" class="active">Sounds great</a>  </h1>
    
    <p>
    <span class="date">Tue, 2010-10-12 08:21</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>This appears to be the ultimate workaround that everybody should use.</p>
<p>I haven't had a chance to test it yet. If anybody uses it, please report your results.</p>
<p>Addendum 2011-03-01: Meanwhile I have tested it on two computers, and it worked perfectly. Recommended! And a big thanks to <a href="/user/3651">nars</a>.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2250"></a>
<div id="comment-2250" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2250" class="active">Thank you for the</a>  </h1>
    
    <p>
    <span class="date">Mon, 2010-10-11 08:44</span>
    <span class="author"> by manzilla</span>
  </p>
  
  <div class="content"><p>Thank you for the contribution nars - any chance you'd like to share the source with us as well?</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2263"></a>
<div id="comment-2263" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2263" class="active">source</a>  </h1>
    
    <p>
    <span class="date">Wed, 2010-10-13 16:55</span>
    <span class="author"> by nars</span>
  </p>
  
  <div class="content"><p>it is a very simple tool, here is the source:<br />
<a href="http://nars.aloj.net/download/shell32patch_src.rar" title="http://nars.aloj.net/download/shell32patch_src.rar">http://nars.aloj.net/download/shell32patch_src.rar</a><br />
sorry for the Portuguese language comments in the code :)</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2491"></a>
<div id="comment-2491" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2491" class="active">Could you please give a new</a>  </h1>
    
    <p>
    <span class="date">Sun, 2011-06-05 05:45</span>
    <span class="author"> by nitai4andra</span>
  </p>
  
  <div class="content"><p>Could you please give a new link to the source - this one gets "404 Not Found" :-(</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2490"></a>
<div id="comment-2490" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2490" class="active">Unfortunately while trying to</a>  </h1>
    
    <p>
    <span class="date">Sat, 2011-06-04 15:21</span>
    <span class="author"> by nitai4andra</span>
  </p>
  
  <div class="content"><p>Unfortunately while trying to download source from -- <a href="http://nars.aloj.net/download/shell32patch_src.rar" title="http://nars.aloj.net/download/shell32patch_src.rar">http://nars.aloj.net/download/shell32patch_src.rar</a> -- I've got "404 Not Found" :-(</p>
<p>Could you please upload it once again? Thanks in advance!</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2492"></a>
<div id="comment-2492" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2492" class="active">Try to contact nars directly</a>  </h1>
    
    <p>
    <span class="date">Sun, 2011-06-05 12:45</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>Yes, the source is apparently no longer there.</p>
<p>Perhaps you could try to contact <a href="/user/3651">nars</a> directly via his contact form.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2510"></a>
<div id="comment-2510" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2510" class="active">Missing volume icon recovered</a>  </h1>
    
    <p>
    <span class="date">Thu, 2011-09-08 10:11</span>
    <span class="author"> by elsedavid@hotma...</span>
  </p>
  
  <div class="content"><p>For months I had been trying to recover the volume control icon permanently.  I had tried most of the solutions listed on the topic but although some of them worked for possibly one re-start the icon was soon missing again.  Like previous reports when I downloaded from the link: <a href="http://nars.aloj.net/download/shell32patch.zip" title="http://nars.aloj.net/download/shell32patch.zip">http://nars.aloj.net/download/shell32patch.zip</a>  and tried to un-zip the file I received the error:  'The Compressed (zipped) Folder is invalid or corrupted'.  My file version is 6.0.2900.6072.  I used the very useful information provided by sob8 and the Hex editor recommended earlier to modify my shell32 file.  I needed to install the file in ‘safe mode’.  All was then correct and the icon appears all the time.</p>
<p>I then contacted ‘nars’ and informed him that the link was not working or the file was corrupt.  He kindly sent me the file.  This file unzipped correctly.  I restored the original shell32 file applied the patch and the changes were made and all is well with the volume icon. </p>
<p>All the above was on my main computer which is running Windows Professional XP SP3.  Today I am using another one of my computers with Windows 7 Ultimate.  I do not have an issue with the volume icon on this machine but out of curiosity I tried the link above and it un-zipped perfectly.  Today it still gives the un-zipping error on my XP computer!   Most curious! </p>
<p>The link: <a href="http://nars.aloj.net/download/shell32patch_src.rar" title="http://nars.aloj.net/download/shell32patch_src.rar">http://nars.aloj.net/download/shell32patch_src.rar</a>  gives the error 404 on both computers when trying to download it.</p>
<p>Thank you sob8 for writing down the changes but most of all thank  you nars for the patch.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2511"></a>
<div id="comment-2511" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2511" class="active">Attached here</a>  </h1>
    
    <p>
    <span class="date">Thu, 2011-09-08 13:22</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>I just downloaded and unpacked the ZIP file without any problem. I have now attached it to the main article at the top, just in case others have the same problem.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div></div></div></div></div></div><a id="comment-2231"></a>
<div id="comment-2231" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2231" class="active">Finally - *real* results.</a>  </h1>
    
    <p>
    <span class="date">Thu, 2010-09-30 18:34</span>
    <span class="author"> by manzilla</span>
  </p>
  
  <div class="content"><p>Had this issue in the past but the UPnP trickery had worked for me - until I ditched AVG and started using Comodo as my AV (already using it for firewall). I do like Comodo, it has alleviated issues I was having with AVG, it just happened to slaughter my startup programs. I was starting to lose hope, and actually contemplating a Windows flush (and a faster system drive too)...</p>
<p>And then I found this site. *Gold*.</p>
<p>[XPSP3] I backed up my original shell32.dll (6.0.2900.6018) then patched another separate copy of my shell32.dll with the values TeaRex posted using Hex Editor Neo (good freeware hex editor btw). DLL Replacer didn't work for me, so I installed the recovery console and 1) Browsed to C:\windows\system32   2) Deleted the shell32.dll   3) Copied shell32_patched.dll to shell32.dll   4) Reboot and happiness ensued.</p>
<p>Systray icons working %100 since (three days now, random reboots/shutdowns just to see) and no side-effects have been noticed.</p>
<p>Thank you to tasmanian (you sleuth you!), depassp, mcrealize and TeaRex, and of course to WinHlp.com for bringing all this together.</p>
<p>See you when SP4 is released :)</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2232"></a>
<div id="comment-2232" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2232" class="active">Recovery Console</a>  </h1>
    
    <p>
    <span class="date">Thu, 2010-09-30 19:59</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>I'm surprised that Windows didn't change shell32.dll back again on its first boot. Some magic in Recovery Console perhaps? Sounds a bit unlikely, but who knows?</p>
<p>Anyway, glad you got it to work.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2203"></a>
<div id="comment-2203" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2203" class="active">Missing Tray Icons</a>  </h1>
    
    <p>
    <span class="date">Sun, 2010-09-05 12:58</span>
    <span class="author"> by Charlie2244</span>
  </p>
  
  <div class="content"><p>The log off then log back on worked for me.<br />
But now they are all back after I uninstalled Norton IS 2010. I installed a free antivirus program.<br />
WXP sp3 laptop</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2153"></a>
<div id="comment-2153" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2153" class="active">Disappearing  Clipmate Systray Icon</a>  </h1>
    
    <p>
    <span class="date">Tue, 2010-08-10 23:37</span>
    <span class="author"> by beagun</span>
  </p>
  
  <div class="content"><p>The most utilized utility I have is Thronsoft's Clipmate, and its systray icon started disappearing after a MS update some months ago. The problem was intermittent. The solution was to uncheck all items related to Startup on the Clipmate<br />
Tools-&gt; Options-&gt; General screen. Clipmate will then fail to load at startup. When loaded manually, Icon always appears and remains in the systray.  - Therefore, as mentioned in several places above, it is a timing problem.</p>
<p>Just deleting it from the Microsoft or "Starter" startup list is insufficient.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2142"></a>
<div id="comment-2142" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2142" class="active">yes it works !</a>  </h1>
    
    <p>
    <span class="date">Thu, 2010-08-05 08:22</span>
    <span class="author"> by LTH</span>
  </p>
  
  <div class="content"><p>thanks for this tricks, in my case switching to XP theme solved the trouble</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-2072"></a>
<div id="comment-2072" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2072" class="active">Disappearing Icons in Systray</a>  </h1>
    
    <p>
    <span class="date">Wed, 2010-07-14 10:55</span>
    <span class="author"> by Maccyroo</span>
  </p>
  
  <div class="content"><p>If you suffer from this problem there are many fixes to choose from. The best one i have tried only works if taskmanager is showing the relevant startup process is running but the systray icons are missing. I use a free startup manager from r2 studios <a href="http://www.r2.com.au/software.php?page=2&amp;show=startdelay" title="http://www.r2.com.au/software.php?page=2&amp;show=startdelay">http://www.r2.com.au/software.php?page=2&amp;show=startdelay</a></p>
<p>Just click on the items that are loading but not showing up in the systray and insert a delay time for each each affected program. I have found, that to get this to work properly, you should not set any of the delay times to less than a minute and leave a minimum 10 second gap between each process.</p>
<p>If you have a lot of missing icons, then obviously your total boot time will increase. So you may have to just choose the most important items you need. Or be prepared for boot times to increase.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="indented"><a id="comment-2073"></a>
<div id="comment-2073" class="comment">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2073" class="active">Solution</a>  </h1>
    
    <p>
    <span class="date">Wed, 2010-07-14 15:50</span>
    <span class="author"> by admin</span>
  </p>
  
  <div class="content"><p>But don't overlook the perfect solution, <a href="#Main_problem_and_complete_solution">explained above</a>. It is a defect in shell32.dll, after all.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

</div><a id="comment-2020"></a>
<div id="comment-2020" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-2020" class="active">UPnP worked for me</a>  </h1>
    
    <p>
    <span class="date">Wed, 2010-06-16 15:11</span>
    <span class="author"> by toucan</span>
  </p>
  
  <div class="content"><p>After reading the solution about hiding UPnP devices, I suspected that it would help as I had just recently got a new router and had been messing around with UPnP devices. Hiding them worked perfectly. Hope this helps someone else. Thanks.</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<a id="comment-1983"></a>
<div id="comment-1983" class="comment not-by-node-author">

  <div class="picture">
  </div>

    <h1 class="title">
    <a href="/node/16#comment-1983" class="active">ok, even patching with the</a>  </h1>
    
    <p>
    <span class="date">Fri, 2010-06-04 07:29</span>
    <span class="author"> by SHSH</span>
  </p>
  
  <div class="content"><p>ok, even patching with the "fundamental" method isnt doing the trick. It gets better though, but still: a few icons are missing. I guess WinXP is simply overstrained by putting lots of apps into autostart... - thats the bottom line</p>
</div>

  <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="/user/login?destination=comment%2Freply%2F16%23comment-form">Login</a> or <a href="/user/register?destination=comment%2Freply%2F16%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div>

<div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a href="/node/16?page=1&amp;_=" title="Go to page 2" class="active">2</a></li>
<li class="pager-item"><a href="/node/16?page=2&amp;_=" title="Go to page 3" class="active">3</a></li>
<li class="pager-next"><a href="/node/16?page=1&amp;_=" title="Go to next page" class="active">next ›</a></li>
<li class="pager-last last"><a href="/node/16?page=2&amp;_=" title="Go to last page" class="active">last »</a></li>
</ul></div><form action="/node/16"  accept-charset="UTF-8" method="post" id="comment-controls">
<div><div class="box">
    <h1 class="title">Comment viewing options</h1>
  
  <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-A6m6GEFEWXogoOLbx45tGIcuqsQnaDClYXHg6eCrd88" value="form-A6m6GEFEWXogoOLbx45tGIcuqsQnaDClYXHg6eCrd88"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4" selected="selected">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1" selected="selected">Date - newest first</option><option value="2">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50" selected="selected">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
</div>

</div></form>
</div>
    </td>

        <td id="right-sidebar" class="sidebar"><div id="block-user-0" class="block block-user">
    <div class="title">User login</div>
  
  <div class="content"><form action="/node/16?destination=node%2F16%3F_%3D"  accept-charset="UTF-8" method="post" id="user-login-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Username: <span class="form-required" title="This field is required.">*</span></label>
 <input type="text" maxlength="60" name="name" id="edit-name" size="15" value="" class="form-text required" />
</div>
<div class="form-item" id="edit-pass-wrapper">
 <label for="edit-pass">Password: <span class="form-required" title="This field is required.">*</span></label>
 <input type="password" name="pass" id="edit-pass"  maxlength="60"  size="15"  class="form-text required" />
</div>
<input type="submit" name="op" id="edit-submit-1" value="Log in"  class="form-submit" />
<div class="item-list"><ul><li class="first"><a href="/user/register" title="Create a new user account.">Create new account</a></li>
<li class="last"><a href="/user/password" title="Request new password via e-mail.">Request new password</a></li>
</ul></div><input type="hidden" name="form_build_id" id="form-lmIOLruVhMhaWtnF3Ize4QHd8GoReNuttkOTFFPW4RA" value="form-lmIOLruVhMhaWtnF3Ize4QHd8GoReNuttkOTFFPW4RA"  />
<input type="hidden" name="form_id" id="edit-user-login-block" value="user_login_block"  />

</div></form>
</div>
</div>

<div id="block-block-1" class="block block-block">
  
  <div class="content"><p style="margin-top: 0.4em; font-size: 122%; font-weight: bold; color: #238">Donate</p>
<p style="margin-top: 0.2em">If this web site has helped you, please help us too!</p>
<p style="margin-top: 0; text-align: center">Send <a href="http://bitcoin.org/">Ƀitcoins</a> <input type="button" value="to" onclick="prompt('Press Ctrl+C or Cmd+C to copy the bitcoin donation address to the clipboard, then Esc.', '19KoHJzbFMBD2EaAzox7bsjKhMNLva21sm');" style="font-size: 13px;" /><br /><a href="bitcoin:19KoHJzbFMBD2EaAzox7bsjKhMNLva21sm?label=winhlp.com" style="font-size: 9px;">19KoHJzbFMBD2EaAzox7bsjKhMNLva21sm</a></p>
<p style="text-align: center;"><a href="http://bitcoin.org/"><img src="/images/bitcoin_logo_2012_86px.png" alt="Bitcoin logo" title="Bitcoin logo" style="width: 86px; height: 86px; vertical-align: middle;" /></a> <img src="/images/bitcoin_qr.png" alt="QR code of the bitcoin donation address" title="QR code of the bitcoin donation address" style="width: 87px; height: 87px; vertical-align: middle;" /></p>
<p style="margin-top: 0.3em;">If you would like to receive a confirmation email, please <a href="mailto:Hans-Georg Michna <hans-georgxxxremovexxx@michna.com>" onclick="var obfuscated = this.getAttribute('href'); var obfuscatorString = 'xxxremovexxx'; if (obfuscated.indexOf(obfuscatorString) > 0) { this.href = obfuscated.split(obfuscatorString)[0] + obfuscated.split(obfuscatorString)[1] + '?subject=Bitcoin donation for winhlp.com&body=Hi Hans,%0D%0A%0D%0AI am donating BTC___ for winhlp.com.%0D%0A%0D%0AGreetings - ___'; }">send me an email</a> mentioning your bitcoin address or the amount.</p></div>
</div>

<div id="block-blog-0" class="block block-blog">
    <div class="title">Recent blog posts</div>
  
  <div class="content"><div class="item-list"><ul><li class="first"><a href="/node/903">Deciphering the gray of Google&#039;s &#039;Play Edition&#039; upgrade promise</a></li>
<li><a href="/node/890">This is why people pirate</a></li>
<li><a href="/node/886">How Apple and Amazon security flaws led to my epic hacking</a></li>
<li><a href="/node/880">28c3: Print me if you dare (video)</a></li>
<li><a href="/node/878">Stop SOPA Now</a></li>
<li><a href="/node/877">28c3: How governments have tried to block Tor (video)</a></li>
<li><a href="/node/875">Google’s disk failure experience</a></li>
<li><a href="/node/868">Hacked!</a></li>
<li><a href="/node/866">Gamers solve problem that riddled scientists for 15 years</a></li>
<li class="last"><a href="/node/860">Small ISPs use &quot;malicious&quot; DNS servers to watch Web searches, earn cash</a></li>
</ul></div><div class="more-link"><a href="/blog" title="Read the latest blog entries.">more</a></div></div>
</div>

<div id="block-aggregator-feed-1" class="block block-aggregator">
    <div class="title">Windows news ticker</div>
  
  <div class="content"><div class="item-list"><ul><li class="first"><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNGq32OQEm9tukM16HfPCLOgT0lbeQ&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://searchvirtualdesktop.techtarget.com/news/2240225321/Chromebooks-VDI-go-hand-in-hand-for-IT-a">Chromebooks, VDI go hand-in-hand for IT admins - TechTarget</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNGPXKGKnLZRkmKTivbbWdHYA_H1KA&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.myeasternshoremd.com/news/kent_county/article_e6105c83-2779-589e-9d1d-c21cc4258daa.html">Tempers flare over college rentals - My Eastern Shore</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNE3CdJasw9Z6car0X6NoSawz8181w&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.forbes.com/sites/kashmirhill/2014/07/23/how-your-security-system-could-be-used-to-spy-on">How Your Security System Could Be Hacked To Spy On You - Forbes</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNFnrcyCnl-An4fnAmaFs9Ll4kwNGw&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://blogs.wsj.com/cio/2014/07/23/the-morning-download-microsoft-shows-hybrid-cloud-strategy-gain">The Morning Download: Microsoft Shows Hybrid Cloud Strategy Gains Traction ... - Wall Street Journal (blog)</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNFQGXhtFRBFhVPoXFlftFYn-IOzNg&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.gamedev.net/topic/659050-c-files-organisation/">C++ files organisation - GameDev.net</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNFSN8a3xottkC8C9n9Rss08_0cgWA&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;cid=52778565599266&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=https://www.business-cloud.com/articles/news/cloudsigma-offers-openvpn">CloudSigma offers OpenVPN - Business-Cloud.com</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNE2tWdcvJpKR1VU2RIEX7o6cfyiNQ&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.limaohio.com/news/lifestyle/30005769/John-Grindrod:-Looking-atlife-from-both-sides-of-th">John Grindrod: Looking atlife from both sides of the fence - Lima Ohio</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNH5plCnXCxjA3jMmF_XMunLFsgFmw&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;cid=52778564958472&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.nzherald.co.nz/business/news/article.cfm?c_id%3D3%26objectid%3D112979">Juha Saarinen: Knocking off Nokia - New Zealand Herald</a>
</li>
<li><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNE7fW7yJWjYqkZT2jYB84F2V4zTkA&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.gamedev.net/topic/659036-issue-when-game-starts-unfocused-windows/">Issue when game starts unfocused (Windows) - GameDev.net</a>
</li>
<li class="last"><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;ct2=us&amp;usg=AFQjCNF_LYQXP1WNLwl9YFPWbPbspV9MLA&amp;clid=c3a7d30bb8a4878e06b80cf16b898331&amp;cid=52778565685358&amp;ei=muzPU7GlGK_bygOs7YDoBg&amp;url=http://www.itproportal.com/2014/07/22/can-you-protect-your-company-data-without-">Can you protect your company data without inspecting SSL? Here&#039;s 5 steps to ... - ITProPortal</a>
</li>
</ul></div><div class="more-link"><a href="/aggregator/sources/1" title="View this feed&#039;s recent news.">more</a></div></div>
</div>

</td>
      </tr>
  </table>

  <div id="footer">
    Copyright © 2002-2014 Hans-Georg Michna | <a href="/node/8">Web site info</a> | Powered by <a href="/node/8">Drupal</a><br />
All rights reserved, including the rights to rearrange, edit, abridge, delete.
      </div>

  </body>
</html>

