http://labs.neohapsis.com/category/neohapsis/
HTTP/1.1 200 OK
Server: nginx
Date: Thu, 24 Jul 2014 14:45:38 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Vary: Accept-Encoding
Vary: Cookie
X-hacker: If you're reading this, you should visit automattic.com/jobs and apply to join the fun, mention this header.
X-Pingback: http://labs.neohapsis.com/xmlrpc.php
Content-Encoding: gzip

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>Neohapsis Labs | Neohapsis</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://labs.neohapsis.com/xmlrpc.php" />

<!--[if lt IE 9]>
<script src="http://s1.wp.com/wp-content/themes/pub/newsworthy/js/html5.js?m=1363273823g" type="text/javascript"></script>
<![endif]-->
		<script src='//r-login.wordpress.com/remote-login.php?action=js&amp;host=labs.neohapsis.com&amp;id=2649112&amp;t=1406213138&amp;back=http%3A%2F%2Flabs.neohapsis.com%2Fcategory%2Fneohapsis%2F' type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel="alternate" type="application/rss+xml" title="Neohapsis Labs &raquo; Feed" href="http://labs.neohapsis.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Neohapsis Labs &raquo; Comments Feed" href="http://labs.neohapsis.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Neohapsis Labs &raquo; Neohapsis Category Feed" href="http://labs.neohapsis.com/category/neohapsis/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-0' href='http://s0.wp.com/_static/??-eJx9jtEOgjAMRX/IWTVKwoPxW2DUMejWhXZZ+HvBxBiD4a23Oae9UJKxHBWjQsgmUXY+CkjwhHOaeECrv+loRQ7wXyM/osCAmho7mnfa4C2x+wrsHHac1TyZiAsU3znc/WF5wmUfUqMrEbDzDRKGBdvTQqo+1jr2S8FtN+2XOwIptxCxSOFJ+xlEZ8KVfYT7+Xq61PWlqm7DC2uSdj0=' type='text/css' media='all' />
<link rel='stylesheet' id='newsworthy-oswald-css'  href='http://fonts.googleapis.com/css?family=Oswald%3A400%2C700%2C300&#038;ver=4.0-beta2-20140723' type='text/css' media='all' />
<link rel='stylesheet' id='all-css-2' href='http://s0.wp.com/_static/??-eJyNj+EKwjAMhF/IWsUi7of4LN0as0jXjCZjr2/dRBSl+Ct3cN+Rs2QTK3Wc5CW2ncjGzqMpRiGpHSYzxgmpZBDYRO68EqcPY67RU66hGdrIWCTaknqzNWhk0bXaSu/zA37e+pcJ8jrqp/xitYcBxPbOYuTWx1r5TAFBZRmxaoOZgvEpmEii/7LIHDL4sHxzGc57t3Onw9E1ze0OWR2YDw==' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJyFj1kOwjAMRC+ESVuBxA/iLF3cyCEbcUIEpyfQgtikfnlkv/HYInvonY1oo1AsjOtIIyTG0MrSA7KjWyteicKR7XUakO+gOiUMl7ksAmBIhjbi2pB9wm+p3nE0yFwi/0w/o8ieCfMipjD6tj9CQKbrz9ZOOwleJ0mWRdESB5cijE5rl0WmQWL89pj0ckzA481JQpeMh/mwg9nXm6ra7uqmatQNYEyEBw=='></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://neolab.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://neolab.wordpress.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />
<link rel="shortcut icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1405977958g" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1405977958g" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="http://s0.wp.com/i/webclip.png?m=1391188133g" />
<link rel='openid.server' href='http://neolab.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='http://neolab.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="http://labs.neohapsis.com/osd.xml" title="Neohapsis Labs" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com" />
<style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="Neohapsis Labs" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Security Blog" /><meta name="msapplication-task" content="name=Subscribe;action-uri=http://labs.neohapsis.com/feed/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="title" content="Posts about Neohapsis on Neohapsis Labs" />
<meta name="description" content="Posts about Neohapsis written by Patrick Thomas, Scott Behrens, neobrent, Jon Janego, and Cris Neckar" />
	<style type="text/css">
			.site-title a {
			color: #891b1b !important;
		}
		</style>
	<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="archive category category-neohapsis category-6268010 mp6 highlander-enabled highlander-light">

<div id="nav-wrapper">
<nav id="site-navigation" class="navigation-main" role="navigation">
	<div class="menu-wrapper">
	<h1 class="menu-toggle">Menu</h1>
	<div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>

	<div class="menu"><ul><li class="page_item page-item-8"><a href="http://labs.neohapsis.com/tools-releases/">Tools / Releases</a></li></ul></div>
	</div>
</nav><!-- #site-navigation -->
</div>

<div id="container">
	<header id="branding" role="banner">
      <div id="inner-header" class="clearfix">
		<hgroup id="site-heading">
			
			<h1 class="site-title"><a href="http://labs.neohapsis.com/" title="Neohapsis Labs" rel="home">Neohapsis Labs</a></h1>
			<h2 class="site-description">Security Blog</h2>
		</hgroup>

        	<form method="get" id="searchform" class="searchform" action="http://labs.neohapsis.com/" role="search">
		<label for="s" class="assistive-text">Search</label>
		<input type="search" class="field" name="s" value="" id="s" placeholder="Search &hellip;" />
		<input type="submit" class="submit" id="searchsubmit" value="Search" />
	</form>
      </div>
	</header><!-- #branding -->
    <div id="content" class="clearfix">

        <div id="main" class="column clearfix" role="main">

		
			<header class="page-header">
				<h1 class="page-title">
					Category Archives: <span>Neohapsis</span>				</h1>
							</header><!-- .page-header -->

						
				<article id="post-2011" class="post-2011 post type-post status-publish format-standard hentry category-information-security category-neohapsis category-security-industry category-windows tag-home tag-information-security tag-infosec tag-microsoft tag-small-business tag-windows tag-xp">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/" rel="bookmark">03.31.14</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/pthomasneohapsis/" title="View all posts by Patrick Thomas" rel="author">Patrick Thomas</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/" rel="bookmark">Putting Windows XP Out To&nbsp;Pasture</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<blockquote><p>Farewell, Windows XP! We hated you, then loved you, and soon we&#8217;ll hate you again.</p></blockquote>
<p style="text-align:justify;"> <em>(This post is a resource for home and small-business users with questions about the impending end-of-life for Windows XP. Larger enterprise users have some different options available to them; </em><a href="http://neohapsis.com/company/general_reg.php"><em>contact us</em></a><em> to discuss your situation and options.)</em></p>
<p style="text-align:justify;">For those who haven&#8217;t seen it in the news yet: Microsoft will be <a href="http://www.microsoft.com/en-us/windows/enterprise/end-of-support.aspx">ending support</a> for its hugely successful operating system, Windows XP, on April 8th. This means that users of the 12-year-old operating system will no longer be able to get updates, and in particular will not be able to get security updates. Users of more modern versions of Windows, such as Windows Vista or Windows 7 will remain supported for <a href="http://windows.microsoft.com/en-us/windows/lifecycle">several more years</a>.</p>
<p style="text-align:justify;">Once support ends, computers still on Windows XP will become a very juicy target for Internet criminals and attackers. Internet crime is big business, so every day there are criminals looking for new weaknesses in computer systems (called <a href="http://en.wikipedia.org/wiki/Vulnerability_(computing)">vulnerabilities</a>), and developing attacks to take advantage of them (these attacks are called <a href="http://en.wikipedia.org/wiki/Exploit_(computer_security)">exploits</a>). Normally, the software vendor (Microsoft in this case) quickly finds out about these weaknesses and releases updates to fix them. When an exploit is developed, some number of people fall victim shortly after the <a href="http://en.wikipedia.org/wiki/Zero-day_attack">exploit is first used</a>, but people who get the update in a relatively timely manner are protected.</p>
<p style="text-align:justify;">But what happens when a vendor stops updating the software? All of a sudden, the bad guys can use these same attacks, the same exploits, indefinitely. As a product nears end of life, attackers have an incentive to hold off on using critical vulnerabilities until the deadline passes. The value of their exploits goes up significantly once they have confidence that the vendor will never patch it. Based on that, we can expect a period of relative quiet in terms of announced vulnerabilities affecting XP from now until shortly after the deadline, when we will likely see stockpiled critical vulnerabilities begin circulating. From then on, the risk of these legacy XP systems will continue to increase, so migrating away from XP or dramatically isolating the systems should be a priority for people or organizations that still use them.</p>
<h2><strong>How do I know if I&#8217;m running Windows XP?</strong></h2>
<ul>
<li>If your computer is more than 5 years old, odds are it is running Windows XP</li>
<li>Simplest way: &#8220;Win+Break&#8221;: Press and hold down the Windows key on your keyboard, then find the &#8220;Pause&#8221; or &#8220;Break&#8221; key and press it. Let both keys go. That will show the System Properties windows. You may have to hunt around for your &#8220;Pause/Break&#8221; key, but hey, it finally has a use.</li>
<li>Alternate way: Click the Start Menu -&gt; Right click on &#8220;My Computer&#8221; -&gt; On the menu that comes out, click on Properties</li>
</ul>
<p>&nbsp;</p>
<div style="width: 400px" class="wp-caption alignnone"><a href="http://neolab.files.wordpress.com/2014/03/windows-xp-start-my-computer-properties-annotated.png"><img id="i-2020" class=" wp-image" src="http://neolab.files.wordpress.com/2014/03/windows-xp-start-my-computer-properties-annotated.png?w=390&#038;h=369" alt="Image" width="390" height="369" /></a><p class="wp-caption-text">Click the Start Menu, then right-click My Computer, then click Properties.</p></div>
<p>&nbsp;</p>
<div style="width: 299px" class="wp-caption alignnone"><a href="http://neolab.files.wordpress.com/2014/03/windows-xp-system-properties-annotated.png"><img id="i-2021" class=" wp-image" src="http://neolab.files.wordpress.com/2014/03/windows-xp-system-properties-annotated.png?w=289&#038;h=324" alt="Image" width="289" height="324" /></a><p class="wp-caption-text">Your version of Windows will be the first thing on the System Properties window.</p></div>
<p>&nbsp;</p>
<h2><strong>How do I stay safe?</strong></h2>
<p style="text-align:justify;">Really, you should think about buying a new computer. You can think of it as a once a decade spring cleaning. If your computer is old enough to have Windows XP, having an unsupported OS is likely just one of several problems. It is possible to <a href="http://windows.microsoft.com/en-us/windows7/help/upgrading-from-windows-xp-to-windows-7">upgrade your old computer</a> to a newer operating system such as Windows 7, or <a href="http://www.pcworld.com/article/2107641/3-easy-linux-alternatives-for-windows-xp-refugees-who-dont-want-a-new-pc.html">convert to a free Linux-based operating system</a>, but this may be a more complicated undertaking than many users want to tackle.</p>
<p style="text-align:justify;">Any computer you buy these days will be a huge step up from a 7-year old (at least!) machine running XP, so you can comfortably shop the cheapest lines of computers. New computers can be found for $300, and it&#8217;s also possible to buy reputable refurbished ones with a modern operating system for $100-$200.</p>
<p style="text-align:justify;">For those who really don&#8217;t want to or can&#8217;t upgrade, the situation isn&#8217;t pretty. Your computer will continue to work as it always has, but the security of your system and your data is entirely in your hands. These systems have been low-hanging fruit for attackers for a long time, but after April 8th they will have a giant neon bull&#8217;s-eye on them.</p>
<p style="text-align:justify;">There are a few things you can do to reduce your risks, but there really is no substitute for timely vendor patches.</p>
<ol>
<li>Only use the system for tasks that can&#8217;t be done elsewhere. If the reason for keeping an XP machine is to run some specific program or piece of hardware, then use it <em>only</em> for that. In particular, avoid web browsing and email on the unsupported machine: both activities expose the vulnerable system to lots of untrusted input.</li>
<li>Keep all of your other software up to date. Install and use the latest version of <a style="font-style:normal;" href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a> or <a style="font-style:normal;" href="https://www.google.com/intl/en/chrome/browser/">Chrome</a> web browsers, which won&#8217;t be affected by Microsoft&#8217;s end of life.</li>
<li>Back up your computer. There are many online backup services available for less than $5 a month. If something goes wrong, you want to make sure that your data is safe. Good online backup services provide a &#8220;set it and forget it&#8221; peace of mind. This is probably the single most important thing you can do, and should be a priority even for folks using a supported operating system. <a style="font-style:normal;" href="http://www.backblaze.com/">Backblaze</a>, <a style="font-style:normal;" href="https://www.crashplan.com/">CrashPlan</a>, and <a style="font-style:normal;" href="https://spideroak.com/">SpiderOak</a> are all reasonable choices for home users.</li>
<li>Run antivirus software, and keep it up to date. <a style="font-style:normal;" href="http://www.avast.com/index#upgrade">AVAST</a>, <a style="font-style:normal;" href="http://free.avg.com/us-en/homepage">AVG</a>, and <a style="font-style:normal;" href="http://www.bitdefender.com/solutions/free.html">Bitdefender</a> are all reasonable free options but be aware that antivirus is only a layer of protection: it&#8217;s not perfect.</li>
</ol>
<p>&nbsp;</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-2011"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-2011"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-2011"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/information-security/security-industry/" rel="category tag">Security Industry</a>, <a href="http://labs.neohapsis.com/category/windows/" rel="category tag">Windows</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/home/" rel="tag">Home</a>, <a href="http://labs.neohapsis.com/tag/information-security/" rel="tag">Information Security</a>, <a href="http://labs.neohapsis.com/tag/infosec/" rel="tag">infosec</a>, <a href="http://labs.neohapsis.com/tag/microsoft/" rel="tag">Microsoft</a>, <a href="http://labs.neohapsis.com/tag/small-business/" rel="tag">Small Business</a>, <a href="http://labs.neohapsis.com/tag/windows/" rel="tag">Windows</a>, <a href="http://labs.neohapsis.com/tag/xp/" rel="tag">XP</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/#comments" title="Comment on Putting Windows XP Out To&nbsp;Pasture">5 Comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1936" class="post-1936 post type-post status-publish format-standard hentry category-application-security-2 category-information-security category-neohapsis category-privacy-2 category-security-industry tag-credit-card tag-fraud tag-phishing tag-privacy tag-social-engineering">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/" rel="bookmark">01.07.14</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/pthomasneohapsis/" title="View all posts by Patrick Thomas" rel="author">Patrick Thomas</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/" rel="bookmark">Gutting a Phish</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>In the news lately there have been countless examples of phishing attacks becoming more sophisticated, but it&#8217;s important to remember that entire &#8220;industry&#8221; is a bell curve: the most dedicated attackers are upping their game, but advancements in tooling and automation are also letting many less sophisticated players get started even more easily. Put another way, spamming and phishing are coexisting happily as both massive multinational business organizations and smaller cottage-industry efforts.</p>
<p>One such enterprising but misguided individual made the mistake of sending a typically blatant phishing email to one of our Neohapsis mailing lists, and someone forwarded it along to me for a laugh.</p>
<div style="width: 595px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/12/initial-phish-email-for-blog.png"><img alt="Initial Phish Email" src="http://neolab.files.wordpress.com/2014/12/initial-phish-email-for-blog.png?w=585&#038;h=144" width="585" height="144" /></a><p class="wp-caption-text">The phishing email, as it appeared in a mailbox</p></div>
<p><span style="line-height:1.5em;">As silly and evident as this is, one thing I&#8217;m constantly astounded by is how the proportion of people who will click never quite drops to zero. Our work on social engineering assessments bears out this real world example: with a large enough sample set, you&#8217;ll always hook at least one. In fact, a <a href="http://research.microsoft.com/pubs/167719/WhyFromNigeria.pdf">paper out of Microsoft Research</a> suggests that, for scammers, this sort of painfully blatant opening is actually an intentional tool: <a href="http://blogs.msdn.com/b/tzink/archive/2012/06/24/bad-spelling-in-419s-is-a-screening-tool.aspx">it acts as a filter that only the most gullible will pass</a>.<br />
</span></p>
<p>Given the weak effort put into the email, I was curious to see if the scam got any better if someone actually clicked through. To be honest, I was pleasantly surprised.</p>
<div id="attachment_1976" style="width: 595px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/12/phish-site-for-blog1.png"><img class="size-large wp-image-1976" alt="Phish Site" src="http://neolab.files.wordpress.com/2014/12/phish-site-for-blog1.png?w=585&#038;h=410"   /></a><p class="wp-caption-text">The phishing site: a combination of legitimate Apple code and images and a form added by the attacker</p></div>
<p>The site is dressed up as a reasonable approximation of an official Apple site. In fact, a look at the source shows that there are two things going on here: some HTML/CSS set dressing and template code that is copied directly from the legitimate Apple site, and the phishing form itself which is a reusable template form created by one of the phishers.</p>
<p>Naturally, I was curious where data went once the form was submitted. I filled in some bogus data and submitted it (the phishing form helpfully pointed out any missing data; there is certainly an audacity in being asked to check the format of the credit card number that&#8217;s about to be stolen). The data POST went back to another page on the same server, then quickly forwarded me on to the legitimate iTunes site.</p>
<p><a href="http://neolab.files.wordpress.com/2014/01/submit-and-forward-burp-for-blog.png"><img class="aligncenter size-large wp-image-1971" alt="Submit and Forward Burp -For Blog" src="http://neolab.files.wordpress.com/2014/01/submit-and-forward-burp-for-blog.png?w=585&#038;h=74" width="585" height="74" /></a></p>
<p><span style="line-height:1.5em;">This is another standard technique: if a &#8220;login&#8221; appears to work because the victim was already logged in, the victim will often simply proceed with what they were doing without questioning why the login was prompted in the first place. During social engineering exercises at Neohapsis, we have seen participants repeatedly log into a cloned attack site, with mounting frustration, as they wonder why the legitimate site isn&#8217;t showing them the bait they logged in for.</span></p>
<p>Back to this phishing site: my application security tester spider senses were tingling, so I felt that I had to see what our phisher was doing with the data being submitted. To find out, I replayed the submit request with various types of invalid data, strings that should cause errors depending on how the data was being parsed or stored. Not a single test string produced any errors or different behavior. This could be an indication that any parsing and processing is being done carefully and correctly, but the far more likely case is that they&#8217;re simply doing no processing and dumping it all straight out as plain text.</p>
<p>Interesting&#8230; if harvested data is just being simply dumped to disk, where exactly is it going? Burp indicates that the data is being POSTed to a harvester script at Snd/Snd.php. I wonder what else is in that directory?</p>
<div style="width: 494px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/12/directory-listing-for-blog.png"><img alt="directory listing" src="http://neolab.files.wordpress.com/2014/12/directory-listing-for-blog.png?w=484&#038;h=303" width="484" height="303" /></a><p class="wp-caption-text">Under the hood of the phishing site, the loot stash is clearly visible</p></div>
<p>That results.txt file looks mighty promising&#8230; and it is.</p>
<div style="width: 595px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/12/result-txt-for-blog.png"><img alt="result.txt" src="http://neolab.files.wordpress.com/2014/12/result-txt-for-blog.png?w=585&#038;h=281" width="585" height="281" /></a><p class="wp-caption-text">The format of the result.txt file</p></div>
<p>These are the raw results dumped from victims by the harvester script (Snd.php). The top entry is dummy data that I submitted, and when I checked it, the file was entirely filled with the various dummy submissions I had done before. It&#8217;s pretty clear from the results that I was the first person to actually click through and submit data to the phish site; actually pretty fortunate, because if a victim did enter legitimate information, the attacker would have to sort it out from a few hundred bogus submissions. Any day that we can make life harder for the the bad guys is a good day.</p>
<p>So, the data collection is dead simple, but I&#8217;d still like to know a bit more about the scam and the phishers if possible. There&#8217;s not a lot to go on, but the tag at the top of each entry seems unique. It&#8217;s the sort of thing we&#8217;re used to seeing when hackers deface a website and leave a tag to publicize the work:</p>
<pre>------------+| $ o H a B  Dz and a m i r TN |+------------</pre>
<p>Googling some variations turned up Google cache of a forum post that&#8217;s definitely related to the phishing site above; it&#8217;s either the same guy, or someone else using the same tool.</p>
<div id="attachment_1973" style="width: 595px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/01/applefullz-forum-post-for-blog.png"><img class="size-large wp-image-1973" alt="AppleFullz Forum post" src="http://neolab.files.wordpress.com/2014/01/applefullz-forum-post-for-blog.png?w=585&#038;h=302"   /></a><p class="wp-caption-text">A post in a carder forum, offering to sell data in the same format as generated by the phishing site above</p></div>
<p>A criminal using the name AppleFullz is selling complete information dumps of login details and credit card numbers plus CVV numbers (called &#8220;fulls&#8221; in carder forums) captured in the exact format that the Apple phish used, and even provides a sample of his wares (Insult to injury for the victim: not only was his information stolen, but it&#8217;s being given away as the credit card fraud equivalent of the taster trays at the grocery store). This carder is asking for $10 for one person&#8217;s information, but is willing to give bulk discounts: $30 for 5 accounts (This is actually a discount over the sorts of prices normally seen on carder forums; Krebs recently reported that <a href="http://krebsonsecurity.com/2013/12/cards-stolen-in-target-breach-flood-underground-markets/">Target cards were selling for $20-$100 per card</a>. I read this as an implicit acknowledgement by our seller that this data is much &#8220;dirtier&#8221; and that the seller is expecting buyers to mine it for legitimate data). The tools being used here are a combination of some pre-existing scraps of  PHP code widely used in other spam and scam campaigns (the section labeled &#8220;|INFO|VBV|&#8221;), and a separate section added specifically to target Apple ID&#8217;s.</p>
<p><span style="line-height:1.5em;">Of particular interest is that the carder provided a Bitcoin address. For criminals, Bitcoin has the advantage of anonymity but the disadvantage that transactions are public. This means that we can actually look up how much money has flowed into that <a href="https://blockchain.info/address/1K92k2aYckkxxjpdNvxEoWBezZxc1ukefk">particular Bitcoin address</a>.</span></p>
<div style="width: 595px" class="wp-caption aligncenter"><a href="http://neolab.files.wordpress.com/2014/12/blockchain.png"><img class=" " alt="blockchain" src="http://neolab.files.wordpress.com/2014/12/blockchain.png?w=585&#038;h=330" width="585" height="330" /></a><p class="wp-caption-text">Ill-gotten gains: the Bitcoin blockchain records transfers into the account used for selling stolen Apple Id&#8217;s and credit card numbers.</p></div>
<p>From November 17, when the forum posting went up, until December 4th, when I investigated this phishing attempt, he has received Bitcoin transfers totaling 0.81815987 BTC, which is around $744.53 (based on the BTC value on 12/4). According to his price sheet, that translates to a sale of between 74 and 124 records: not bad for a month of terribly unsophisticated phishing.</p>
<p>Within a few hours of investigating the initial phishing site, it had been removed. The actual server where the phish site was hosted was a legitimate domain that had been compromised; perhaps the phisher noticed the volume of bogus traffic and decided that the jig was up for that particular phish, or the system administrator got tipped off by the unusual traffic and investigated. Either way the phish site is offline, so that&#8217;s another small victory.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1936"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1936"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1936"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/application-security-2/" rel="category tag">Application Security</a>, <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/privacy-2/" rel="category tag">Privacy</a>, <a href="http://labs.neohapsis.com/category/information-security/security-industry/" rel="category tag">Security Industry</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/credit-card/" rel="tag">Credit Card</a>, <a href="http://labs.neohapsis.com/tag/fraud/" rel="tag">Fraud</a>, <a href="http://labs.neohapsis.com/tag/phishing/" rel="tag">Phishing</a>, <a href="http://labs.neohapsis.com/tag/privacy/" rel="tag">privacy</a>, <a href="http://labs.neohapsis.com/tag/social-engineering/" rel="tag">Social Engineering</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2014/01/07/gutting-a-phish/#respond" title="Comment on Gutting a Phish">0 comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1684" class="post-1684 post type-post status-publish format-standard hentry category-application-security-2 category-neohapsis">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/" rel="bookmark">08.19.13</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/sbehrens1/" title="View all posts by Scott Behrens" rel="author">Scott Behrens</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/" rel="bookmark">Defeating Cross-site Scripting with Content Security&nbsp;Policy</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>If you have been following Neohapsis&#8217; <a href="https://twitter.com/helloarbit">@helloarbit</a> or <a href="https://twitter.com/coffeetocode">@coffeetocode </a>on Twitter, you have probably seen us tweeting quite a bit about <a href="https://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-specification.dev.html" target="_blank">Content Security Policy</a>.  <em>Content Security Policy</em> is an HTTP header that allows you, the developer or security engineer, to define where web applications can or can not load content from.   By defining a strict Content Security policy, the deveopers of web applications can <del>completely</del> <strong>almost </strong><b>completely</b> mitigate cross-site scripting and other attacks.</p>
<p>CSP functions by allowing a web application to declare the source of where it expects to load scripts, allowing the client to detect and block malicious scripts injected into the application by an attacker.</p>
<p>Another way to think about content-security policy is as a <em>source whitelist</em>. Typically when an end user makes a request for a web page, the browser trusts output that the server is delivering. CSP however limits this trust model by sending <code>Content-Security-Policy</code> header that allows the application to specify a whitelist of trusted (expected) sources. When the browser receives this header, it will only render or execute resources from those sources.</p>
<p>In the event that an attacker does have the ability to inject malicious content that is reflected back against the user, the script will not match the source whitelist, and the script will not be executed.</p>
<p>Traditional mechanisms to mitigate cross-site scripting are to HTML encode or escape output that is reflected back to a user as well as perform rigorous input validation. However due to the complexity of encoding and validation, cross-site scripting may crop up in your website.  Think of CSP as your insurance policy in the event something malicious sneaks through your input validation and output encoding strategies.</p>
<p>Although we at Neohapsis Labs have been researching Content Security Policy for a while, we found that it&#8217;s a complicated technology that has plenty of intricacies.  After realizing that many users may run into the same issues and confusion we did, we decided to launch <a href="http://cspplayground.com" target="_blank">cspplayground.com</a> to help educate developers and security engineers on how to use CSP as well as a way to validate your own complex policies.</p>
<p>CSP Playground allows you to see example code and practices that are likely to break when applying CSP policies.  You can toggle custom policies and watch in real-time how they affect the playground web application.  We also provide some sample approaches on how to modify your code so that it will play nicely with CSP.  After you have had time to tinker around, you can use the CSP Validator to build out your own CSP policy and ensure that it is in compliance with the CSP 1.1 specification.</p>
<p>The best way to learn CSP is by experimenting with it.  We  at Neohapsis Labs have put together <a href="http://cspplayground.com" target="_blank">cspplayground.com</a> site just for those reasons and suggest you check out the site to learn more about it.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1684"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1684"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1684"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/application-security-2/" rel="category tag">Application Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>			</span>
			
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2013/08/19/defeating-cross-site-scripting-with-content-security-policy/#respond" title="Comment on Defeating Cross-site Scripting with Content Security&nbsp;Policy">0 comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1669" class="post-1669 post type-post status-publish format-standard hentry category-neohapsis category-security-testing category-security-tools category-windows tag-bash tag-domain-name-system tag-github tag-internet-protocol tag-ipv6 tag-kali-linux tag-python tag-router-computing tag-scapy tag-ubuntu tag-windows">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/" rel="bookmark">07.30.13</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/neobrent/" title="View all posts by neobrent" rel="author">neobrent</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/" rel="bookmark">Picking Up The SLAAC With Sudden&nbsp;Six</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>By Brent Bandelgar and Scott Behrens</p>
<p>The people that run The Internet have been clamoring for years for <a title="ARIN IPv6 Info Center" href="https://www.arin.net/knowledge/ipv6_info_center.html" target="_blank">increased adoption of IPv6</a>, the next generation Internet Protocol. Modern operating systems, such as Windows 8 and Mac OS X, come out of the box ready and willing to use IPv6, but most networks still have only IPv4. This is a problem because the administrators of those networks may not be expecting any IPv6 activity and only have IPv4 monitoring and defenses in place.</p>
<p>In 2011, Alec Waters wrote a guide on how to take advantage of the fact that Windows Vista and Windows 7 were &#8216;out of the box&#8217; configured to support IPv6. Dubbed the “<a title="The SLAAC Attack" href="http://wirewatcher.wordpress.com/2011/04/04/the-slaac-attack-using-ipv6-as-a-weapon-against-ipv4/" target="_blank">SLAAC Attack</a>”, his guide described how to set up a host that advertised itself as an IPv6 router, so that Windows clients would prefer to send their requests to this IPv6 host router first, which would then resend the requests along to the legitimate IPv4 router on their behalf.</p>
<p>This past winter, we at Neohapsis Labs tried to recreate the SLAAC Attack to test it against Windows 8 and make it easy to deploy during our own penetration tests.</p>
<p>We came up with a set of standard packages and accompanying configuration files that worked, then created a script to automate this process, which we call “Sudden Six.” It can quickly create an IPv6 overlay network and the intermediate translation to IPv4 with little more than a base <a title="Ubuntu Server" href="http://www.ubuntu.com/server" target="_blank">Ubuntu Linux</a> or <a title="Kali Linux" href="http://www.kali.org/" target="_blank">Kali Linux</a> installation, an available IPv4 address on the target network, and about a minute or so to download and install the packages.</p>
<div id="attachment_1672" style="width: 310px" class="wp-caption alignnone"><a href="http://neolab.files.wordpress.com/2013/07/02-win8-mitmd-1-mp4_snapshot_00-17.jpg"><img class="size-medium wp-image-1672" alt="Windows 8 on Sudden Six" src="http://neolab.files.wordpress.com/2013/07/02-win8-mitmd-1-mp4_snapshot_00-17.jpg?w=300&#038;h=224" width="300" height="224" /></a><p class="wp-caption-text">Windows 8 on Sudden Six</p></div>
<p>As with the SLAAC Attack described by Waters, this works against networks that only have IPv4 connectivity and do not have IPv6 infrastructure and defenses deployed. The attack establishes a transparent IPv6 network on top of the IPv4 infrastructure. Attackers may take advantage of Operating Systems that prefer IPv6 traffic to force those hosts to route their traffic over our IPv6 infrastructure so they can intercept and modify that communication.</p>
<p>To boil it down, attackers can conceivably (and fairly easily) weaponize an attack on our systems simply by leveraging this vulnerability. They could pretend to be an IPv6 router on your network and see all your web traffic, including data being sent to and from your machine. Even more lethal, the attacker could modify web pages to launch client-side attacks, meaning they could create fake websites that look like the ones you are trying to access, but send all data you enter back to the attacker (such as your username and password or credit card number).</p>
<p>As an example, we can imagine this type of attack being used to snoop on web traffic from employees browsing web sites. Even more lethal, the attackers could modify web pages to launch client-side attacks.</p>
<p>The most extreme way to mitigate the attack is to disable IPv6 on client machines. In Windows, this can be accomplished manually in each Network Adapter Properties panel or with GPO. Unfortunately, this would hinder IPv6 adoption. Instead, we would like to see more IPv6 networks being deployed, along with the defenses described in <a title="RFC 6105" href="https://tools.ietf.org/html/rfc6105" target="_blank">RFC 6105</a> and the <a title="Implementing First Hop Security in IPv6" href="http://www.cisco.com/en/US/docs/ios/ipv6/configuration/guide/ip6-first_hop_security.html" target="_blank">Cisco First Hop Security Implementation Guide</a>. This includes using features such as RA Guard, which allows administrators to configure a trusted switch port that will accept IPv6 Router Advertisement packets, indicating the legitimate IPv6 router.</p>
<p>At DEF CON 21, Brent Bandelgar and Scott Behrens will be presenting this attack as well as recommendations on how to protect your environment. You can find a more detailed abstract of our talk <a title="here" href="https://www.defcon.org/html/defcon-21/dc-21-speakers.html#Behrens" target="_blank">here</a>. The talk will be held during Track 2 on Friday at 2 pm. In addition, on Friday we will be releasing the tool on the <a href="https://github.com/Neohapsis" target="_blank">Neohapsis Github</a> page.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1669"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1669"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1669"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/security-testing/" rel="category tag">Security Testing</a>, <a href="http://labs.neohapsis.com/category/information-security/security-tools/" rel="category tag">Security Tools</a>, <a href="http://labs.neohapsis.com/category/windows/" rel="category tag">Windows</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/bash/" rel="tag">bash</a>, <a href="http://labs.neohapsis.com/tag/domain-name-system/" rel="tag">Domain Name System</a>, <a href="http://labs.neohapsis.com/tag/github/" rel="tag">GitHub</a>, <a href="http://labs.neohapsis.com/tag/internet-protocol/" rel="tag">Internet Protocol</a>, <a href="http://labs.neohapsis.com/tag/ipv6/" rel="tag">IPv6</a>, <a href="http://labs.neohapsis.com/tag/kali-linux/" rel="tag">kali linux</a>, <a href="http://labs.neohapsis.com/tag/python/" rel="tag">python</a>, <a href="http://labs.neohapsis.com/tag/router-computing/" rel="tag">Router (computing)</a>, <a href="http://labs.neohapsis.com/tag/scapy/" rel="tag">Scapy</a>, <a href="http://labs.neohapsis.com/tag/ubuntu/" rel="tag">Ubuntu</a>, <a href="http://labs.neohapsis.com/tag/windows/" rel="tag">Windows</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2013/07/30/picking-up-the-slaac-with-sudden-six/#comments" title="Comment on Picking Up The SLAAC With Sudden&nbsp;Six">3 Comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1657" class="post-1657 post type-post status-publish format-standard hentry category-neohapsis category-security-tools category-web-applications tag-google-chrome tag-javascript tag-phantomjs tag-safari tag-uniform-resource-locator tag-webkit tag-website">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/" rel="bookmark">07.10.13</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/neobrent/" title="View all posts by neobrent" rel="author">neobrent</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/" rel="bookmark">Collecting Cookies with&nbsp;PhantomJS</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><strong>TL;DR</strong>: Automate <a href="http://www.webkit.org">WebKit</a> with <a href="http://phantomjs.org">PhantomJS</a> to get specific Web site data.</p>
<p>This is the first post in a series about gathering Web site reconnaissance with PhantomJS.</p>
<p>My first major engagement with Neohapsis involved compiling a Web site survey for a global legal services firm. The client was preparing for a compliance assessment against Article 29 of the EU Data Protection Directive, which details disclosure requirements for user privacy and usage of cookies. The scope of the engagement involved working with their provided list of IP addresses and domain names to validate their active and inactive Web sites and redirects, count how many first party and third party cookies each site placed, identify any login forms, and determine the presence of links to site privacy policy and cookie policy.</p>
<p>The list was extensive and the team had a hard deadline. We had a number of tools at our disposal to scrape Web sites, but as we had a specific set of attributes to look for, we determined that our best bet was to use a modern browser engine to capture fully rendered pages and try to automate the analysis. My colleague, Ben Toews, contributed a script towards this effort that used PhantomJS to visit a text file full of URLs and capture the cookies into another file. PhantomJS is a distribution of WebKit that is intended to run in a “headless” fashion, meaning that it renders Web pages and scripts like Apple Safari or Google Chrome, but without an interactive user interface. Instead, it runs on the command line and exposes an API for JavaScript for command execution.  I was able to build on this script to build out a list of active and inactive URLs by checking the status callback from <a href="https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage#wiki-webpage-open">page.open</a> and capture the cookies from every active URL as stored in <a href="https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage#wiki-webpage-cookies">page.cookies</a> property.</p>
<p>Remember how I said that PhantomJS would render a Web page like Safari or Chrome? This was very important to the project as I needed to capture the Web site attributes in the same way a typical user would encounter the site. We needed to account for redirects from either the Web server or from JavaScript, and any first or third party cookies along the way. As it turns out, PhantomJS provides a way to capture URL changes with the <a href="https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage#wiki-webpage-onUrlChanged">page.OnUrlChanged</a> callback function, which I used to log the redirects and final destination URL. The page.cookies attribute includes all first and third party cookies without any additional work as PhantomJS makes all of the needed requests and script executions already. Check out my version of the script in <a title="chs2.coffee" href="https://gist.github.com/neo-brent/5963782" target="_blank">chs2-basic.coffee</a>.</p>
<p>This is the command invocation. It takes two arguments: a text file with one URL per line and a file name prefix for the output files.</p>
<pre class="brush: plain; title: ; notranslate" title="">

phantomjs chs2-basic.coffee [in.txt] [prefix]

</pre>
<p>This snippet writes out the cookies into a JSON string and appends it to an output file.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
if status is 'success'
# output JSON of cookies from page, one JSON string per line
# format: url:(requested URL from input) pageURL:(resolved Location from the PhantomJS &quot;Address Bar&quot;) cookie: object containing cookies set on the page
fs.write system.args[2] + &quot;.jsoncookies&quot;, JSON.stringify({url:url,pageURL:page.url,cookie:page.cookies})+&quot;\n&quot;, 'a'
</pre>
<p>In a followup post, I’ll discuss how to capture page headers and detect some common platform stacks.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1657"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1657"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1657"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/information-security/security-tools/" rel="category tag">Security Tools</a>, <a href="http://labs.neohapsis.com/category/web-applications/" rel="category tag">Web Applications</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/google-chrome/" rel="tag">Google Chrome</a>, <a href="http://labs.neohapsis.com/tag/javascript/" rel="tag">JavaScript</a>, <a href="http://labs.neohapsis.com/tag/phantomjs/" rel="tag">PhantomJS</a>, <a href="http://labs.neohapsis.com/tag/safari/" rel="tag">Safari</a>, <a href="http://labs.neohapsis.com/tag/uniform-resource-locator/" rel="tag">Uniform resource locator</a>, <a href="http://labs.neohapsis.com/tag/webkit/" rel="tag">WebKit</a>, <a href="http://labs.neohapsis.com/tag/website/" rel="tag">Website</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2013/07/10/collecting-cookies-with-phantomjs/#respond" title="Comment on Collecting Cookies with&nbsp;PhantomJS">0 comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1119" class="post-1119 post type-post status-publish format-standard hentry category-exploitation-information-security category-facebook category-information-security category-neohapsis tag-facebook tag-risk tag-security tag-vulnerability">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/" rel="bookmark">01.03.12</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/sbehrens1/" title="View all posts by Scott Behrens" rel="author">Scott Behrens</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/" rel="bookmark">Facebook Applications Have Nagging&nbsp;Vulnerabilities</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>By <a title="Neohapsis homepage" href="http://neohapsis.com" target="_blank">Neohapsis</a> Researchers Andy Hoernecke and Scott Behrens</p>
<p>This is the second post in our Social Networking series. (Read the first one <a title="Blog Post" href="http://wp.me/pb79C-hi" target="_blank">here</a>.)</p>
<p>As Facebook’s application platform has become more popular, the composition of applications has evolved. While early applications seemed to focus on either social gaming or extending the capabilities of Facebook, now Facebook is being utilized as a platform by major companies to foster interaction with their customers in a variety forms such as sweepstakes, promotions, shopping, and more.<a href="http://neolab.files.wordpress.com/2012/01/facebook-logo1.jpg"><img class="alignright  wp-image-1130" title="Facebook logo" src="http://neolab.files.wordpress.com/2012/01/facebook-logo1.jpg?w=120&#038;h=120" alt="" width="120" height="120" /></a></p>
<p>And why not?  We’ve all heard the numbers: Facebook has 800 million active users, 50% of whom log on everyday. On average, more than 20 million Facebook applications are installed by users every day, while more than 7 million applications and websites remain integrated with Facebook. (<a href="http://www.facebook.com/press/info.php?statistics">1</a>)  Additionally, Facebook is seen as a treasure trove of valuable data accessible to anyone who can get enough “Likes” on their page or application.</p>
<p>As corporate investments in social applications have grown, Neohapsis Labs researchers have been requested to help clients assess these applications and help determine what type of risk exposure their release may pose. We took a sample of the applications we have assessed and pulled together some interesting trends. For context, most of these applications are very small in size (2-4 dynamic pages.)  The functionality contained in these applications ranged from simple sweepstakes entry forms and contests with content submission (photos, essays, videos, etc.) to gaming and shopping applications.</p>
<p>From our sample, we found that on average the applications assessed had vulnerabilities in 2.5 vulnerability classes (e.g. Cross Site Scripting or SQL Injection,) and none of the applications were completely free of vulnerabilities. Given the attack surface of these applications is so small, this is a somewhat surprising statistic.</p>
<p>The most commonly identified findings in our sample group of applications included Cross-Site Scripting, Insufficient Transport Layer Protection, and Insecure File Upload vulnerabilities. Each of these vulnerabilities classes will be discussed below, along with how the social networking aspect of the applications affects their potential impact.</p>
<p>Facebook applications suffer the most from <a href="http://cwe.mitre.org/data/definitions/79.html">Cross-Site Scripting</a>. This type of vulnerability was identified on 46% of the applications sampled.  This is not surprising, since this age old problem still creeps up into many corporate and personal applications today.  An application discovered to be vulnerable to XSS could be used to attempt browser based exploits or to steal session cookies (but only in the context of the application’s domain.)</p>
<p>These types of applications are generally framed inline [inling framing, or iframing, is a common HTML technique for framing media content] on a Facebook page from the developer’s own servers/domain. This alleviates some of the risk to the user’s Facebook account since the JavaScript can’t access Facebook’s session cookies.  And even if it could, Facebook does use HttpOnly flags to prevent JavaScript from accessing session cookies values.  But, we have found that companies have a tendency to utilize the same domain name repeatedly for these applications since generally the real URL is never really visible to the end user. This means that if one application has a XSS vulnerability, it could present a risk to any other applications hosted at the same domain.</p>
<p>When third-party developers enter the picture all this becomes even more of a concern, since two clients’ applications may be sharing the same domain and thus be in some ways reliant on the security of the other client&#8217;s application.</p>
<p>The second most commonly identified vulnerability, affecting 37% of the sample, was <a href="http://cwe.mitre.org/data/definitions/818.html">Insufficient Transport Layer Protection</a> While it is a common myth that conducting a man-in-the-middle attack against cleartext protocols is impossibly difficult, the truth is it’s relatively simple.  Tools such as <a href="/Users/sbehrens/AppData/Local/Microsoft/Windows/Temporary%20Internet%20Files/Content.Outlook/RYGU04UG/Firesheep">Firesheep</a> aid in this process, allowing an attacker to create custom JavaScript handlers to capture and replay the right session cookies.  About an hour after downloading Firesheep and looking at examples, we wrote a custom handler for an application that was being assessed that only used SSL when submitting login information.   On an unprotected WIFI network, as soon as the application sent any information over HTTP we had valid session cookies, which were easily replayed to compromise that victim’s session.</p>
<p>Once again, the impact of this finding really depends on the functionality of the application, but the wide variety of applications on Facebook does provide a interesting and varied landscape for the attacker to choose from.  We only flagged this vulnerability under specific circumstance where either the application cookies were somehow important (for example being used to identify a logged in session) or the application included functionality where sensitive data (such as PII or credit card data) was transmitted.</p>
<p>The third most commonly identified finding was <a href="http://cwe.mitre.org/data/definitions/434.html">Insecure File Upload</a>. To us, this was surprising, since it’s generally not considered to be one of the most commonly identified vulnerabilities across all web applications. Nevertheless 27% of our sample included this type of vulnerability. We attribute its identification rate to the prevalence of social applications that include some type of file upload functionality (to share an avatar, photo, document, movie, etc.)</p>
<p>We found that many of the applications we assessed have their file upload functionality implemented in an insecure way.  Most of the applications did not check content type headers or even file extensions.  Although none of the vulnerabilities discovered led to command injection flaws, almost every vulnerability exploited allowed the attacker to upload JavaScript, HTML or other potentially malicious files such as PDF and executables.  Depending on the domain name affected by this vulnerability, this flaw would aid in the attacker’s social engineering effort as the attacker now has malicious files on a trusted domain.</p>
<p>Our assessment also identified a wide range of other types of vulnerabilities. For example, we found several of these applications to be utilizing publicly available admin interfaces with guessable credentials. Furthermore, at least one of the admin interfaces was riddled with stored XSS vulnerabilities. Sever configurations were also a frequent problem with unnecessary exposed services and insecure configuration being repeatedly identified.</p>
<p>Finally, we also found that many of these web applications had some interesting issues that are generally unlikely to affect a standard web application. For example, social applications with a contest component may need to worry about the integrity of the contest. If it is possible for a malicious user to game the contest (for example by cheating at a social game and placing a fake high score) this could reflect badly on the application, the contest, and the sponsoring brand.</p>
<p>Even though development of applications integrated with Facebook and other social network sites in increasing, we’ve found companies still tend to handle these outside of their normal security processes. It is important to realize that these applications can present a risk and should be thoroughly examined just like traditional stand alone web applications.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1119"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1119"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1119"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/exploitation-information-security/" rel="category tag">Exploitation</a>, <a href="http://labs.neohapsis.com/category/uncategorized/facebook/" rel="category tag">Facebook</a>, <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/facebook/" rel="tag">Facebook</a>, <a href="http://labs.neohapsis.com/tag/risk/" rel="tag">risk</a>, <a href="http://labs.neohapsis.com/tag/security/" rel="tag">security</a>, <a href="http://labs.neohapsis.com/tag/vulnerability/" rel="tag">Vulnerability</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2012/01/03/facebook-applications-have-nagging-vulnerabilities/#comments" title="Comment on Facebook Applications Have Nagging&nbsp;Vulnerabilities">2 Comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1103" class="post-1103 post type-post status-publish format-standard hentry category-information-security category-neohapsis tag-android tag-linux tag-mobile tag-open-source tag-risk tag-security">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/" rel="bookmark">12.21.11</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/jonjanego/" title="View all posts by Jon Janego" rel="author">Jon Janego</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/" rel="bookmark">The Security Implications of Custom Android&nbsp;ROMs</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>By Jon Janego</p>
<p>As most smartphone geeks like myself are undoubtedly aware, the latest phone in Google’s Nexus line, the <a href="http://www.google.com/nexus/">Samsung Galaxy Nexus</a>, was released for <a href="http://www.verizonwireless.com/">Verizon Wireless</a> last week.  Mine just arrived last night, and it&#8217;s fantastic (although huge!)</p>
<p>The Nexus line of devices are unique among Android phones in that they are essentially a commercial line of the internal development phones used at Google.  As such, they are designed to allow easy installation of custom firmware.  This makes them especially popular with the robust Android “modding” community, which develops customized firmware that can be run on Android devices that extend the functionality beyond what is initially provided by the handset manufacturer.</p>
<p><strong>Made for Modders</strong></p>
<p>The Galaxy Nexus appears to be the biggest Nexus phone launch in Google’s history, initially being offered by the largest carrier in the US, Verizon, and the second-largest carrier in the UK, O2.The popularity of the Galaxy Nexus will likely draw a large number of people into the Android modding community because of the low barrier to entry that it presents.  Already, on the popular Android blog Droid Life, there is <a href="http://www.droid-life.com/2011/12/05/how-to-unlock-the-galaxy-nexus-bootloader/">an article</a> about unlocking the Galaxy Nexus’ bootloader, which allows for installation of custom firmware, that has over 400 comments, and <a href="http://www.droid-life.com/2011/12/15/how-to-root-the-galaxy-nexus-4g-lte-and-flash-custom-recovery-verizon/">another post </a>on the same blog about “rooting” the phone has well over 300 comments.The Android customization community is a large and robust one.  However, like many open-source and community-based development projects, the majority of users just want the project to “work”, and have little-to-no interest in viewing the source code or having a deep understanding of how it functions.  Despite user bases sometimes numbering in the millions, a relatively small group of developers do most of the creation and distribution of the software.</p>
<p>The problem of software authenticity has been encountered before by the linux community, and over the last decade, that community has developed distribution methods such as centralized Debian APT repositories that provide some degree of certainty over what the end user is actually installing on their computer.  Additionally, many linux users still download the source code for projects and compile them locally on their computer.  Within the Android modding community, neither of these options have been implemented with the same level of maturity that linux has seen.  The more popular aftermarket firmware, or “ROMs”, such as <a href="http://download.cyanogenmod.com/?type=stable&amp;device=passion">CyanogenMod</a>, are distributed by more accountable means, providing MD5 checksums for the files and a clear distribution network.  However, often, Android customization software is provided through links to anonymous file-sharing sites such as Mediafire and Megaupload.  This creates the opportunity to trick a user into installing malicious files.</p>
<p><strong>A Ripe Target</strong></p>
<p>There has already been <a href="http://blog.mylookout.com/blog/2011/06/15/security-alert-malware-found-targeting-custom-roms-jsmshider/">at least one documented case </a>of malware targeting custom Android ROMs, a trojan affected devices in the Chinese market.  With the popularity of the Galaxy Nexus, and the continued interest in Android customization community, this could become an attack vector that is more and more appealing to malware authors.  And the fact that majority of customized Android software is distributed without the usage of the Android Market, users do not have the additional means of protection that the Market provides, namely the “<a href="http://www.wired.com/gadgetlab/2010/06/google-flips-remote-kill-switch-on-android-apps/">kill-switch</a>” for apps that Google has flagged as malicious that were installed via the Android Market.</p>
<p>So how can end users protect themselves, while still participating in the Android customization community?  The most important thing that any technology user can do is to educate themselves about the software they install.  Security researcher Dan Rosenberg wrote an <a href="http://vulnfactory.org/blog/2011/11/11/plagiarism-in-the-android-rooting-scene/">excellent blog post </a>summarizing exactly how “rooting” works, which is a concept that many users want, but fewer truly understand.  Too often, users are tempted to just install the attachment that someone on a forum or blog says “works”, without question.  Also, users should avoid downloading and installing software from sources that are anonymous or unaccountable.  Instead, download from the primary source of the software developer, and validate the MD5 checksum of the file before installing it.  And often, many of the files shared on forums or anonymous upload sites are those provided directly Google or the phone manufacturers themselves.  Instead of downloading from the anonymous links, <a href="http://developer.android.com/sdk/index.html">download these files from Google directly</a>.</p>
<p>The Android community is already beginning to tackle these problems.  The popular ROM manager <a href="http://www.clockworkmod.com/">ClockworkMod</a> is attempting to become an authoritative source for aftermarket software.  They coordinate with the developers of custom software and allow users to install files directly from the developers’ Git repositories.  However, this is still reliant upon the goodwill and trustworthiness of the developers.  ClockworkMod does not perform any code review of the ROMs that they aggregate, and while they may be able to de-list one that has a security vulnerability, there is still not a way to automatically remove the software from installed devices.</p>
<p><strong>Looking Forward</strong></p>
<p>In the future, I hope that the popular Android blogs such as <a href="http://www.droid-life.com/">Droid-Life</a>, and forums such as <a href="http://forum.xda-developers.com/">XDA-developers</a> will begin linking to central, trusted software repositories, rather than the anonymous file sharing sites or forum post attachments that are currently commonly used.  In the long-term, I would not be surprised to see an even more formalized system be implemented by the Android community, similar to the Debian APT repositories, but there is still some time to go.  Until then, Android users interested in customizing their devices should try and stay educated about their technology, and be very skeptical of any software that they install.  While the mobile carriers have recently had some credibility issues with the <a href="http://vulnfactory.org/blog/2011/12/05/carrieriq-the-real-story/">CarrierIQ</a> fiasco, they are for the most part held far more accountable than any custom ROM developer will ever be.  Given the sensitivity of the data stored on mobile devices, a user should think very closely about what they are willing to install onto it.  As for me, I have already unlocked the bootloader to my Nexus Galaxy, but will probably refrain from installing any custom third-party ROMs until I repurpose it as a research device, at least another year or two down the road.  But the draw of the enhanced features and controls that the custom ROMs provide will likely lead many users down that path.  The integrity of your data ultimately resides with you, so I hope that everyone carefully weighs their decision to install new firmware onto their most sensitive and personal piece of technology.  Be careful out there!</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1103"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1103"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1103"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/android/" rel="tag">android</a>, <a href="http://labs.neohapsis.com/tag/linux/" rel="tag">linux</a>, <a href="http://labs.neohapsis.com/tag/mobile/" rel="tag">mobile</a>, <a href="http://labs.neohapsis.com/tag/open-source/" rel="tag">open source</a>, <a href="http://labs.neohapsis.com/tag/risk/" rel="tag">risk</a>, <a href="http://labs.neohapsis.com/tag/security/" rel="tag">security</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2011/12/21/the-security-implications-of-custom-android-roms/#comments" title="Comment on The Security Implications of Custom Android&nbsp;ROMs">6 Comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1080" class="post-1080 post type-post status-publish format-standard hentry category-information-security category-neohapsis category-security-tools tag-backdoors tag-neopi tag-obfuscation tag-shells tag-web-malware">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/" rel="bookmark">12.20.11</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/sbehrens1/" title="View all posts by Scott Behrens" rel="author">Scott Behrens</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/" rel="bookmark">NeoPI in the&nbsp;Wild</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>By Scott Behrens</p>
<p><a title="NeoPI" href="http://github.com/Neohapsis/NeoPI">NeoPI </a>was a project developed by myself and Ben Hagen to aid in the detection of obfuscated and encrypted webshells.  I recently came across an article about <a href="https://github.com/anestisb/WeBaCoo">Webacoo</a> shell and a <a href="http://bechtsoudis.com/hacking/maths-behind-web-shell-code-detection/">rewrite</a> of this php backdoor to avoid detection from NeoPI.</p>
<p>Webacoo’s developer used a few interesting techniques to avoid detection.  The first technique was to avoid signature based detection by using the function ‘strrev’:</p>
<p><code>$b=strrev("edoced_4"."6esab")</code></p>
<p>This bypasses our traditional based signature detection and also lends to a few other techniques to bypass signature based detection.  Another webshell surfaced after NeoPI’s release that uses similar techniques to avoid signature based detection.  Another example could be the following (as seen in <a href="https://elrincondeseth.wordpress.com/2011/08/17/bypasseando-neopi/">https://elrincondeseth.Wordpress.com/2011/08/17/bypasseando-neopi/</a>):</p>
<p><code>$b</code> <code>=</code> <code>'bas'.'e64'.'_de'.'code';</code></p>
<p>We can see that just by breaking up the word, the risk of detection is highly mitigated.  As I suggested at B-Sides, signature based detection is complimentary to the tests in NeoPI but by itself, ineffective.   These methods described above completely thwart this tests effectiveness.</p>
<p>But one thing these techniques must do at some point is actually eval the code.  Webacoo for example uses the following:</p>
<p><code>eval($b(str_replace(" ","","a W Y o a X …SNIP</code></p>
<p>By developing a regex that looks for eval and a variable holding the global function, we can flag this file as malicious.  After running this test against a WordPress server with Webacoo’s shell, I observed the following:</p>
<p style="text-align:center;"> <a href="http://neolab.files.wordpress.com/2011/12/eval.jpg"><img class="alignnone size-full wp-image-1083" title="eval" src="http://neolab.files.wordpress.com/2011/12/eval.jpg?w=585" alt=""   /></a><a href="http://neolab.files.wordpress.com/2011/12/eval.jpg"><br />
</a></p>
<p align="center">Figure 1 &#8211; Webacoo identified as suspicious in eval test</p>
<p>NeoPI was able to detect the function and flagged it as malicious.  This particular type of use of eval isn’t very common and I have really only seen it used in malware.  That being said functions.php was also flagged so I imagine this test can still have many false positives and should be used to help aid in manual investigation of the files identified.</p>
<p>Another tweak Webacoo’s developer did was insert spaces in-between each character of a base64 encoded string.  The function str_replace() is called to replace each space before the code is base64_decoded  and eval’d.</p>
<p>In order to thwart this particular obfuscation technique, I went ahead and modified the entropy function to strip spaces within the data the function is analyzing. The screenshot below shows a scan against 1752 php files in WordPress and shows the entropy test results as flagging webacoo as potentially malicious. This increased NeoPI’s effectiveness at detecting webacoo.php but is more of a stopgap solution as the attacker can craft other junk characters to lower the shells entropy and index of coincidence. Some additional thought and research is needed on potentially looking for these complicated search and replace functions to determine if the data being obfuscated is malicious.</p>
<p style="text-align:center;"> <a href="http://neolab.files.wordpress.com/2011/12/entrpo.jpg"><img class="alignnone size-full wp-image-1082" title="entrpo" src="http://neolab.files.wordpress.com/2011/12/entrpo.jpg?w=585" alt=""   /></a></p>
<p align="center">Figure 2 &#8211; Test results after modifying entropy code results in higher entropy of webacoo.php</p>
<p>The latest version of the code can be checked out at <a href="http://github.com/Neohapsis/NeoPI">http://github.com/Neohapsis/NeoPI</a> which includes these enhancements.</p>
<p>As for improving the other tests effectiveness, I am looking into the possibility of identifying base64 encodings without looking for the function name.  This technique may be helpful by building a ratio of upper and lower case characters and seeing if there is a trend with files that use obfuscation.</p>
<p>If anyone has interesting techniques for defeating NeoPI please respond to this post and I’ll look at adding more detection mechanisms to this tool!</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1080"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1080"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1080"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/information-security/security-tools/" rel="category tag">Security Tools</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="http://labs.neohapsis.com/tag/neopi/" rel="tag">neopi</a>, <a href="http://labs.neohapsis.com/tag/obfuscation/" rel="tag">obfuscation</a>, <a href="http://labs.neohapsis.com/tag/shells/" rel="tag">shells</a>, <a href="http://labs.neohapsis.com/tag/web-malware/" rel="tag">web malware</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2011/12/20/neopi-in-the-wild/#comments" title="Comment on NeoPI in the&nbsp;Wild">5 Comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-1005" class="post-1005 post type-post status-publish format-standard hentry category-information-security category-neohapsis category-security-industry tag-information-security">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/" rel="bookmark">06.15.11</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/jonjanego/" title="View all posts by Jon Janego" rel="author">Jon Janego</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/" rel="bookmark">We&#8217;re All Consultants</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Clients hire Neohapsis for many reasons: our expertise, our perspective as impartial outsiders, and our commitment to executing projects efficiently and expertly are just a few reasons.  But while working with clients, an important sub task that I try to accomplish is to help them change the way they interact with the rest of their business &#8211; to get security departments to think and act like consultants.  It&#8217;s easy for people working in IT, and those in Security in particular, to get caught up in their day to day activities.  There&#8217;s always a new fire to be contained or technical hurdle to overcome.  But while doing so, it&#8217;s important to understand how these activities are helping enable the business to continue to meet its overall goals.  The most effective consultants understand their role: to be the trusted advisor.  Internal security professionals can take on this same role within the company.  Their departments have the responsibility of ensuring that risks are appropriately mitigated and that the business can continue to function smoothly in the face of constant external and internal threats.  The core business can be viewed as a client of the security team, who is engaging security for assistance and reassurance that their day-to-day activities aren&#8217;t putting the business at a risk.</p>
<p>I’ve been working with one of our clients recently to help one of their business units engage more effectively with the internal security organization.  In the past, the business unit handled many IT activities themselves, acting as a de facto independent IT department.  While they are effective at running their own business, they did not have a security team focusing on their organization, so security concerns were often overlooked.  When I began working with the team, I found out that one of their main complaints with asking the security organization for assistance was lack of responsiveness.  I’ve helped set this organization up for future success by serving as a liaison between these two parts of the business, facilitating better communication on both sides.  The business unit has a central point of contact for security concerns, who can funnel them to the right people in the security organization; and the security organization has someone aware of most of the business unit’s projects and activities, which helps them cut through the confusion that can happen with disparate teams.</p>
<p>Security professionals must be both advisor and enforcer at the same time.  It&#8217;s tempting to get caught up in enforcing security for security&#8217;s sake &#8211; but it is important to remember that the ultimate goal of a security professional must be to help the core business be successful.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-1005"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-1005"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-1005"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/information-security/security-industry/" rel="category tag">Security Industry</a>			</span>
			
						<span class="sep"> | </span>
			<span class="tags-links">
				Tagged <a href="http://labs.neohapsis.com/tag/information-security/" rel="tag">Information Security</a>			</span>
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2011/06/15/were-all-consultants/#respond" title="Comment on We&#8217;re All Consultants">0 comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<article id="post-710" class="post-710 post type-post status-publish format-standard hentry category-exploitation-information-security category-information-security category-neohapsis category-security-industry">
		<div class="posted-meta">
    	<div class="date-meta">
        	<a href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/" rel="bookmark">03.31.10</a>
        </div>
        <div class="author-meta">
        	by <a class="url fn n" href="http://labs.neohapsis.com/author/dirtybit/" title="View all posts by Cris Neckar" rel="author">Cris Neckar</a>        </div>
    </div><!-- end .posted-meta -->
	<header class="entry-header">
		<h1 class="entry-title"><a href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/" rel="bookmark">ThotCon 0&#215;01</a></h1>
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p style="text-align:center;"><a href="http://neolab.files.wordpress.com/2010/03/malware_kombat1.jpg"><img class="alignnone size-full wp-image-715" title="malware_kombat" src="http://neolab.files.wordpress.com/2010/03/malware_kombat1.jpg?w=585" alt=""   /></a></p>
<p style="text-align:center;">
<p>For those who haven&#8217;t heard Greg Ose and I will be presenting at the first annual ThotCon on April 23 in Chicago. If you haven&#8217;t gotten your ticket yet you will need to hurry as they are almost gone. Our talk is called Forensic Fail: Malware Kombat and will cover some of the failings of digital forensics. We also have a surprise lined up for the end so if you are in the area you won&#8217;t want to miss it.</p>
<p>You can register for the conference at <a href="http://www.thotcon.org/registration.html">http://www.thotcon.org/registration.html</a>. We hope to see you there.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon no-text" href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/?share=twitter" target="_blank" title="Click to share on Twitter" id="sharing-twitter-710"><span></span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon no-text" href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/?share=facebook" target="_blank" title="Share on Facebook" id="sharing-facebook-710"><span></span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon no-text" href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon no-text" href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/?share=google-plus-1" target="_blank" title="Click to share on Google+" id="sharing-google-710"><span></span></a></li><li class="share-pinterest"><a rel="nofollow" class="share-pinterest sd-button share-icon no-text" href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span></span></a></li><li class="share-end"></li></ul></div></div></div></div>			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		<span class="post-format-link"><a href="" title="Permalink to " rel="bookmark">Standard</a></span> </span>		<span class="sep"> | </span>
								<span class="cat-links">
				Posted in <a href="http://labs.neohapsis.com/category/information-security/exploitation-information-security/" rel="category tag">Exploitation</a>, <a href="http://labs.neohapsis.com/category/information-security/" rel="category tag">Information Security</a>, <a href="http://labs.neohapsis.com/category/neohapsis/" rel="category tag">Neohapsis</a>, <a href="http://labs.neohapsis.com/category/information-security/security-industry/" rel="category tag">Security Industry</a>			</span>
			
					
				<span class="sep"> | </span>
		<span class="comments-link"><a href="http://labs.neohapsis.com/2010/03/31/thotcon-0x01/#respond" title="Comment on ThotCon 0&#215;01">0 comments</a></span>
		
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<nav role="navigation" id="nav-below" class="navigation-paging">
		<h1 class="assistive-text">Post navigation</h1>

	
				<div class="previous"><a href="http://labs.neohapsis.com/category/neohapsis/page/2/" ><span class="meta-nav">&larr;</span> Older posts</a></div>
		
		
	
	</nav><!-- #nav-below -->
	
		
        </div> <!-- end #main -->

        		<div id="sidebar" class="widget-area sidebar-column" role="complementary">
			
			
					<aside id="recent-posts-3" class="widget widget_recent_entries">		<h2 class="widget-title">Recent Posts</h2>		<ul>
					<li>
				<a href="http://labs.neohapsis.com/2014/07/01/cached-domain-credentials-in-vista7-aka-why-full-drive-encryption-is-important/">Cached Domain Credentials in Vista/7 (aka why full drive encryption is&nbsp;important)</a>
						</li>
					<li>
				<a href="http://labs.neohapsis.com/2014/06/02/smarttv-smartphone-dial-an-attack-surface/">Smart TV + Smartphone = Shiny New Attack&nbsp;Surfaces</a>
						</li>
					<li>
				<a href="http://labs.neohapsis.com/2014/05/01/signatures-or-pins-emv-is-coming/">Signatures or PINs? EMV is&nbsp;Coming</a>
						</li>
					<li>
				<a href="http://labs.neohapsis.com/2014/03/31/putting-windows-xp-out-to-pasture/">Putting Windows XP Out To&nbsp;Pasture</a>
						</li>
					<li>
				<a href="http://labs.neohapsis.com/2014/02/17/what-kickstarter-did-right/">What Kickstarter Did&nbsp;Right</a>
						</li>
				</ul>
		</aside><aside id="top-posts-2" class="widget widget_top-posts"><h2 class="widget-title">Top Posts</h2><ul><li><a href="http://labs.neohapsis.com/2012/04/19/xss-shortening-cheatsheet/" class="bump-view" data-bump-view="tp">XSS Shortening Cheatsheet</a></li>
<li><a href="http://labs.neohapsis.com/2013/09/16/burp-extensions-in-python-pentesting-custom-web-services/" class="bump-view" data-bump-view="tp">Burp Extensions in Python &amp; Pentesting Custom Web Services</a></li>
<li><a href="http://labs.neohapsis.com/2012/04/25/abusing-password-managers-with-xss/" class="bump-view" data-bump-view="tp">Abusing Password Managers with XSS</a></li>
<li><a href="http://labs.neohapsis.com/2012/11/14/browser-event-hijacking/" class="bump-view" data-bump-view="tp">Browser Event Hijacking</a></li>
<li><a href="http://labs.neohapsis.com/2010/01/19/even-if-you-dont-invent-your-own-crypto-its-still-hard/" class="bump-view" data-bump-view="tp">Even if You Don&#039;t Invent Your Own Crypto....It&#039;s Still Hard</a></li>
</ul></aside><aside id="twitter-3" class="widget widget_twitter"><h2 class="widget-title"><a href='http://twitter.com/neohapsis'>Twitter</a></h2><ul class='tweets'>
			<li>
				Attending Black Hat this year? Our Kate Pearce and Patrick Thomas will be there to discuss MultiPath TCP <a href="http://goo.gl/ze0IVV"> goo.gl/ze0IVV</a>---				<a href="http://twitter.com/neohapsis/statuses/492042238201831424" class="timesince">18&nbsp;hours&nbsp;ago</a>
			</li>

			
			<li>
				A year later and these tips for keeping your social media account secure are still extremely relevant <a href="http://goo.gl/IziZYG"> goo.gl/IziZYG</a>---				<a href="http://twitter.com/neohapsis/statuses/491640244089802753" class="timesince">1&nbsp;day&nbsp;ago</a>
			</li>

			
			<li>
				Our webinar on mobile threats and defenses is now on demand and can be listened to here <a href="http://goo.gl/cSfV7D"> goo.gl/cSfV7D</a>---				<a href="http://twitter.com/neohapsis/statuses/491257462167597056" class="timesince">2&nbsp;days&nbsp;ago</a>
			</li>

			
			<li>
				CSA updates guidance docs-&quot;created a much needed one-stop-shop in the cloud provider assessment process&quot; says CSA CEO <a href="http://goo.gl/qPF72r"> goo.gl/qPF72r</a>---				<a href="http://twitter.com/neohapsis/statuses/490188808952897537" class="timesince">5&nbsp;days&nbsp;ago</a>
			</li>

			
			<li>
				Major milestone in alignment btw Security Guidance for Critical Areas of Focus in Cloud Computing v3, CCM, &amp; CAIQ <a href="http://goo.gl/qPF72r"> goo.gl/qPF72r</a>---				<a href="http://twitter.com/neohapsis/statuses/490170498903318529" class="timesince">5&nbsp;days&nbsp;ago</a>
			</li>

			</ul><a href="http://twitter.com/neohapsis"  class='twitter-follow-button' data-show-count='false' data-link-color='#01a0db' data-text-color='#333333'>Follow @neohapsis</a></aside><aside id="facebook-likebox-3" class="widget widget_facebook_likebox"><h2 class="widget-title"><a href="http://www.facebook.com/neohapsis">Facebook</a></h2><iframe src="http://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fneohapsis&#038;width=200&#038;height=110&#038;colorscheme=light&#038;show_faces=false&#038;stream=false&#038;show_border=true&#038;header=false&#038;force_wall=false" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 200px;  height: 110px; background: #fff"></iframe></aside>		</div><!-- #secondary .widget-area -->

    </div> <!-- end #content -->

	<footer id="colophon" role="contentinfo">
		<div id="site-generator">

		<a href="http://wordpress.com/?ref=footer_blog">Blog at WordPress.com</a>.
<a href="https://wordpress.com/themes/newsworthy/" title="Learn more about this theme">The Newsworthy Theme</a>.		</div>
	</footer><!-- #colophon -->
</div><!-- #container -->

<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201430x'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781g'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {
			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	</div>

	<div id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id='bsub-text'>Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow &ldquo;Neohapsis Labs&rdquo;</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

						<p class="bit-follow-count">Join 71 other followers</p>
			<p><input type="email" name="email" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter email address" : this.value;'  id="loggedout-follow-field"/></p>

			<input type="hidden" name="action" value="subscribe"/>
			<input type="hidden" name="blog_id" value="2649112"/>
			<input type="hidden" name="source" value="http://labs.neohapsis.com/category/neohapsis/"/>
			<input type="hidden" name="sub-type" value="loggedout-follow"/>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="e49b81688d" /><input type="hidden" name="_wp_http_referer" value="/category/neohapsis/" />
			<p id='bsub-subscribe-button'><input type="submit" value="Sign me up" /></p>
			</form>
					<div id='bsub-credit'><a href="http://wordpress.com/signup/?ref=lof">Powered by WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->

	<script type="text/javascript">
		WPCOM_sharing_counts = {"http:\/\/labs.neohapsis.com\/2014\/03\/31\/putting-windows-xp-out-to-pasture\/":2011,"http:\/\/labs.neohapsis.com\/2014\/01\/07\/gutting-a-phish\/":1936,"http:\/\/labs.neohapsis.com\/2013\/08\/19\/defeating-cross-site-scripting-with-content-security-policy\/":1684,"http:\/\/labs.neohapsis.com\/2013\/07\/30\/picking-up-the-slaac-with-sudden-six\/":1669,"http:\/\/labs.neohapsis.com\/2013\/07\/10\/collecting-cookies-with-phantomjs\/":1657,"http:\/\/labs.neohapsis.com\/2012\/01\/03\/facebook-applications-have-nagging-vulnerabilities\/":1119,"http:\/\/labs.neohapsis.com\/2011\/12\/21\/the-security-implications-of-custom-android-roms\/":1103,"http:\/\/labs.neohapsis.com\/2011\/12\/20\/neopi-in-the-wild\/":1080,"http:\/\/labs.neohapsis.com\/2011\/06\/15\/were-all-consultants\/":1005,"http:\/\/labs.neohapsis.com\/2010\/03\/31\/thotcon-0x01\/":710}	</script>
		<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
							<script type="text/javascript">
			jQuery(document).on('ready', function(){
				jQuery('body').on('click', 'a.share-pinterest', function(e){
					e.preventDefault();

					// Load Pinterest Bookmarklet code
					var s = document.createElement("script");
					s.type = "text/javascript";
					s.src = window.location.protocol + "//assets.pinterest.com/js/pinmarklet.js?r=" + ( Math.random() * 99999999 );
					var x = document.getElementsByTagName("script")[0];
					x.parentNode.insertBefore(s, x);

					// Trigger Stats
					var s = document.createElement("script");
					s.type = "text/javascript";
					s.src = this + ( this.toString().indexOf( '?' ) ? '&' : '?' ) + 'js_only=1';
					var x = document.getElementsByTagName("script")[0];
					x.parentNode.insertBefore(s, x);
				});
			});
			</script>
		<script type='text/javascript' src='http://platform.twitter.com/widgets.js?ver=20111117'></script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzgjISczMo6aBXsFgPtBI+1xbQ2NLc3MzI1MjwywABOBhIw=='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?m=1395343499g&amp;ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414g&amp;ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var recaptcha_options = {"lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='http://s1.wp.com/_static/??-eJyNzUEOAiEMheELiXViYmRhPAuOBcpAIRQGvb3jwsTEjau3+PPlwShqztyQGwSBO640Y3nsg+zgKzWPCQVKvwHjkJFr8883YLOSM40y/01koaIi8aJsnrsoSz93qasSuyPefJambDRUQbypxO6zG7qmy3TUWk/6cDqHFwJPS80='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?22" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'2649112','v':'wpcom','tz':'-5','user_id':'0','subd':'neolab'});
ex_go({'crypt':'UE40eW5QN0p8M2Y/RE1LVmwrVi5vQS5fVFtfdHBbPyw1VXIrU3hWLHhmcmw0bWUwNis5Vk1qSEpzeXBoR2E/dmFIcl9HLjd1TGgrJm9kalImVUZGNEZjYjVlR1gseHYlYnF0eFdxQzNyZnFXLUR3MFRhUi9HOXBtY0NVMSxkK3JvM0ViJnx4bEYtbHx2Mlh6QnJ8bCVBRUEsTDBpWzMrWnFPbHdQQ0NWeUpmbG9UR09Ndi1oTngtYVJmYkwvd1lvOV9FemkvUCY2VlFbSUlsUWhiYzNrdGR4cWEscjlBdFo1S1g2XzBjUElKTTMveHRbSiVSL3Jpcnx2QTJkem9PWVd0bGlBLzFmSHV4eXhLSkVWbHd3TzFjakg9L1BdNzM0WzBSUEs2Wkx0d3QlRSs/RHUtWWpPNWh6Y3lbeDd3RjFE'});
addLoadEvent(function(){linktracker_init('2649112',0);});
	</script>
<noscript><img src="http://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>
