http://www.codeproject.com/Articles/20287/Generating-Word-Reports-Documents?fid=454670&df=90&mpp=25&sort=Position&spc=Relaxed&select=4154361&tid=3561734
HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html; charset=utf-8
Set-Cookie: SessionGUID=38cfaea3-4732-493c-839d-2bdf939cce89; path=/
Date: Thu, 24 Jul 2014 04:14:24 GMT
Content-Length: 162231

<!DOCTYPE HTML>


<html>
<head>
	<title>Generating Word Reports / Documents - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="http://s.codeproject.com/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.140721.1">

	
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Description" content="Generate Word documents by appling XSLT on XML data.; Author: Predrag Tomasevic; Updated: 4 Oct 2009; Section: Office Development; Chapter: Enterprise Systems; Updated: 4 Oct 2009" />
<meta name="Keywords" content=".NET2.0, SQL-server-2005, VS2005, C#2.0, XML, SQL, Windows, HTML, DBA, Dev, XSLT, Intermediate,Office Development,Enterprise Systems,Free source code, tutorials" />
<meta name="Author" content="Predrag Tomasevic" />
<meta name="Rating" content="General" />
<meta name="Robots" content="index, follow, NOODP" />
<meta name="Revisit-After" content="1 days" />
<meta name="application-name" content="CodeProject" />

<link rel="dns-prefetch" href="//ajax.googleapis.com" /> 
<link rel="canonical" href="/Articles/20287/Generating-Word-Reports-Documents" />


<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - iOS" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=25" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C++" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=2" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=3" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Web" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=23" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx" />
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml" />

	<base target="_top" />
	<link rel="icon" href="/favicon.ico" type="image/ico" >
<link rel="shortcut icon" href="/favicon.ico"  type="image/ico" >
<link rel="apple-touch-icon" href="/images/FavIcon-Apple.png" type="image/png" >
<script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function _dmBootstrap(file) { var _dma = document.createElement('script');  _dma.type = 'text/javascript'; _dma.async = true;  _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);}
function _dmFollowup(file) { if (typeof DMAds === 'undefined')  _dmBootstrap('cdn1.developermedia.com/a.min.js?dt=2.8.140721.1');}
(function () { _dmBootstrap('cdn1.developermedia.com/a.min.js?dt=2.8.140721.1'); setTimeout(_dmFollowup, 2000);})();

//]]>
</script>

	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script>


</head>	

<body class="unknown unknown0">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="/Images/t.gif" /></a>





<div class="page-background">

	
	

	
<div class="alert-bar  overlay " style="display: none;">
	<a href="#" class="close-notify">×</a>
	<div>Sign up for our free weekly <a href="/feature/web-newsletter">Web Developer Newsletter</a>.</div>
</div>

	<table id="ctl00_Bn" style="width:100%;height:135px" cellpadding="0" cellspacing="0" class="banner fixed">
	<tr valign="bottom">
		<td class="blank-background" style="height:31px">&nbsp;</td>
		<td class="blank-background" rowspan="3" style="width:250px;height:135px"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="http://s.codeproject.com/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" height="135" width="250" border="0" /></a></td>
		<td class="blank-background align-right" style="width:728px;height:31px">

<div class="container memberbar clearfix">

	<div id="ctl00_MemberMenu_GenInfo" class="float-left">10,751,502 members (77,564 online) &nbsp; &nbsp; </div>

	<div class="float-left">
		
	</div>

	<div class="float-right">

        

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734"
				document.subForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734">Sign in</a></span>

				<div class="tooltip-flyout">
					<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734" method="post" 
						class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" /></div>
						<div class="action">
							
<script type="text/javascript">
function Join(){
 var url = 'http://www.codeproject.com/script/Membership/Modify.aspx?meml=' + document.subForm.Email.value;
 document.location.href=url;return false;
}
document.write('<input type="button" class="create"   onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign"   value="true" />');
</script>
							<input type="submit" value="Sign in" class="signin" 
								onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in using <a class="oauth" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Linkedin" href="/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="/script/Membership/Images/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
		
	</div>
</div></td>
		<td class="blank-background" style="height:31px">&nbsp;</td>
	</tr>
	<tr valign="middle">
		<td class="theme1-background" style="height:94px">&nbsp;</td>
		<td class="theme1-background ad"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Word"  data-tags='.NET2.0, SQL-server-2005, VS2005, C#2.0, XML, SQL, Windows, HTML, DBA, Dev, XSLT, Intermediate,rating4.5'></div></td>
		<td class="theme1-background" style="height:94px">&nbsp;</td>
	</tr>
	<tr valign="top">
		<td style="height: 14px;"></td>
		<td style="height: 14px;" class="blank-background"></td>
		<td style="height: 14px;"></td>
	</tr>
</table>


	<a href="#Main"><img alt="Click here to Skip to main content" class="access-link" 
		src="/Images/t.gif" /></a>

	
	<div id="ctl00_TPR" class="sub-headerbar fixed">
	<table cellpadding="0" cellspacing="0" class="extended"><tr><td nowrap="nowrap">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li><a id="ctl00_TopNavBar_Home" href="http://www.codeproject.com">home</a>


<li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout">
			<li>
				<div id="siteMap">
					<img src="/images/animated.gif" alt="loading" style="margin:150px;width:100px;height:100px;" />
				</div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="/search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="/search.aspx?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="/images/write13.png" width="13px" height="13px" /> Submit an article or tip
			</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="/images/write13.png" width="13px" height="13px" /> Post your Blog
			</a></li>		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">quick answers</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="/images/write13.png" width="13px" height="13px" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img 
			src="/images/write13.png" width="13px" height="13px" /> Ask a Question</a></li>

		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=308" style="padding-left:30px">C#4.0 questions</a></li>
			
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">discussions</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Training-Issues.aspx">Work &amp; Training Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827459/Adobe-Technologies.aspx">Adobe Technologies</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C.aspx">Objective-C</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1832431/Ruby-On-Rails.aspx">Ruby On Rails</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1540733/Sharepoint.aspx">Sharepoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li>
		<li><a id="ctl00_TopNavBar_Research" class="fly" href="/script/ResearchLibrary/Index.aspx">Research Library</a></li>

		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li  class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">community</a>

	<ul>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird & The Wonderful</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li>
		<li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="/Forums/1738007/Press-Releases.aspx">Press Releases</a></li>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly" href="/script/Awards/MVPWinners.aspx">Most Valuable Professionals</a></li>
		<li><a id="ctl00_TopNavBar_Companies" class="fly break" href="/script/Membership/Profiles.aspx?mgtid=1&amp;mgm=True">Company Listings</a></li>

		
		<li class="openable"><a class="fly" href="/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul>
		<li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">help</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight1" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="/script/Content/SiteMap.aspx">Site Map</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="/info/Jobs/">Employment Opportunities</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
	</td><td align="right">
		

<div class="searchbar">

<form method="get" action="/search.aspx" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tr><td><input TabIndex="2" class="search " id="sb_tb" value="" name="q" /></td><td><input type="image" src="/images/search.gif" /></td></tr></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
	</td></tr></table>
	<div class="sub-headerbar-divider"></div>
	</div>
	

	<div id="A" class="container-content-wrap fixed"> 

	<div itemscope itemtype="http://schema.org/Article" class="container-content"> 

		<div class="clearfix">
			<div class="float-left container-breadcrumb">
				<div><a href="/script/Content/SiteMap.aspx">Articles</a> &#187; <a href="/Chapters/9/Enterprise-Systems.aspx">Enterprise Systems</a> &#187; <a href="/KB/office/"><span itemprop="articleSection">Office Development</span></a> &#187; <a href="/KB/office/#Microsoft+Word">Microsoft Word</a></div>
			</div>

			<div class="align-left float-right padded-top" style="width">
				


 
&nbsp;










			</div>

			<div class="float-right article-nav">
				
				

<a id="ctl00_ActionLinks_BookmarkMd_ImgBt" title="Bookmark" AlternateText="Bookmark" name="bm_20287_2" onclick="return bookmarkMe(20287,2,&#39;/script/Bookmarks/Ajax/Add.aspx?obid=20287&amp;obtid=2&amp;action=AddBookmark&amp;bio=true&amp;bis=medium&#39;,&#39;medium&#39;);" href="/script/Bookmarks/Add.aspx?obid=20287&amp;obtid=2&amp;action=AddBookmark&amp;bio=true&amp;bis=medium" style="display:inline-block;"><img title="Bookmark" src="/App_Themes/CodeProject/Img/bookmark24.png" alt="" border="0" /></a>


<span id="ctl00_ActionLinks_BookmarkMd_StatusMsg" class="tiny-text" style="display:none" name="bm_20287_2"></span>
<a id="ctl00_ActionLinks_PrintMd" href="/Articles/20287/Generating-Word-Reports-Documents?display=Print">
	<img src="http://s.codeproject.com/images/print24.png" title="Print"
		width="24px" height="24px" style="border:0">
</a>
			</div>

			<div class="align-right float-left">
				
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0"><tr valign="top">
		<td>

			<div id="ctl00_Nav" class="container-article-tabs">
				<div class="tabs">
					

<div class="">
	<div class="selected">Article</div><div class="unselected"><a href="/script/Articles/ListAlternatives.aspx?aid=20287">Alternatives</a></div>

	<!-- anchorLink used to auto-link to comments at end of article -->
	<div class="unselected"><a href="WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments 
        <span id="ctl00_ArticleTabs_CmtCnt">(114)</span></a>
	</div>

     
</div>	

				</div>

				
			</div>

		</td>
		<td>
			
			<div id="AT" class="container-article  fixed"> 
				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734" id="aspnetForm" style="margin:0;padding:0">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="1JJoc9xwLHAzxzx14BXodPcMRLp3xnxiRCHKBwBnTJhK1bjFWNyDVI54UpFVYns01MkoNR4IIusq5agtjWuDhvPkt1TUa9YOJfXUI8mrsR2CXoyvJlAdc5aU8n8n9Wjju4GgEuO6+MXR4Fv499fpkdLczFLqWjbDblmtcwDFIeVlOGvUZYamj/hR7ZNxEVUDBTK3X3mrDyOLztFLB+eWEiTjlBtP82x5oE/maBv630EjqJeMIg/uUHnYtFgEQRVbLEKtPLerEQ+zWrtzE6dyWyhnIUj6hplUu8Ld8SXlVDigXuQqzVPkev4uJzAiVv1RXPGZHEMXrPZNzMWoKkKVzwW2BdK1swpU2wUzMCuX0wf3XWXvv/FZqyqwBld0QgUP2iIewct86n2CYRn9uhRkEcLZBQaAUYGz9PwU8HIdeetnC3SVAtzF5GP1SUUtResO8urZNgbQkGHkjVp8DCiuT/Q1PINfCUK5GTrOuWlRgOq/zbMx5zeQ9VCZy8KEVckXQ52QFl/t+g/pZSkAW1i4SYFNIt2w3hlxq56B7oaYNx3rt1A3/JuMrkKXcNr+prbRZOH3su0EpMGs7AnYQfzXUhISny11sx519mbE/Ocw2fQizOiR2HNND+pf4Pwi1tv4ISNVv/hDgiGnKiXtcHm7NOD/3N+9f540sK/zbOf9V1pKnjahBLJY2JYKhWzqcGBuJZw117VpBR9jOiTGHSe9xQRdBSw9+qrzvXvDMNJMDl5083c1K7gTeC54VkSF1Sr6qrlOZ7BufkaagogNifrZBcQ7fCR9bMaEDoId0nAW+CfgzBMdquIkBry5Renib4vuGuDLqKDJmpV0+0TlXAasWnmbfmn/QCNQaFxf3DKhtfQe95NZWAzy0nHGGjrcVJ7muKunW4ElK8RcB2os4FpNhsQ/vWtMZZrPxmQb0fnQPI/wBsgMvd8gjDorEg3kuS6jcfd5/nQ69JoXLE83dEfuKpyGaaPbbNCMsU8ClvL4+HkX8fbkeXupG99LAbUE5gBGCMV7TmKEPr6hMRD5MSBeLca3HVJu35NWokoESvBrlNUPBslkUt3QPhz8svLXSA4az2oG6Vc/zlR1HJShjmtFmXhmp68WDb7xZAf37FL6hbbgR0UsUTeeKN+C2Y0HHomBOOQsjjUdIMPHgNhYIstKFPa7JxFTzCfWSqGTkDreI9mguJfDbndNPcJufsxEAVLn+KrK+mO8rkMsa+/pTi8ltdQk/NM2odrstSHrjJsQsTHoBntyNlcfteHQ+8V7Gqwpa9kLoCPx4ATQ6RWGJyVarjs6HGe7BmME0Pn1mXUdOTL4q9C3A5pTqNaYVLDjuX279MM0ADhCqTdC4pplOHeBtXiDMvS9oHaTPn4Mjj/zeQOy96X33dh24WQtVsnVkvbdrf/Hma4t3TnBhRYzpPFt/XK4kOfmnKjQSxsd9easkCIqM/ry3M95kEwtM3rKfQpDkYaC29W8bFiZTCfrd5W0yFK1fUBe+Q7t6osKkIZu2rrTKIALmgKgUPhVRpFpo2xmQi+gXmjsGs3ENLO518zcZaSnV14tnZSJYgVlX6zPPicgY330xMy6mrous3iqwM9HTdApQJGZda7qby8iGJw8gvO7ufI8zGFmu6jPw+1JCXwrEhraANq7OH5J40rI0CvmuA4vpIzNRGQgZbDqekuOwn6nSdzvs0wd1Y2jJRdkq2bmUnngdNNST7EXpkvX8ZFYPdZ8IL+kAR7xzV3WmDkIyk4hO7O5omIASXihpzroUIWIcigPsumbPPXzE3d/zd49nay+UbdSpeQJj7TnIdmuopC+9GTSzN/XDO3GmbvIEqEEqXKL6/Hck4b+sQG5LIfwcO+HeEC7SAfXq+DBtaU/7wMlDHbDqOa9uHUawvw5qGOelbhFM4xsL7AFxkjKwozoVR28UfEoXEQKk20Jr9HkDvcNJ0Kqfj4AmPiWOf+qzCdEeFWL8SS3g9nlWSPlbHDPYTRk4Kn93JaWRXP6Lc3l9/wgqpC6qsp5oJtXUMuXYHs/eqKurxuxeKprFe8geajjXnyW1GAsTKxJNJzJhDxOzQsrsHYOMk0xS/pEqYgtaEu93J/xfwSg4UV+7QAIWTTauDBC2rUUtnsD9kHq5fK23onNNRiKTqMLfXO7+WGUQI/I+5krM9EA8mOHELyK0rCXYwvnlXDfjE7HQiwn7rGXWppcEouFHoDExgkmYiWyzNPp/yxX" />


					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        
					        <h1 id="ctl00_ArticleTitle" itemprop="name">Generating Word Reports / Documents</h1> 
					    </div>

                        <div style="height:34px">
					        
					        <div class="entry float-left">
                                
                                <div class="float-left">

						            <span class="author"><a href="/script/Membership/View.aspx?mid=4273880" rel="author"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Predrag Tomasevic</span></span></a></span>, 
						            <span class="date" itemprop="dateModified" content="2009-10-04 11:57:00">
							            4 Oct 2009</span>
			
						            <div id="ctl00_CurRat" class="tooltip anchorLink" style="cursor:pointer;margin-top: 5px" name="CurRat_20287">
				
							            

<table cellpadding="0" cellspacing="0" class="small-text" itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating"> 
<tr>
	
	<td class="nowrap">

		
			<meta itemprop="bestRating" content="5"> 
			<meta itemprop="worstRating" content="1">
		

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-large" style="position:relative;">
	<div class="clipped align-left float-left">
		<img src="http://s.codeproject.com/script/Ratings/Images/stars-fill-lg.png" border="0" />
	</div><div class="clipped" style="position:relative;">
		<img src="http://s.codeproject.com/script/Ratings/Images/stars-empty-lg.png" border="0" style="position:absolute;top:0;right:0;" />
	</div>
</div>
		</span>

		
	</td>
	
	<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;<span itemprop="ratingValue" class="rating">4.94</span> (<span itemprop="ratingCount" class="count">122</span> votes)</span>
		
	</td>

</tr>

</table>


							            <div id="ctl00_RB" class="speech-bubble-container-up">
								            <div class="speech-bubble-up" style="width:150px !important">
									                        
<div>
<table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tr class="chart-row"><td class="chart-column rating-ignore-vote" title="Outside deviation limits - not included in score."><img src="/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="1 vote, 0.8%" title="1 vote, 0.8%" /><br /><span title="1 vote">1</span></td>
<td class="chart-column rating-ignore-vote" title="Outside deviation limits - not included in score."><img src="/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="1 vote, 0.8%" title="1 vote, 0.8%" /><br /><span title="1 vote">2</span></td>
<td class="chart-column rating-ignore-vote" title="Outside deviation limits - not included in score."><img src="/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="4 votes, 3.3%" title="4 votes, 3.3%" /><br /><span title="4 votes">3</span></td>
<td class="chart-column"><img src="/script/Ratings/Images/pollcol.gif" width="20pxpx" height="2px" border="0px" alt="6 votes, 5.0%" title="6 votes, 5.0%" /><br /><span title="6 votes">4</span></td>
<td class="chart-column"><img src="/script/Ratings/Images/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="109 votes, 90.1%" title="109 votes, 90.1%" /><br /><span title="109 votes">5</span></td>
</tr></table><div class="small-text align-center">4.94/5 - 122 votes</div><div class="small-text align-center subdue">6 removed</div><div class="small-text align-center subdue">μ 4.82, σ<sub>a</sub> 1.05 [<a href="/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								            </div>
								            <div class="speech-bubble-pointer-up">
									            <div class="speech-bubble-pointer-up-inner"></div>
								            </div>
							            </div>
						            </div>
                                </div>
					        </div>

                            
						    <div id="ctl00_RateArticleRow" class="float-right align-right voting-bar">
						        <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_20287">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loaderImg" width="16px" alt="loading..." height="16px" 
				src="/Images/animated_loading_blue.gif" style="display:none;" /> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-large">
					

					<span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" /><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" /><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" /><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" /><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" /></span> 

						
					</span>

				</td>

				
				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" />
				</td>
			</tr>
			</table>
			
		</td>
	</tr>
	</table>
	<div class="hover-container">
		
        <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right">
            <div class="padded">
            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734">Sign up or sign in</a> to vote.
            </div>
        </div>
	</div>
</div>
						    </div>
						    	

                            
				            <div style="width:180px;margin:0px 0 0 0px" class="float-right">
					            



<!-- Buttons start here. Copy this ul to your document. -->
<ul class="rrssb-buttons clearfix">
    <li class="email">

        <!-- Replace subject with your message using URL Endocding: http://meyerweb.com/eric/tools/dencoder/ -->
        <a href="mailto:?subject=Generating%20Word%20Reports%20/%20Documents%20-%20CodeProject&amp;body=http%3a%2f%2fwww.codeproject.com%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g><path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"/></g></svg>
            </span>
            <span class="text">email</span>
        </a>
    </li>
    <li class="facebook">
        <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fwww.codeproject.com%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                </svg>
            </span>
            <span class="text">facebook</span>
        </a>
    </li>
    
    <li class="linkedin">
        <!-- Replace href with your meta and URL information -->
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fwww.codeproject.com%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734&amp;title=Generating%20Word%20Reports%20/%20Documents%20-%20CodeProject" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                </svg>
            </span>
            <span class="text">linkedin</span>
        </a>
    </li>
    <li class="twitter">
        <!-- Replace href with your Meta and URL information  -->
        <a href="http://twitter.com/home?status=Generating%20Word%20Reports%20/%20Documents%20-%20CodeProject%20http%3a%2f%2fwww.codeproject.com%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                        width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                </svg>
            </span>
            <span class="text">twitter</span>
        </a>
    </li>
    
    <li class="googleplus">
        <!-- Replace href with your meta and URL information.  -->
        <a href="https://plus.google.com/share?url=Check%20out%20Generating%20Word%20Reports%20/%20Documents%20-%20CodeProject%20http%3a%2f%2fwww.codeproject.com%2fArticles%2f20287%2fGenerating-Word-Reports-Documents%3ffid%3d454670%26df%3d90%26mpp%3d25%26sort%3dPosition%26spc%3dRelaxed%26select%3d4154361%26tid%3d3561734" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <g>
                        <g>
                            <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"/>
                            <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      "/>
                        </g>
                    </g>
                </svg>
            </span>
            <span class="text">google+</span>
        </a>
    </li>
    
</ul>
<!-- Buttons end here -->

				            </div> 
    			            

						    	
                            <div class="float-right" style="margin-right:10px">
						        
                            </div>                    
						    	
                        </div>

   					    
                        <div id="ctl00_description" class="summary">Generate Word documents by appling XSLT on XML data.</div>			

                    </div>
                    
					
					


					
					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text" itemprop="articleBody">
						



<ul class="download">
<li><a href="/KB/office/Generating_Word_Reports/Article_src1.zip">Download source - 73.4 KB</a></li>
</ul>

<h2>Introduction (ramble)</h2>

<p>Another boring day in my life. I often wonder why it has to be like this – I either have no obligations at all, or I'm packed with them. Most people tell me that it has to do with planning. They wear their favorite serious face and say: you, my son, just don't know how to properly make your schedule. Time is the essence, do not use it improperly! You must divide your time in million little pieces, label each one of them, implement some kind of sorting, import everything into Microsoft Outlook, and stick to that plan. Then, and only then, you'll be a man who is not a campaigner, but an organized, equally time pressured <strike>&quot;snooze-dismiss&quot; monkey</strike> individual.</p>

<p>My answer is way simpler, I often reply with just – hey, screw you! <img src="/script/Forums/Images/smiley_wink.gif" align="top" alt="Wink | ;)" /> </p>

<p>Because, really, I've always believed it's not about planning, but about the way universe has been built. Think about it – everything important was created in just those few seconds after the Big Bang. All that followed was just plain simple boring processes of waiting for the fruits of planted seeds to grow; the stage setting for another big moment.</p>

<p>So, I hope you'll agree that it is – as Derek Ager once wrote – like the life of a soldier... long periods of boredom, and short periods of terror. One can just hope that those &quot;long periods of boredom&quot; can be filled with small joys of doing something you like; something that'll ease your wait for those important &quot;short periods&quot;.</p>

<p>This article is just that, my way of getting along with boredom... if it helps someone else, or fills his spare time, my joy will only be greater.</p>

<h2>Index</h2>

<ul>
<li><a href="#Problem">Problem</a></li>

<li><a href="#BriefSolutionDescription">Brief solution description</a></li>

<li><a href="#ProducingXSLTransformation">Producing the XSL transformation</a></li>

<ul>
<li><a href="#DefiningXMLSchemaBasedOnReport">Defining the XML schema based on the report</a></li>

<li><a href="#BindingDataFromWordDocument">Binding data from the Word document to the appropriate fields in the XML schema</a></li>

<li><a href="#SavingIntoWordMLAndGenerationOfXSLT">Saving into WordML and the generation of XSLT</a></li>

<li><a href="#SolvingProblemsWithMultipleUsedElements">Solving problems with multiple used elements</a></li>

<li><a href="#InsertingImagesIntoDocument">Inserting images into the document</a></li>

<li><a href="#OpeningDocumentInReadOnlyMode">Opening the document in read-only mode</a></li>
</ul>

<li><a href="#PreparingDataAndApplyingTransformation">Preparing data and applying the transformation</a></li>

<ul>
<li><a href="#T-SQLAndXML">T-SQL and XML</a></li>

<li><a href="#BindingXMLToSchema">Binding XML to schema</a></li>
</ul>

<li><a href="#ApplianceOfTransformationOnXMLData">Applying the transformation on XML data</a></li>

<li><a href="#TheEasyWayOut">XML-&gt;XSLT-&gt;HTML-&gt;Word, the easy way out</a></li>

<li><a href="#OrganizationOfResources">Organization of resources used for the generation in the Visual Studio project</a></li>

<li><a href="#FAQ">FAQ</a></li>

<li><a href="#Conclusion">Conclusion</a></li>

<li><a href="#References">References</a></li>

<li><a href="#History">History</a></li>
</ul>

<h2><a id="Problem"></a>Problem</h2>

<p>I don't know if you are in a club, but I've met numerous .NET developers who had much trouble with choosing the right tool to build reports. Apart from praise for the Access report building capabilities, you won't hear many compliments for the reporting tools.</p>

<p>I guess we have all tried Crystal Reports embedded into Visual Studio .NET - they are OK, but are demanding. And often, small bugs, along with ridiculous option placements, will drive you nuts.</p>

<p>SQL Reporting Services are somewhat a new option that is praised all over the web by Microsoft evangelists. In practice, however, I've often stumbled on projects where the team is paralyzed with problems concerning configuration and specific aspects of report writing.</p>

<p>Finally, there are numerous custom reporting frameworks such as <a href="http://www.datadynamics.com/Products/ProductOverview.aspx?Product=ARNET3" target="_blank">ActiveReports</a> or DevExpress' (I love these guys) <a href="http://www.devexpress.com/Products/NET/ReportingTools.xml" target="_blank">Reporting Tools</a>.</p>

<p>Specific maladies aside, the common problem with all the previously laid options is that they have a modest learning curve. I'm not talking about the time needed to acquire the knowledge for generating a list of employees from an &quot;It's easy to use our report suite&quot;™ example. I'm talking about the time needed to acquire the knowledge for developing real-life reports which have three tables that properly expand and contract (along with its columns and rows) over pages.</p>

<p>Also, none of these options provide you with the solution for frequent user requirements – when a report is rendered, it should be possible to modify it a bit. The workaround is to use report exporting to popular formats that are known to most users, like Word.</p>

<p>As I've experienced, this is the point when the bulb shines above the head of the developer and the idea comes - why not generate reports in Word in the first place. In the majority of projects, clients are provided with the needed output reports in Word format, which they print and fill by hand. And if not... well, you have one of the best &quot;report designers&quot; in the world, as it was tweaked and improved over numerous versions.</p>

<p>So, how to do it?</p>

<h2><a id="BriefSolutionDescription"></a>Brief solution description</h2>

<p>One big, big problem with Word documents before the 2003 version was their binary format. Word's file format was not publicly available, and all utilities that could parse it were mostly developed by reverse-engineering, or by <strike>stealing</strike> using documentation available to Microsoft partners. You can guess that results weren't too satisfying...</p>

<p>However, in 2003, Microsoft introduced XML formats for storing Office documents. Those formats were succeeded by Office Open XML formats in Office 2007 (which are default, instead of their binary counterparts), so you can safely bet that they are here to stay.</p>

<p>So, in order to generate a Word file now, you basically need to apply the appropriate XSLT (XSL Transform) onto the XML data used in a report. This process can be divided into several operational steps:</p>

<ol>
<li>Defining the XML schema based on the report</li>

<li>Binding data from the Word document to the appropriate fields in XML schema</li>

<li>Saving the Word document in WordML format and the generation of XSLT using the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=2cb5b04e-61d9-4f16-9b18-223ec626080e&amp;displaylang=en" target="_blank">WML2XSLT tool</a></li>

<li>Retrieving the needed data from a source (mostly a SQL Server database), it's structuring into appropriate XML</li>

<li>Applying XSLT onto XML data in order to generate the Word document, which then can be further manipulated (sending over wire, displaying to user, and similar)</li>
</ol>

<p>The biggest problem is to produce valid XSLT; from five steps, three are taken to do that. The generation of XML is far easier, while the transformation is completely trivial.</p>

<h2><a id="ProducingXSLTransformation"></a>Producing the XSL transformation</h2>

<h3><a id="DefiningXMLSchemaBasedOnReport"></a>Defining the XML schema based on the report</h3>

<p>In order to start making the report, it is required to define the necessary data. A picture talks more than a thousand words, an example talks almost an equal amount... so let's look at the picture of the report that we'll use as an example:</p>

<p><img width="578" hspace="0" height="337" border="1" alt="Figure 1 – Report that should be generated" src="/KB/office/Generating_Word_Reports/figure1.jpg" /></p>

<div class="caption">Figure 1 – Report that should be generated</div>

<p>It is obvious that we first have the buyer's name, the document date follows. Then we have, from the developer point of view, an interesting table of invoice items... and so on. The structure of the XML which will hold this data is described using an XML schema. Visual Studio 2005 has nice support for visual design of schemas, which we will utilize – after starting the IDE, take option File –&gt; New –&gt; File (CTRL+N): this gives a list of possible document types from which we choose XML Schema.</p>

<p>An <code>element</code> from the Toolbox should then be dragged-and-dropped on the workspace and filled with content. This process is shown on the picture that follows:</p>

<p><img width="497" hspace="0" height="344" border="1" alt="Figure 2 – Schema that defines structure of data for report" src="/KB/office/Generating_Word_Reports/figure2.jpg" /></p>

<div class="caption">Figure 2 – Schema that defines the structure of data for the report</div>

<p>In order to be properly mapped, items on the invoice need to be described as child elements of the <code>Invoice</code> entity. Add -&gt; New element from the context menu shown after right click gives the option to perform this action.</p>

<p><img width="516" hspace="0" height="357" border="1" alt="Figure 3 – Adding child to Invoice entity" src="/KB/office/Generating_Word_Reports/figure3.jpg" /></p>

<div class="caption">Figure 3 – Adding a child to the Invoice entity</div>

<p>Adding the rest of the elements, assigning types to variables, and setting the <code>targetNamespace</code> (in the Properties window) gets the job done.</p>

<p>Assigning types to variables is optional in most cases – if you use special formats for printing out documents (like dd.MM.yyyy) or monetary values ($10.99), it's easier to leave everything in the schema in string type, and do the formatting and validation during the generation of XML with the data.</p>

<p>On the other hand, setting the <code>targetNamespace</code> shouldn't be optional – the produced schema will get the default value <em>http://tempuri.org/XMLSchema.xsd</em>. We can put aside the rules of good practice that tells us not to use the <em>http://tempuri.org/</em> namespace in production; but, if you don't give unique names to your schemas, you'll stumble into problems during import and usage – Word's schema library can't hold two different schemas with the same namespace. So, be sure to set the <code>targetNamespace</code> (the convention <em>http://Organization/Project/SchemaName.xsd</em> is used mostly) before you close the definition.</p>

<p><img width="456" hspace="0" height="162" border="1" alt="Figure 4 – Resulting XML schema" src="/KB/office/Generating_Word_Reports/figure4.gif" /></p>

<div class="caption">Figure 4 – Resulting XML schema</div>

<h3><a id="BindingDataFromWordDocument"></a>Binding data from the Word document to the appropriate fields in the XML schema</h3>

<p>Schema importing is performed by using the XML Structure dialog. In the 2003 version of Office Word, this dialog is accessible through Task Pane (CTRL+F1); it should be chosen from the list shown when clicked on the triangle in the header (left from the small x). If schemas aren't previously imported, and the Template and Add-Ins option is chosen, the picture that follows will faithfully resemble the resulting state of the screen.</p>

<p><img width="575" hspace="0" height="409" border="1" alt="Figure 5 – Adding new XML Schema in Word document" src="/KB/office/Generating_Word_Reports/figure5.jpg" /></p>

<div class="caption">Figure 5 – Adding the new XML schema in the Word document</div>

<p>In the dialog shown after clicking on the Add Schema button, it is needed to point to the location of the defined XML schema. Its fields will be then shown in the XML Structure dialog, from where they are further bound to the document data. Before starting that sweet job, some additional options should be set:</p>

<ul>
<li>Check <em>Ignore mixed content</em> – This allows mixing data from the XML with data from the document. As documents are almost always made of fixed and variable parts, this avoids frequent signalization by Word that between the data defined in the XML schema there are &quot;some others that don't belong there&quot;.</li>

<li>Check <em>Show advanced XML error messages</em> – Choosing developer-friendly messages over user-friendly ones.</li>

<li>Check <em>Allow saving as XML even if not valid</em> – Most often, you just can't &quot;validly&quot; mark data in the report document. For example, if some data from the XML is used twice in the document, Word will signal error in validation because according to the XML schema, that data appears only once. The same problem happens with order.</li>

<p>This is present to force valid entry of data in the Word document (another application of the technique that is being described). However, our current goal is diametrically opposite – we are not marking fields for entry, but for space in which data from the XML will be inserted, so it's not needed to force a unique appearance and order.</p>
</ul>

<p><img width="447" hspace="0" height="340" border="1" alt="Figure 6 – Dialog for setting XML data" src="/KB/office/Generating_Word_Reports/figure6.jpg" /></p>

<div class="caption">Figure 6 – Dialog for setting XML data</div>

<p>After the schema is imported in to the document and the options set, it's time to move onto binding the schema and the data. Initially, only the root element (in our case, <code>Invoice</code>) is available. After choosing it, Word will offer options for assigning the schema to the appropriate range in the document.</p>

<p><img width="575" hspace="0" height="416" border="1" alt="Figure 7 – Options for applying schema on appropriate range in document" src="/KB/office/Generating_Word_Reports/figure7.jpg" /></p>

<div class="caption">Figure 7 – Options for applying the schema on the appropriate range in the document</div>

<p>In this example, applying the schema to the entire document is a needed option (possible multi-schematic Word files aren't interesting from the reporting point of view). Now, what is left is to mark the data – the selected text is bound to the schema either by choosing the field from the Task Pane, or by using the option <em>Apply XML Element</em> shown after a right click.</p>

<p><img width="575" hspace="0" height="416" border="1" alt="Figure 8 – Binding data from Word document to fields of XML schema" src="/KB/office/Generating_Word_Reports/figure8.jpg" /></p>

<div class="caption">Figure 8 – Binding data from a Word document to fields of the XML schema</div>

<p>Two things are interesting here. First, to define child items, you need to select and map the whole row in the table to the <code>InvoiceItems</code> element, after which <code>Name</code> and <code>Price</code> will be available for bounding to the cell's data. If the document contains a large number of items, there is no need to map every single row; mapping just the first row is fine, the rest can be deleted. The structure of report, not the content, is what matters at the moment.</p>

<p>Second, Word, for previously explained reasons, signals error for double usage of the <code>Buyer</code> element (look at the picture). It'll cause problems later, during the generation of the XSLT, but we can omit that problem for now (if <em>Allow saving as XML even if not valid</em> is checked in the XML options).</p>

<h3><a id="SavingIntoWordMLAndGenerationOfXSLT"></a>Saving into WordML and the generation of XSLT</h3>

<p>The marked document contains all the data needed for the generation of valid XSLT. The <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=2cb5b04e-61d9-4f16-9b18-223ec626080e&amp;displaylang=en" target="_blank">WML2XSLT tool</a> accepts WordML as input, so it's required to save the Word document in this format. You can do this by using the <em>Save As</em> option from the <em>File</em> menu – when the dialog is shown in <em>Save as Type</em>, choose <em>XML document (*.xml)</em>. The option <em>Apply transform</em> is used in the opposite direction, <em>Data only</em> when XML data is fetched from the document, so both fields should be left unchecked.</p>

<p>The prepared WML file is processed using this statement in the Command Prompt (the following is valid assuming that everything is in the same directory):</p>

<pre lang="text">WML2XSLT.exe "WordGeneratedInvoice.xml" –o "WordGeneratedInvoice.xslt"</pre>

<p>In case you run into problems (<code>FileNotFoundException</code>) while using the <em>WML2XSLT.exe</em> packed with the article source, be sure to download the tool from the previously given link and perform the installation (as mobfigr noted in <a href="?fid=454670&amp;df=90&amp;mpp=50&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2433787#xx2433787xx" target="_blank">his comment</a>).</p>

<h3><a id="SolvingProblemsWithMultipleUsedElements"></a>Solving problems with multiple used elements</h3>

<p>The generated XSL transform will almost always be satisfying. One exception is when an element from the XML with data is used multiple times. In the example we are developing, the <code>Buyer</code> element is used twice, and for its second appearance, the following will be generated (you need to open the XSLT in Notepad or Visual Studio .NET and search for the value <code>ns1:Buyer</code>):</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span> <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span>(Buyer: <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:apply-templates</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">ns1:Buyer[position() &gt;= 2]"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span> <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span>)<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span></pre>

<p>It's obvious we aren't interested in the element <code>Buyer</code> on the second position, but the same one that is referenced earlier in the file. Because of that, the following correction should be made:</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span> <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span>(Buyer: <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:apply-templates</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">ns1:Buyer"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span> <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span>)<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:text</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span></pre>

<h3><a id="InsertingImagesIntoDocument"></a>Inserting images into the document</h3>

<p>Naturally, WordML has good support for images, but it is very poorly documented. So, in order to see how images are represented in WML format, we'll perform a little experiment and save the marked Word document displayed below as XML:</p>

<p><img width="600" hspace="0" height="462" border="1" alt="Figure 9 – Document with image" src="/KB/office/Generating_Word_Reports/figure89.jpg" /></p>

<div class="caption">Figure 9 – Document with image</div>

<p>After processing the saved document using the WML2XML tool (with the <em>WML2XML ExampleImage.xml -o ExampleImage.xslt</em> command), and opening the generated XSLT file, we can scroll to the <code>SomeImage</code> tag and see the following:</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">ns0:SomeImage</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:for-each</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">@ns0:*|@*[namespace-uri()='']"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:attribute</span> <span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">{name()}"</span> <span class="code-attribute">namespace</span><span class="code-keyword">="</span><span class="code-keyword">{namespace-uri()}"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">."</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:attribute</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:for-each</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:shapetype</span> <span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">_x0000_t75"</span> <span class="code-attribute">coordsize</span><span class="code-keyword">="</span><span class="code-keyword">21600,21600"</span> <span class="code-attribute">o:spt</span><span class="code-keyword">="</span><span class="code-keyword">75"</span> 
              <span class="code-attribute">o:preferrelative</span><span class="code-keyword">="</span><span class="code-keyword">t"</span> <span class="code-attribute">path</span><span class="code-keyword">="</span><span class="code-keyword">m@4@5l@4@11@9@11@9@5xe"</span> <span class="code-attribute">filled</span><span class="code-keyword">="</span><span class="code-keyword">f"</span> <span class="code-attribute">stroked</span><span class="code-keyword">="</span><span class="code-keyword">f"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:stroke</span> <span class="code-attribute">joinstyle</span><span class="code-keyword">="</span><span class="code-keyword">miter"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:formulas</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">if lineDrawn pixelLineWidth 0"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">sum @0 1 0"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">sum 0 0 @1"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @2 1 2"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @3 21600 pixelWidth"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @3 21600 pixelHeight"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">sum @0 0 1"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @6 1 2"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @7 21600 pixelWidth"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">sum @8 21600 0"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">prod @7 21600 pixelHeight"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:f</span> <span class="code-attribute">eqn</span><span class="code-keyword">="</span><span class="code-keyword">sum @10 21600 0"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">v:formulas</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:path</span> <span class="code-attribute">o:extrusionok</span><span class="code-keyword">="</span><span class="code-keyword">f"</span> <span class="code-attribute">gradientshapeok</span><span class="code-keyword">="</span><span class="code-keyword">t"</span> <span class="code-attribute">o:connecttype</span><span class="code-keyword">="</span><span class="code-keyword">rect"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">o:lock</span> <span class="code-attribute">v:ext</span><span class="code-keyword">="</span><span class="code-keyword">edit"</span> <span class="code-attribute">aspectratio</span><span class="code-keyword">="</span><span class="code-keyword">t"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">v:shapetype</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:binData</span> <span class="code-attribute">w:name</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span><span class="code-keyword">&gt;</span>R0lGODlhEAAQAPIGAAAAAAAAsACwALAAALD/sP+wsP
   ///////yH5BAEAAAcALAAAAAAQABAAAAOW
eHd3h3d3d3h3d4d3cHd4d3eHd3cHWHAXgXF3d3gHVYNwZxZ4d3eAVTUDeHdhh3d3UFgDdocRcXd4
d1CAdncXaHZ3h3dgd3h3Z4d3d3d4d3eHB3d3eHd3h3d3QAh3d4d3d3d4QCSAd3d3eHcHhEQicHh3
d4d3B0QoYHeHd3d3eAcEhnd3d3h3d4cHdnd4d3eHd3d3eHeXADu=
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:binData</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:shape</span> <span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">_x0000_i1025"</span> <span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">#_x0000_t75"</span> <span class="code-attribute">style</span><span class="code-keyword">="</span><span class="code-keyword">width:12pt;height:12pt"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:imagedata</span> <span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span> <span class="code-attribute">o:title</span><span class="code-keyword">="</span><span class="code-keyword">convert"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">v:shape</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
  <strong><em><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:p</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">."</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:t</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:p</span><span class="code-keyword">&gt;</span></em></strong>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">ns0:SomeImage</span><span class="code-keyword">&gt;</span></pre>

<p>Obviously, the image is Base64 encoded into the XML file between the <code>&lt;w:binData&gt;</code> tags. After that, we have the <code>&lt;v:shape&gt;</code> tag which defines the placing of the image and references the encoded binary data by using <code>&lt;v:imagedata&gt;</code>. All this is preceded by <code>&lt;v:shapetype&gt;</code>, which is (luckily) optional and can be removed. Now, when we have some understanding of the format, we can perform a little clean up and properly place <code lang="xml">xsl:value-of select</code>, so that binary data comes from our XML file:</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">ns0:SomeImage</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:for-each</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">@ns0:*|@*[namespace-uri()='']"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:attribute</span> <span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">{name()}"</span> <span class="code-attribute">namespace</span><span class="code-keyword">="</span><span class="code-keyword">{namespace-uri()}"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">."</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:attribute</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:for-each</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
    <strong><em><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:binData</span> <span class="code-attribute">w:name</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">."</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:binData</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:shape</span> <span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">_x0000_i1025"</span> <span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">#_x0000_t75"</span> <span class="code-attribute">style</span><span class="code-keyword">="</span><span class="code-keyword">width:12pt;height:12pt"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:imagedata</span> <span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span> <span class="code-attribute">o:title</span><span class="code-keyword">="</span><span class="code-keyword">convert"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">v:shape</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span></em></strong>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:r</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">ns0:SomeImage</span><span class="code-keyword">&gt;</span></pre>

<p>It looks better, doesn't it? All that is left is to supply the XML data in the proper format:</p>

<pre lang="xml"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span> <span class="code-summarycomment">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span> <span class="code-summarycomment">encoding</span><span class="code-keyword">="</span><span class="code-keyword">utf-8"</span> <span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">Something</span> <span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.microsoft.com/GeneratingWordDocuments/ImageExample.xsd"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">SomeText</span><span class="code-keyword">&gt;</span>Small image below<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">SomeText</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">SomeImage</span><span class="code-keyword">&gt;</span>R0lGODlhE[-- binary data truncated --]3d3eHeXADu=<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">SomeImage</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Something</span><span class="code-keyword">&gt;</span></pre>

<p>and we'll have the document from Figure 9 in no time. One final word of warning - if your images aren't always the same size, you'll want to check the <code>style</code> attribute of the <code>&lt;v:shape&gt;</code> tag. And, after checking, you'll probably want to move it out of the transformation into XML <img src="/script/Forums/Images/smiley_wink.gif" align="top" alt="Wink | ;)" /> . Here is how to do that:</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:binData</span> <span class="code-attribute">w:name</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">."</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:binData</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:shape</span> <span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">_x0000_i1025"</span> <span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">#_x0000_t75"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:attribute</span> <span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">style"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">="</span><span class="code-keyword">@style"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:attribute</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">v:imagedata</span> <span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">wordml://01000001.gif"</span> <span class="code-attribute">o:title</span><span class="code-keyword">="</span><span class="code-keyword">convert"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">v:shape</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:pict</span><span class="code-keyword">&gt;</span>
 
<span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span> <span class="code-summarycomment">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span> <span class="code-summarycomment">encoding</span><span class="code-keyword">="</span><span class="code-keyword">utf-8"</span> <span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">Something</span> <span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.microsoft.com/GeneratingWordDocuments/ImageExample.xsd"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">SomeText</span><span class="code-keyword">&gt;</span>Small image below<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">SomeText</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">SomeImage</span> <span class="code-attribute">style</span><span class="code-keyword">="</span><span class="code-keyword">width:24pt;height:24pt"</span><span class="code-keyword">&gt;</span>R0lGOD[-- binary data truncated --]3d3eADu=
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">SomeImage</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Something</span><span class="code-keyword">&gt;</span></pre>

<h3><a id="OpeningDocumentInReadOnlyMode"></a>Opening the document in read-only mode</h3>

<p>To force opening the report in read-only mode when the report is displayed to the user, it's needed to use the Tools -&gt; Options -&gt; Security -&gt; Protect Document option during the document creation. Under Editing Restrictions, 'No changes (Read only)' should be chosen... after that, the only thing left to do is click onto 'Yes, Start Enforcing Protection' and enter the password for protection. Of course, further steps remain the same - the document is saved as WordML, processed through the WML2XSLT tool...</p>

<p><img width="595" hspace="0" height="468" border="1" alt="Figure 9 – Settings for read-only mode" src="/KB/office/Generating_Word_Reports/figure99.jpg" /></p>

<div class="caption">Figure 10 – Settings for the read-only mode</div>

<p>Do not expect too much from this &quot;protection&quot;. In WordML format, it's enforced by one line in the <code>DocumentProperties</code> element:</p>

<pre lang="xml">  <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:docPr</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:view</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">print"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:zoom</span> <span class="code-attribute">w:percent</span><span class="code-keyword">="</span><span class="code-keyword">85"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:doNotEmbedSystemFonts</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:proofState</span> <span class="code-attribute">w:spelling</span><span class="code-keyword">="</span><span class="code-keyword">clean"</span> <span class="code-attribute">w:grammar</span><span class="code-keyword">="</span><span class="code-keyword">clean"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:attachedTemplate</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <strong><em><span class="code-keyword">&lt;</span><span class="code-leadattribute">u</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">w:documentProtection</span> <span class="code-attribute">w:edit</span><span class="code-keyword">="</span><span class="code-keyword">read-only"</span> <span class="code-attribute">w:enforcement</span><span class="code-keyword">="</span><span class="code-keyword">on"</span> 
                             <span class="code-attribute">w:unprotectPassword</span><span class="code-keyword">="</span><span class="code-keyword">4560CA9C"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">u</span><span class="code-keyword">&gt;</span></em></strong>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:defaultTabStop</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">720"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:punctuationKerning</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:characterSpacingControl</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">DontCompress"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:optimizeForBrowser</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:validateAgainstSchema</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:saveInvalidXML</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:ignoreMixedContent</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:alwaysShowPlaceholderText</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">off"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:compat</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:breakWrappedTables</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:snapToGridInCell</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:wrapTextWithPunct</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:useAsianBreakRules</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:dontGrowAutofit</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:compat</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">w:showXMLTags</span> <span class="code-attribute">w:val</span><span class="code-keyword">="</span><span class="code-keyword">off"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">w:docPr</span><span class="code-keyword">&gt;</span></pre>

<p>This means that the read-only mode can be easily incorporated into XSLT for reports you've already done... but, it also means that anyone knowing WML format can easily workaround your &quot;protection&quot;. So, use it wisely <img src="/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /> </p>

<h2>Preparing data and applying the transformation<a id="PreparingDataAndApplyingTransformation"></a></h2>

<h3><a id="T-SQLAndXML"></a>T-SQL and XML</h3>

<p>XML data that satisfies the previously defined schema and which we'll use in the report can be generated in many ways. The most commonly used is the one that utilizes the <code lang="xml">SELECT... FOR XML</code> command and data from SQL Server 2005 that directly translates into XML.</p>

<p><code lang="sql">SELECT... FOR XML</code> has two parameters:</p>

<ol>
<li>Work mode, chosen from <code lang="sql">RAW</code>, <code lang="sql">AUTO</code>, <code lang="sql">EXPLICIT</code>, and the <code lang="sql">PATH</code> array. In general, the <code lang="sql">AUTO</code> mode will finish the job; when extra formatting is needed, the <code lang="sql">PATH</code> mode is the choice.</li>

<li>Additional variables like <code lang="sql">ROOT</code> (add a <code>root</code> tag to XML), <code lang="sql">ELEMENTS</code> (format output data as elements), <code lang="sql">TYPE</code> (result is returned as <code lang="sql">XML</code> type of SQL Server 2005), and <code lang="sql">XMLSCHEMA</code> (write XML schema before data).</li>
</ol>

<p>For example, if there is a <em>c_City</em> table with columns <code>CityId</code> and <code>CityName</code>, and XML with element <code>City</code> is needed, the following T-SQL is required:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> CityId, CityName <span class="code-keyword">FROM</span> c_City <span class="code-keyword">AS</span> City
<span class="code-keyword">FOR</span> XML AUTO

&lt;City CityId=<span class="code-string">"</span><span class="code-string">43"</span> CityName=<span class="code-string">"</span><span class="code-string">100 Mile House"</span> /&gt;
&lt;City CityId=<span class="code-string">"</span><span class="code-string">53"</span> CityName=<span class="code-string">"</span><span class="code-string">Abbotsford"</span> /&gt;</pre>

<p>If it's needed to write out data in elements, the <code lang="sql">ELEMENTS</code> directive is added:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> CityId, CityName <span class="code-keyword">FROM</span> c_City <span class="code-keyword">AS</span> City
<span class="code-keyword">FOR</span> XML AUTO, ELEMENTS

&lt;City&gt;
  &lt;CityId&gt;43&lt;/CityId&gt;
  &lt;CityName&gt;100 Mile House&lt;/CityName&gt;
&lt;/City&gt;
&lt;City&gt;
  &lt;CityId&gt;53&lt;/CityId&gt;
  &lt;CityName&gt;Abbotsford&lt;/CityName&gt;
&lt;/City&gt;</pre>

<p>As two elements exist on the first level, <code>Root</code> tag must be added so that the XML is syntactically valid:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> CityId, CityName <span class="code-keyword">FROM</span> c_City <span class="code-keyword">AS</span> City
<span class="code-keyword">FOR</span> XML AUTO, ELEMENTS, ROOT(<span class="code-string">'</span><span class="code-string">Root'</span>)

&lt;Root&gt;
  &lt;City&gt;
    &lt;CityId&gt;43&lt;/CityId&gt;
    &lt;CityName&gt;100 Mile House&lt;/CityName&gt;
  &lt;/City&gt;
  &lt;City&gt;
    &lt;CityId&gt;53&lt;/CityId&gt;
    &lt;CityName&gt;Abbotsford&lt;/CityName&gt;
  &lt;/City&gt;
&lt;/Root&gt;</pre>

<p>Let's assume that there is a <em>c_PostalCode</em> table with postal codes used in cities. If it's required to make XML where postal codes will be child element of cities, the following SQL is in order:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> CityId, CityName,  
    (<span class="code-keyword">SELECT</span> PostalCodeId, PostalCodeName <span class="code-keyword">FROM</span> c_PostalCode
     <span class="code-keyword">WHERE</span> CityId = City.CityId
     <span class="code-keyword">FOR</span> XML AUTO, TYPE)        
<span class="code-keyword">FROM</span> c_City <span class="code-keyword">AS</span> City
<span class="code-keyword">FOR</span> XML AUTO, TYPE

&lt;Root&gt;
  &lt;City CityId=<span class="code-string">"</span><span class="code-string">43"</span> CityName=<span class="code-string">"</span><span class="code-string">100 Mile House"</span>&gt;
    &lt;c_PostalCode PostalCodeId=<span class="code-string">"</span><span class="code-string">317701"</span> PostalCodeName=<span class="code-string">"</span><span class="code-string">V0K2Z0"</span> /&gt;
    &lt;c_PostalCode PostalCodeId=<span class="code-string">"</span><span class="code-string">317702"</span> PostalCodeName=<span class="code-string">"</span><span class="code-string">V0K2E0"</span> /&gt;
  &lt;/City&gt;
  &lt;City CityId=<span class="code-string">"</span><span class="code-string">53"</span> CityName=<span class="code-string">"</span><span class="code-string">Abbotsford"</span>&gt;
    &lt;c_PostalCode PostalCodeId=<span class="code-string">"</span><span class="code-string">317703"</span> PostalCodeName=<span class="code-string">"</span><span class="code-string">V3G2J3"</span> /&gt;
  &lt;/City&gt;
&lt;/Root&gt;</pre>

<p>If more output flexibility is required, it's possible to format the XML in more detail using the <code lang="sql">PATH</code> mode. For example, if it's needed to hold <code>CityId</code> as an attribute, <code>CityName</code> as an element, and information about postal codes as child elements which <code>PostalCodeId</code> places in the <code>NotNeeded</code> sub element, use this T-SQL:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> CityId <span class="code-keyword">AS</span> <span class="code-string">'</span><span class="code-string">@CityId'</span>, CityName,  
    (<span class="code-keyword">SELECT</span> PostalCodeId <span class="code-keyword">AS</span> <span class="code-string">'</span><span class="code-string">NotNeeded/PostalCodeId'</span>, PostalCodeName 
     <span class="code-keyword">FROM</span> c_PostalCode
     <span class="code-keyword">WHERE</span> CityId = City.CityId
     <span class="code-keyword">FOR</span> XML path(<span class="code-string">'</span><span class="code-string">PostalCode'</span>), TYPE)        
<span class="code-keyword">FROM</span> c_City <span class="code-keyword">AS</span> City
<span class="code-keyword">FOR</span> XML PATH(<span class="code-string">'</span><span class="code-string">CityRow'</span>), type, root(<span class="code-string">'</span><span class="code-string">Data'</span>)

&lt;Data&gt;
  &lt;CityRow CityId=<span class="code-string">"</span><span class="code-string">43"</span>&gt;
    &lt;CityName&gt;100 Mile House&lt;/CityName&gt;
    &lt;PostalCode PostalCodeName=<span class="code-string">"</span><span class="code-string">V0K2Z0"</span>&gt;
      &lt;NotNeeded&gt;
        &lt;PostalCodeId&gt;317701&lt;/PostalCodeId&gt;
      &lt;/NotNeeded&gt;
    &lt;/PostalCode&gt;
    &lt;PostalCode PostalCodeName=<span class="code-string">"</span><span class="code-string">V0K2E0"</span>&gt;
      &lt;NotNeeded&gt;
        &lt;PostalCodeId&gt;317702&lt;/PostalCodeId&gt;
      &lt;/NotNeeded&gt;
    &lt;/PostalCode&gt;
  &lt;/CityRow&gt;
  &lt;CityRow CityId=<span class="code-string">"</span><span class="code-string">53"</span>&gt;
    &lt;CityName&gt;Abbotsford&lt;/CityName&gt;
    &lt;PostalCode PostalCodeName=<span class="code-string">"</span><span class="code-string">V3G2J3"</span>&gt;
      &lt;NotNeeded&gt;
        &lt;PostalCodeId&gt;317703&lt;/PostalCodeId&gt;
      &lt;/NotNeeded&gt;
    &lt;/PostalCode&gt;
  &lt;/CityRow&gt;
&lt;/Data&gt;</pre>

<h3><a id="BindingXMLToSchema"></a>Binding XML to schema</h3>

<p>For the XML data to be shown in Word, it's necessary that the <code>xmlns</code> attribute of the root tag points to the appropriate schema. To be precise – in our example, to show the XML data in the generated Word document, it's not enough to provide just the following output from SQL:</p>

<pre lang="sql"><span class="code-keyword">SELECT</span> Buyer, InvoiceDate, ...
<span class="code-keyword">FROM</span> Invoice
<span class="code-keyword">FOR</span> XML PATH(<span class="code-string">'</span><span class="code-string">Invoice'</span>), ELEMENTS

&lt;Invoice&gt;
    &lt;Buyer&gt;John Doe&lt;/Buyer&gt;
    &lt;InvoiceDate&gt;2008-01-01&lt;/InvoiceDate&gt;
    ...
&lt;/Invoice&gt;</pre>

<p>It's needed to set the <code>xmlns</code> attribute in such a manner to point to the <code>targetNamespace</code> of the <em>WordGeneratedInvoice.xsd</em> schema:</p>

<pre lang="sql"><span class="code-keyword">WITH</span> XMLNAMESPACES(<span class="code-keyword">DEFAULT</span> 
   <span class="code-string">'</span><span class="code-string">http://schemas.microsoft.com/GeneratingWordDocuments/WordGeneratedInvoice.xsd'</span>)
<span class="code-keyword">SELECT</span> Buyer, InvoiceDate, ...
<span class="code-keyword">FROM</span> Invoice 
<span class="code-keyword">FOR</span> XML PATH(<span class="code-string">'</span><span class="code-string">Invoice'</span>), ELEMENTS

&lt;Data xmlns=<span class="code-string">"</span><span class="code-string">http://schemas.microsoft.com/GeneratingWordDocuments/WordGeneratedInvoice.xsd"</span>&gt;
    &lt;Buyer&gt;John Doe&lt;/Buyer&gt;
    &lt;InvoiceDate&gt;2008-01-01&lt;/InvoiceDate&gt;
    ...
&lt;/Invoice&gt;</pre>

<p>A blank Word document is the most common result if the XML data is not bound to the schema over an <code>xmlns</code> attribute.</p>

<h2><a id="ApplianceOfTransformationOnXMLData"></a>Applying the transformation on XML data</h2>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">byte</span>[] GetWord(XmlReader xmlData, XmlReader xslt)
{
    XslCompiledTransform xslt = <span class="code-keyword">new</span> XslCompiledTransform();
    XsltArgumentList args = <span class="code-keyword">new</span> XsltArgumentList();

    <span class="code-keyword">using</span> (MemoryStream swResult = <span class="code-keyword">new</span> MemoryStream())
    {
        xslt.Load(xslt);
        xslt.Transform(xmlData, args, swResult);

        <span class="code-keyword">return</span> swResult.ToArray();
    }
}</pre>

<p>It's mentioned earlier that this step is trivial. The example justifies that, doesn't it?</p>

<p>After the XML data and the XSL transformation are passed as <code>XmlReader</code> objects, an <code>XslCompiledTransform</code> is initialized through the <code>Load</code> method. All that is left is to call <code>Transform</code> to finish the job.</p>

<h2><a id="TheEasyWayOut"></a>XML-&gt;XSLT-&gt;HTML-&gt;Word, the easy way out</h2>

<p>In case you don't need advanced capabilities that Word provides (page numbering, margins, and similar), you have a pretty handy option of hand-writing XSLT that transforms XML data to HTML and then just opens HTML in Word.</p>

<p>To illustrate the idea with an example – here is an XSLT that I use for a list report that just shows the contents of a CD <code>DataTable</code> with two columns, <code>Title</code> and <code>Price</code>:</p>

<pre lang="xml"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span> <span class="code-summarycomment">version</span><span class="code-keyword">='</span><span class="code-keyword">1.0'</span> <span class="code-summarycomment">encoding</span><span class="code-keyword">='</span><span class="code-keyword">UTF-8'</span> <span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:stylesheet</span> <span class="code-attribute">xmlns:xsl</span><span class="code-keyword">='</span><span class="code-keyword">http://www.w3.org/1999/XSL/Transform'</span> <span class="code-attribute">version</span><span class="code-keyword">='</span><span class="code-keyword">1.0'</span> 
<span class="code-attribute">xmlns:fo</span><span class="code-keyword">='</span><span class="code-keyword">http://www.w3.org/1999/XSL/Format'</span> 
<span class="code-attribute">xmlns:fn</span><span class="code-keyword">='</span><span class="code-keyword">http://www.w3.org/2003/11/xpath-functions'</span> 
<span class="code-attribute">xmlns:xf</span><span class="code-keyword">='</span><span class="code-keyword">http://www.w3.org/2002/08/xquery-functions'</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:template</span> <span class="code-attribute">match</span><span class="code-keyword">='</span><span class="code-keyword">/'</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">html</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">body</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>Report Header<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">table</span> <span class="code-attribute">border</span><span class="code-keyword">='</span><span class="code-keyword">0'</span> <span class="code-attribute">width</span><span class="code-keyword">='</span><span class="code-keyword">100%'</span><span class="code-keyword">&gt;</span>
                    <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span> <span class="code-attribute">bgcolor</span><span class="code-keyword">='</span><span class="code-keyword">Gray'</span><span class="code-keyword">&gt;</span>
                        <span class="code-keyword">&lt;</span><span class="code-leadattribute">th</span> <span class="code-attribute">align</span><span class="code-keyword">='</span><span class="code-keyword">left'</span><span class="code-keyword">&gt;</span>Title<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">th</span><span class="code-keyword">&gt;</span>
                        <span class="code-keyword">&lt;</span><span class="code-leadattribute">th</span> <span class="code-attribute">align</span><span class="code-keyword">='</span><span class="code-keyword">left'</span><span class="code-keyword">&gt;</span>Price<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">th</span><span class="code-keyword">&gt;</span>
                    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                    <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:for-each</span> <span class="code-attribute">select</span><span class="code-keyword">='</span><span class="code-keyword">DocumentElement/Cd'</span><span class="code-keyword">&gt;</span>
                        <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                            <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                                <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">='</span><span class="code-keyword">Title'</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
                            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                            <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                                <span class="code-keyword">&lt;</span><span class="code-leadattribute">xsl:value-of</span> <span class="code-attribute">select</span><span class="code-keyword">='</span><span class="code-keyword">Price'</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
                            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:for-each</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">table</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">body</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">html</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:template</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">xsl:stylesheet</span><span class="code-keyword">&gt;</span></pre>

<p>The XML data which is transformed:</p>

<pre lang="xml"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span> <span class="code-summarycomment">version</span><span class="code-keyword">='</span><span class="code-keyword">1.0'</span> <span class="code-summarycomment">encoding</span><span class="code-keyword">='</span><span class="code-keyword">UTF-8'</span> <span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">DocumentElement</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>Mike<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>20$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>Nike<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>30$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>Reebok<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Title</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>40$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Price</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Cd</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">DocumentElement</span><span class="code-keyword">&gt;</span></pre>

<p>When the <code lang="xml">xsl:template</code> tag is matched (and it'll be matched always because it points to root), its <code>InnerText</code> is evaluated. The <code lang="xml">xsl:for-each</code> tag processes each of the <code>DocumentElement</code>/<code>Cd</code> nodes, and <code lang="xml">xsl:value-of</code> gets the <code>InnerText</code> of the XPath selected element. In case you're not too good with XSLT, I recommend this webpage: <a href="http://www.w3schools.com/xsl/default.asp" target="_blank">W3Schools</a>. W3Schools, you rock! <img src="/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /> </p>

<p>Resulting HTML:</p>

<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">html</span> <span class="code-attribute">xmlns:fo</span><span class="code-keyword">="</span><span class="code-keyword">http://www.w3.org/1999/XSL/Format"</span> 
<span class="code-attribute">xmlns:fn</span><span class="code-keyword">="</span><span class="code-keyword">http://www.w3.org/2003/11/xpath-functions"</span> 
<span class="code-attribute">xmlns:xf</span><span class="code-keyword">="</span><span class="code-keyword">http://www.w3.org/2002/08/xquery-functions"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">body</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>Something<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">table</span> <span class="code-attribute">border</span><span class="code-keyword">="</span><span class="code-keyword">0"</span> <span class="code-attribute">width</span><span class="code-keyword">="</span><span class="code-keyword">100%"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span> <span class="code-attribute">bgcolor</span><span class="code-keyword">="</span><span class="code-keyword">Gray"</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">th</span> <span class="code-attribute">align</span><span class="code-keyword">="</span><span class="code-keyword">left"</span><span class="code-keyword">&gt;</span>Title<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">th</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">th</span> <span class="code-attribute">align</span><span class="code-keyword">="</span><span class="code-keyword">left"</span><span class="code-keyword">&gt;</span>Price<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">th</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>Mike<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>20$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>Nike<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>30$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>Reebok<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>40$<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">td</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">tr</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">table</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">body</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">html</span><span class="code-keyword">&gt;</span></pre>

<p>Word, even in versions earlier than 2003, had no any problems with opening HTML; so, just save the result as <em>.doc</em> (instead of <em>.HTML</em>) and you'll be done. In case you are sending the response over the Web, you can specify the type with:</p>

<pre lang="cs">Response.AddHeader(<span class="code-string">"</span><span class="code-string">content-type"</span>, <span class="code-string">"</span><span class="code-string">application/msword"</span>);
Response.AddHeader(<span class="code-string">"</span><span class="code-string">Content-Disposition"</span>, <span class="code-string">"</span><span class="code-string">attachment; filename=report.doc"</span>);</pre>

<p>The true value of this option comes into light when you start thinking about generic reports. In the source code that accompanies this article, you'll find a generic version of this example, the one that works with any <code>DataTable</code>. Be sure to check it.</p>

<h2><a id="OrganizationOfResources"></a>Organization of resources used for the generation in the Visual Studio project</h2>

<p>The source code I have attached to this article demonstrates one possible way of organizing the needed resources for the Word reports generation. Here is the project structure:</p>

<p><img width="576" hspace="0" height="399" border="1" alt="Figure 11 - XSL transform as part of VS.NET project for generating Word reports" src="/KB/office/Generating_Word_Reports/figure9.jpg" /></p>

<div class="caption">Figure 11 - XSL transform as part of the VS.NET project for generating Word reports</div>

<p>It is of utmost importance that Embedded Resource is set on the Build Action for all the resources that are used in the generation of the Word document (XML, XSD, XSLT). This enables their later fetching from the resource collection of the compiled DLL.</p>

<p>Reports are generated through a static <code>Report</code> class which represents the facade to embedded resources and the logic exploiting them:</p>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> Report
{
    <span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span>    <span class="code-summarycomment">///</span><span class="code-comment"> Generates Demonstration Report
</span>    <span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span>    <span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">returns</span><span class="code-summarycomment">&gt;</span>Resulting Word document as Byte array<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/</span><span class="code-summarycomment">returns</span><span class="code-summarycomment">&gt;</span>
</span>    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">byte</span>[] WordGeneratedInvoice()
    {
        <span class="code-comment">//</span><span class="code-comment"> Get data as XML... for demonstration prepared XML is used,
</span>
        <span class="code-comment">//</span><span class="code-comment"> in real implementation scenario this data would be 
</span>
        <span class="code-comment">//</span><span class="code-comment"> fetched from SQL Server
</span>
        <span class="code-keyword">string</span> xmlData = Getters.GetTestXml(<span class="code-string">"</span><span class="code-string">WordGeneratedInvoice"</span>);
        <span class="code-keyword">return</span> Getters.GetWord(xmlData, <span class="code-string">"</span><span class="code-string">WordGeneratedInvoice"</span>);
    }

    <span class="code-comment">//</span><span class="code-comment"> ... //
</span>

    <span class="code-comment">/*</span><span class="code-comment"> Add Report methods here */</span>

}</pre>

<p>Adding new reports in this structure is easy:</p>

<ul>
<li>The new report for generation is added in the <em>Doc</em> directory.</li>

<li>The XML schema which is created based on the report is added in the <em>Xsd</em> directory.</li>

<li>After the schema is applied on the document, the saved WordML is used as the input in the WML2XSLT tool; the resulting XSLT is placed in the <em>Xslt</em> directory.</li>

<li>A method is added in the <code>Report</code> class which is responsible for fetching XML data, invoking the transformation, and returning the resulting Word document.</li>
</ul>

<h2><a id="FAQ"></a>FAQ</h2>

<h4>Can I convert the generated WordML to PDF? How do I do it?</h4>

<p>Check out my article <a href="http://www.codeproject.com/KB/files/generatepdf.aspx" target="_blank">Generate PDF using C#</a>.</p>

<h4>I applied the schema to the Word document and ended my work on it. After some time, I reopened the document, but in the XML structure dialog, the list of elements available for applying onto the document (the lower listbox) is empty.</h4>

<p>This occurred because the path to the XSD file is changed. The location of the schema can be refreshed by using XML Options -&gt; Schema Library -&gt; choose the schema used in the document -&gt; Schema Settings -&gt; Browse...</p>

<p><img width="595" hspace="0" height="390" border="1" alt="Figure 12 – Dialogs (from left to right) that visualy show path to Browse... option" src="/KB/office/Generating_Word_Reports/figure10.jpg" /></p>

<div class="caption">Figure 12 – Dialogs (ordered from left to right) that visually show the path to the Browse... option</div>

<h4>I've changed the XML schema (XSD) after the changed request for the new report fields arrived. However, Word 2003 does not show new fields in the XML structure dialog, so I can't bind them to the data in the new version of the report. Must I build the report from scratch?</h4>

<p>This problem can be solved by installing the Office 2003 Service Pack 2. When SP2 is installed, Word 2003 will refresh the attached schema if the following steps are satisfied:</p>

<ul>
<li>Schema is changed, XSD file is saved</li>

<li>All instances of Word 2003 are closed (not only the document which uses the mentioned schema!)</li>

<li>Reopen the Word document that uses the schema</li>
</ul>

<p>In some situations, the better way to solve this problem is to install the XML Toolbox for Microsoft Office Word 2003 – it adds the command <em>Refresh Schema</em>. The solution isn't universal because the XML Toolbox doesn't install properly always (the most common problems are security polices, the existence of .NET Framework 1.1...). So, my suggestion is to close all Office applications, download the <em>.msi</em> from the link, run it – if everything goes smoothly, you'll see the Word XML toolbar (View -&gt; Toolbars -&gt; Word XML Toolbar); if not, you always have the first suggestion for schema refreshing.</p>

<p><img width="372" hspace="0" height="128" border="1" alt="Figure 13 - XML Toolbox in Word 2003, with Reload Schema option" src="/KB/office/Generating_Word_Reports/figure11.jpg" /></p>

<div class="caption">Figure 13 - XML Toolbox in Word 2003, with the Reload Schema option</div>

<h4>I made the XSD, bound it to the Word document, made the XSLT, prepared the XML data, performed the transformation, and got – empty document</h4>

<p>The most common cause of this problem is that XML doesn't contain the schema binding (as a value of the <code>xmlns</code> attribute of the root tag). Read the <a href="#BindingXMLToSchema">Binding XML to schema</a> chapter.</p>

<p>The easiest way to see the type of XML you should prepare is to get the properly schema and fields bounded Word document to be saved on the some temporary location as the XML (File -&gt; Save as, Save as type: XML document), by checking the option <em>Save data only</em>. You can view the saved XML by opening it in Visual Studio .NET or Notepad...</p>

<p><img width="423" hspace="0" height="275" border="1" alt="Figure 14 – Saving XML data only from properly mapped Word document" src="/KB/office/Generating_Word_Reports/figure12.jpg" /></p>

<div class="caption">Figure 14 – Saving the XML data only from properly mapped Word document</div>

<h4>Where are the XML options located in Office Word 2007? How different is report making between Word 2003 and 2007?</h4>

<p>Honestly, I haven't worked much in the 2007 version of Word, but still - I couldn't find big differences. The only problem I've had is in finding the XML Structure dialog, as it was not accessible with the Task Pane. It seems that the XML Toolbox is installed by default with Office 2007, so you can solve this by its adding by using the toolbar's (Ribbon's) option, <em>Customize...</em></p>

<p><img width="577" hspace="0" height="470" border="1" alt="Figure 15 – Dialog shown after choosing option Customize... in Word 2007" src="/KB/office/Generating_Word_Reports/figure13.jpg" /></p>

<div class="caption">Figure 15 – Dialog shown after choosing the option Customize... in Word 2007</div>

<p><img width="296" hspace="0" height="111" border="1" alt="Figure 16 - XML Toolbox in Word 2007" src="/KB/office/Generating_Word_Reports/figure14.jpg" /></p>

<div class="caption">Figure 16 - XML Toolbox in Word 2007</div>

<h2><a id="Conclusion"></a>Conclusion</h2>

<p>It is worthy to note that the solution I recommended doesn't use Visual Studio Tools for Office. I tried them out for document generation, and was very disappointed as they required a nasty deal of configuring both to develop and run.</p>

<p>Also, using XSLT to produce Word documents is far easier than juggling with the Microsoft Word Object Library COM DLL and its <code>Word.Application</code> class; not to mention that it is way faster and memory leak free. If you are using a COM DLL for generating Word files, I would advise you to start rewriting that part of your system right now, especially if you are generating documents on the server and then sending them to clients. Simply, Word was developed to be an interactive user application and not a &quot;visible = false&quot; puppet of another process.</p>

<p>Well, that's it folks. You know the drill - please take your time to rate this article, and if you are (un)happy with it or just need some aid, post comments and I'll be glad to respond/help in no time <img src="/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /> .</p>

<h2><a id="References"></a>References</h2>

<p>In no particular order…</p>

<p>Books:</p>

<ul>
<li><a href="http://www.amazon.com/gp/product/0321411757?ie=UTF8&amp;tag=codeproject-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321411757">Eric Carter, Eric Lippert, &quot;Visual Studio Tools for Office: Using C# with Excel, Word, Outlook, and Infopath&quot; (2005)</a><img width="1" height="1" border="0" style="border: medium none  ! important; margin: 0px ! important;" src="http://www.assoc-amazon.com/e/ir?t=codeproject-20&amp;l=as2&amp;o=1&amp;a=0321411757" class=" hcqqlubfvcxalxkcgzwb hcqqlubfvcxalxkcgzwb" />
</li>

<li><a href="http://www.amazon.com/gp/product/1590596889?ie=UTF8&amp;tag=codeproject-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1590596889">Kevin Goff, Rod Paddock, &quot;Pro VS 2005 Reporting Using SQL Server and Crystal Reports&quot; (2006)</a><img width="1" height="1" border="0" style="border: medium none  ! important; margin: 0px ! important;" src="http://www.assoc-amazon.com/e/ir?t=codeproject-20&amp;l=as2&amp;o=1&amp;a=1590596889" class=" hcqqlubfvcxalxkcgzwb hcqqlubfvcxalxkcgzwb" />
</li>

<li>WordML Image specs - <a href="http://dave.thielen.com/articles/The%20WordML%20Spec.htm" target="_blank">Dave Thielen</a> and <a href="http://www.tkachenko.com/blog/archives/000106.html" target="_blank">Oleg Tkachenko blogs</a></li>
</ul>

<h2>History<a id="History"></a></h2>

<ul>
<li>February 17, 2008 - Added the multiple images example (<a href="?fid=454670&amp;select=2429336#xx2429336xx">this comment initiated it</a>).</li>

<li>November 4, 2007 - Added the image example (<a href="?df=100&amp;forumid=454670&amp;select=2295326#xx2295326xx">this comment initiated it</a>).</li>

<li>October 17, 2007 – Added the grouping example (<a href="?df=100&amp;forumid=454670&amp;select=2276033#xx2276033xx">this comment initiated it</a>).</li>

<li>September 13, 2007 – Added the read-only section, added one more example (<a href="?df=100&amp;forumid=454670&amp;mpp=50&amp;select=2225892#xx2225892xx">this comment initiated it</a>).</li>

<li>August 31, 2007 – Initial version of the article.</li>
</ul>


						</div>
						

						
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						<div class="float-right" style="margin:20px 0 0 0;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Word"  data-loadOnView='true'  data-tags='.NET2.0, SQL-server-2005, VS2005, C#2.0, XML, SQL, Windows, HTML, DBA, Dev, XSLT, Intermediate,rating4.5'></div>
						</div>

						
						<h2 id="ctl00_AboutHeading">About the Author</h2>
						

<div class="container">
<div style="width:210px;overflow:hidden;float:left;text-align:center">
	<img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="http://s.codeproject.com/script/Membership/Images/member_unknown.gif" border="0" style="transform:rotate(2deg);" />
</div>
<div class="container-member float-left" style="width:235px">
	<b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/lepipele">Predrag Tomasevic</a></b>
	<div class="company">
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Chief Technology Officer</span>
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany">Atama Group</span> 
		<br /><span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="/script/Geo/Images/US.gif" alt="United States" width="16px" height="11px" /></span>
	</div>
</div>
	
<div class="padded-top float-left clearfix" style="width:600px">
	http://www.linkedin.com/in/ptomasevic<br />
&nbsp;<br />
Bitcoin wallet: 1ARXmh58S6aRiZPCbneDCzrB1HUU6PLmDQ

	

	
</div>
</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							<a class="anchorLink" href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&df=90&mpp=25&sort=Position&spc=Relaxed&select=4154361&tid=3561734#_articleTop">Article Top</a>
						</div>

						
						<div style="margin:auto;height:90px;margin-top:10px" class="sticky-stop"> 
							<div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Word"  data-loadOnView='true'  data-tags='.NET2.0, SQL-server-2005, VS2005, C#2.0, XML, SQL, Windows, HTML, DBA, Dev, XSLT, Intermediate,rating4.5,pos_bottom'></div>
						</div>
						
					

				    
					</form>

				</div>

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return SwitchMessage(event, null)">
	<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
		<tr>
			<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
				<tr class="navbar">
					<td></td><td align="right" width="50%"><a href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;noise=3&amp;prof=True&amp;view=Normal"><b>View All Threads</b></a></td><td align="right" nowrap="nowrap"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
				</tr>
			</table></td>
		</tr><tr>
			<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
				<tr>
					<td><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
				</tr><tr id="F3561734_h0" class="header hover-row root">
					<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
						<tr>
							<td width="20px" class="indent"><a name="xx3561734xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="subject hover-container"><a class="message-link" name="3561734" parent="0" thread="3561734" href="/Messages/3561734/Generating-Word-Reports-Documents.aspx">Generating Word 2007 Reports / Documents</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a></td><td class="icon"><img border="0" src="http://s.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px" /></td><td class="author"><a href="/script/Membership/View.aspx?mid=4168913">fazaza</a></td><td class="date">10-Aug-10  21:53&nbsp;</td>
						</tr>
					</table></td>
				</tr><tr id="F3561734_h1" class="content root selected" style="display:none;">
					<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
						<tr valign="top">
							<td class="indent align-right" width="20"><div class="voteform vertical" ownerid="4168913" msgid="3561734" votingType="GoodOrBad">

							</div><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tr>
											<td colspan="2">this is greate article , and it is make me shift to Word to creating reports instead of SQL reporting service or crystal report.<br />
&nbsp;<br />
i post Article called Generating Word 2007 Reports / Documents<br />
&nbsp;<br />
to handle the same issue using word 2007<br />
&nbsp;<br />
<a href="http://www.codeproject.com/KB/docview/Ahmad_Ramadan.aspx">Generating Word 2007 Reports / Documents</a>[<a href="http://www.codeproject.com/KB/docview/Ahmad_Ramadan.aspx" target="_blank" title="New Window">^</a>]<br /></td>
										</tr>
									</table></td>
								</tr>
							</table></td>
						</tr>
					</table></td>
				</tr><tr>
					<td><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
				</tr>
			</table></td>
		</tr><tr>
			<td><table width="100%" cellpadding="2px" cellspacing="0">
				<tr class="footer">
					<td>Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 23-Jul-14  14:14</td><td><a href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734&amp;noise=3&amp;prof=True&amp;view=Normal">Refresh</a></td><td align="right" nowrap="nowrap"><input id="_mbnUrl" type="hidden" value="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734&amp;noise=3&amp;prof=True&amp;view=Normal&amp;fr=2" /><span class="nav-link selected">1</span></td>
				</tr>
			</table></td>
		</tr>
	</table><p class="small-text"><img align="top" src="/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			
		</td>
		<td>
			<div id="ctl00_RightSideBar" class="container-article-info">

				<div class="header">About Article</div>
				<div class="article-summary">

					
					

					
					

					<a id="ctl00_InfoBox_ParentLink"></a>

<table cellpadding="0" cellspacing="0" class="article-info">

	
	<tr><td>Type&nbsp;</td><td class="value"><a id="ctl00_InfoBox_TypeName" href="/script/Articles/Types.aspx?#Article">Article</a></td></tr>
	

	<tr><td>Licence&nbsp;</td><td class="value"><a href="http://www.codeproject.com/info/cpol10.aspx" title="The Code Project Open License (CPOL)">CPOL</a></td></tr>

	

	<tr><td>First Posted&nbsp;</td><td nowrap="nowrap" class="value"><span itemprop="datePublished" content="2007-08-30">30 Aug 2007</span></td></tr>

	<tr><td>Views&nbsp;</td><td class="value">372,966</td></tr>

	
	<tr><td>Downloads&nbsp;</td><td  class="value">4,560</td></tr>
		

	
	<tr><td>Bookmarked&nbsp;</td><td class="value">531 times</td></tr>
	

	

	
	
	
	<tr><td colspan="2"></td>
	</tr>
	
	
</table>

					<div class="tags"> 
					<span id="ctl00_TagsList_TagWrp" class="tags">
	
	
	
	<span id="ctl00_TagsList_VisibleTags"><span class="t"><a rel="tag" href="/Tags/.NET2.0">.NET2.0</a></span> <span class="t"><a rel="tag" href="/Tags/SQL-server-2005">SQL-server-2005</a></span> <span class="t"><a rel="tag" href="/Tags/VS2005">VS2005</a></span> <span class="t"><a rel="tag" href="/Tags/C--hash--2.0">C#2.0</a></span> <span class="t"><a rel="tag" href="/Tags/XML">XML</a></span> <span class="t"><a rel="tag" href="/Tags/SQL">SQL</a></span> <span class="t"><a rel="tag" href="/Tags/Windows">Windows</a></span> <span class="t"><a rel="tag" href="/Tags/HTML">HTML</a></span> <span class="t"><a rel="tag" href="/Tags/DBA">DBA</a></span> <span class="t"><a rel="tag" href="/Tags/Dev">Dev</a></span> </span><acronym id="ctl00_TagsList_HiddenTags" title="plus: XSLT, Intermediate">, +</acronym> 

	
	
</span>

					</div>

					
				</div>

				<div style="width:160px;margin: 10px auto;">
					<div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Word"  data-tags='.NET2.0, SQL-server-2005, VS2005, C#2.0, XML, SQL, Windows, HTML, DBA, Dev, XSLT, Intermediate,rating4.5'></div>
				</div>

				

				

                
				<div class="padded-top">
					
	<div id="ctl00_RelatedArticles_RelatedResults_ctl00_header" class="header">Related Articles</div>
	<div class="content-list">	
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl01_Link" class="title" href="/Articles/7341/Dynamically-generate-a-MS-Word-document-using-HTML">Dynamically generate a MS Word document using HTML & CSS</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl03_Link" class="title" href="/Articles/35221/Understanding-the-Why-What-and-How-of-Reporting-So">Understanding the Why, What, and How of Reporting Solutions: Reporting 101</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl04_Link" class="title" href="/Articles/759408/Creating-Word-documents-in-Net-using-Docentric-Too">Creating Word documents in .Net using Docentric Toolkit</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl05_Link" class="title" href="/Articles/12098/Term-frequency-Inverse-document-frequency-implemen">Term frequency/Inverse document frequency implementation in C#</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl06_Link" class="title" href="/Articles/96191/A-SOA-Approach-to-Dynamic-DOCX-PDF-Report-Generati">A SOA Approach to Dynamic DOCX-PDF Report Generation - Part 1</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl07_Link" class="title" href="/Articles/11252/Gios-WORD-NET-Library-using-RTF-specification">Gios WORD .NET Library (using RTF specification)</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl08_Link" class="title" href="/Articles/15004/Create-simple-Word-documents-without-needing">Create simple Word 2007 documents without needing Word 2007 installed</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl09_Link" class="title" href="/Articles/12414/Yet-another-way-to-Generate-Excel-documents-progra">Yet another way to Generate Excel documents programmatically</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl10_Link" class="title" href="/Articles/5277/NetSpell-Spell-Checker-for-NET">NetSpell - Spell Checker for .NET</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl11_Link" class="title" href="/Articles/194097/SSRS-Series-Part-I-Various-ways-of-Report-creation">SSRS Series Part I: Various ways of Report creation, deployment and invocation</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl12_Link" class="title" href="/Tips/145780/A-SOA-approach-to-dynamic-DOCX-PDF-report-genera">A SOA approach to dynamic DOCX-PDF report generation - Part 2</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl13_Link" class="title" href="/Articles/9772/Report-Generator">Report Generator</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl14_Link" class="title" href="/Articles/38575/Fill-Mergefields-in-docx-Documents-without-Microso">Fill Mergefields in .docx Documents without Microsoft Word</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl15_Link" class="title" href="/Articles/16964/An-alternative-way-to-MSWord-Render-extension-of-S">An alternative way to the MSWord Render extension of SQL Reporting Services using XSLT and XML document mapping</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl16_Link" class="title" href="/Articles/10582/rtflib-v">rtflib v1.0</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl17_Link" class="title" href="/Articles/11082/C-and-XML-Source-Code-Documentation">C# and XML Source Code Documentation</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl18_Link" class="title" href="/Articles/28662/Adding-DOC-RTF-and-OOXML-Export-Formats-to-the-M">Adding DOC, RTF, and OOXML Export Formats to the Microsoft Report Viewer Control: Implementing It Easier Using Private Reflection</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl19_Link" class="title" href="/Articles/32546/Reporting-Embed-dotnet-code-in-MS-Word-files">Reporting: Embed dotnet code in MS Word files</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl20_Link" class="title" href="/Articles/260470/PDF-reporting-using-ASP-NET-MVC">PDF reporting using ASP.NET MVC3</a>
		
	</div>
	
	<div class="content-list-item">
		<a id="ctl00_RelatedArticles_RelatedResults_ctl21_Link" class="title" href="/Articles/15024/Crystal-Reports-helper-class">Crystal Reports helper class</a>
		
	</div>
	
	</div>
	

				</div>
				<div class="padded-top">
					
	<div id="ctl00_RelatedLibrary_RelatedResults_ctl00_header" class="header">Related Research</div>
	<div class="content-list align-center">	
	
	<div class="content-list-item">
		<div><img id="ctl00_RelatedLibrary_RelatedResults_ctl01_Thumb" class="shadow" src="/script/ResearchLibrary/Logos/LibraryItemThumbnail_73_100x77.png" border="0" /></div>
		<a id="ctl00_RelatedLibrary_RelatedResults_ctl01_Link" class="title" href="/ResearchLibrary/73/A-Perfect-Launch-Every-Time-Steps-to-Avoid-the-Wor">A Perfect Launch Every Time: 7 Steps to Avoid the Worst Day Of Your Career</a>
		
	</div>
	
	<div class="content-list-item">
		<div><img id="ctl00_RelatedLibrary_RelatedResults_ctl02_Thumb" class="shadow" src="/script/ResearchLibrary/Logos/LibraryItemThumbnail_72_100x81.png" border="0" /></div>
		<a id="ctl00_RelatedLibrary_RelatedResults_ctl02_Link" class="title" href="/ResearchLibrary/72/How-to-Apply-Changes-to-Your-DB-Database-with-Mini">How to Apply Changes to Your DB2 Database with Minimal Risk</a>
		
	</div>
	
	<div class="content-list-item">
		<div><img id="ctl00_RelatedLibrary_RelatedResults_ctl03_Thumb" class="shadow" src="/script/ResearchLibrary/Logos/LibraryItemThumbnail_71_100x118.png" border="0" /></div>
		<a id="ctl00_RelatedLibrary_RelatedResults_ctl03_Link" class="title" href="/ResearchLibrary/71/Data-Modeling-for-Effective-Data-Warehousing-and-B">Data Modeling for Effective Data Warehousing and Business Intelligence</a>
		
	</div>
	
	<div class="content-list-item">
		<div><img id="ctl00_RelatedLibrary_RelatedResults_ctl04_Thumb" class="shadow" src="/script/ResearchLibrary/Logos/LibraryItemThumbnail_69_100x61.png" border="0" /></div>
		<a id="ctl00_RelatedLibrary_RelatedResults_ctl04_Link" class="title" href="/ResearchLibrary/69/Toad-Oracle-Tips-to-Simplify-Database-Administrati">Toad Oracle: Tips to Simplify Database Administration and Development</a>
		
	</div>
	
	</div>
	

				</div>

				
				
			</div>
		</td>
		</tr></table>

		
		<div class="theme1-background" style="height:2px"></div>

		<div class="extended tiny-text">
			<div class="row">
				<div class="float-left">
					<a id="ctl00_PermaLink" itemprop="url" href="/Articles/20287/Generating-Word-Reports-Documents">Permalink</a> | 
					<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> |
					<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a> |
					<a id="ctl00_Mobile" rel="nofollow" href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734&amp;display=Mobile">Mobile</a>
					<br />
								
					
					Web04 |
					2.8.140721.1 |
					Last Updated 4 Oct 2009								
				</div>
				<div class="float-right align-right">
					Article Copyright 2007 by Predrag Tomasevic<br />Everything else
					Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2014 <br />
					<a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Service</a>
				</div>

				


<div class="page-width">
Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734&amp;PageFlow=FixedWidth">fixed</a>
|
<a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/20287/Generating-Word-Reports-Documents?fid=454670&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;select=4154361&amp;tid=3561734&amp;PageFlow=Fluid">fluid</a>
</div>



			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div>
</div>


<div style="display:none;" id="dm_AdTable">
	
</div>






<script type="text/javascript" language="Javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script><script type='text/javascript'>//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/script/JS/jquery-1.6.2.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript" src="http://s.codeproject.com/script/Articles/JS/article.min.js?dt=2.8.140721.1"></script>
<script type="text/javascript" language="Javascript" src="http://s.codeproject.com/script/JS/navbar.min.js?dt=2.8.140721.1"></script>
<script type="text/javascript" language="Javascript" src="http://s.codeproject.com/script/Membership/JS/Notifications.min.js?dt=2.8.140721.1"></script>
<script type="text/javascript" language="Javascript" src="/Script/Membership/JS/MemberProfilePopup.min.js?v=1.3"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function() { anchorAnimate(); });
$(document).ready(function() {   $('.alert-bar').fadeIn('slow');   $('.alert-bar a.close-notify').click(function() {      $('.alert-bar').fadeOut('fast');        return false;    });});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide();
  sbar.blur(function() {
 if (!oSrchFlt)sfilter.hide();
 srchBoxFoc=false;
 /*sbar.animate( { width:'210px' }, { queue:false, duration:300 });
*/ });
  sbar.focus(function() {
 oSrchFlt=false;srchBoxFoc=true;
 sfilter.show();
 /*sbar.animate( { width:'500px' }, { queue:false, duration:300 });
*/ });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox)sfilter.hide();});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(20287,2,1,true,true,3,'LargeStars');
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {   new starRating('#ctl00_RateArticle_VoteFormDiv', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(20287,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');  })})
$(document).ready(function() { $('#ctl00_RateArticle_SubmitRateBtn').hide(); });
$(document).ready(function() { $('#ctl00_RateArticle_SubmitRateBtn').hide(); });function ChkRtctl00_RateArticle(){}

forumDir = '/script/Forums/';
staticServer = 'http://s.codeproject.com';
allowReporting = false;
allowRating = false;
allowRatingDisplay = true;
var smoothScroll = true;
Selected        = 4154361;
oldTitle        = document.title;
minMessageScore = 1;
minMessageScore = 5;
abuseScore      = -2;
spamScore       = -1;
getRatingUrl    = '/script/Ratings/Ajax/GetRatings.aspx';
noiseThreshold  = 3;
getRatingRefKey = 'obrs';


//]]>
</script>


</body>
</html>
