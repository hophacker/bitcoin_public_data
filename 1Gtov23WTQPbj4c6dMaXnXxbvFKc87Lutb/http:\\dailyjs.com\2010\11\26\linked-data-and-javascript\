http://dailyjs.com/2010/11/26/linked-data-and-javascript/
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 01:38:24 GMT
Server: Apache/2.2.16 (Debian) DAV/2 SVN/1.6.12 PHP/5.3.3-7+squeeze19 with Suhosin-Patch mod_python/3.3.1 Python/2.6.6 Phusion_Passenger/3.0.7
Last-Modified: Tue, 22 Jul 2014 17:17:00 GMT
ETag: "16c306-a4e9-4fecb64373b00"
Accept-Ranges: bytes
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 8901
Connection: close
Content-Type: text/html

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="readability-verification" content="WMMgm9NJRpLhScSjQYrbY8eang5M9LVB5RMtFNcU"/>
  <meta name="google-site-verification" content="8c4TegFWyWioqBSA_RyiKdOSR9g2JVNodKB4cmfXzcY" />
  <title>DailyJS: A Simple Linked Data and JavaScript Tutorial</title>
  <meta name="author" content="DailyJS Staff" />
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/dailyjs" />
  <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" />
  <link rel="stylesheet" href="/stylesheets/screen.css" type="text/css" />
  <script src="/javascripts/jquery-1.5.1.min.js" type="text/javascript"></script>
  <script src="/javascripts/all.js" type="text/javascript"></script>
  <link href="https://plus.google.com/110075199769457074728/" rel="publisher" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <script type="text/javascript">
    // var disqus_developer = 1; 
  </script>
  <script type="text/javascript">
  var disqus_shortname = 'dailyjs';
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.src = 'http://disqus.com/forums/dailyjs/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
  </script>
  <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-11413789-1");
  pageTracker._trackPageview();
  } catch(err) {}</script>
  <script type="text/javascript">
  /* <![CDATA[ */
      (function() {
          var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
          s.type = 'text/javascript';
          s.async = true;
          s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
          t.parentNode.insertBefore(s, t);
      })();
  /* ]]> */
  </script>
</head>
<body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="http://dailyjs.com">
          DailyJS
        </a>
      </div>
      <ul class="nav">
        <li class="twitter-button"><a href="https://twitter.com/dailyjs" class="twitter-follow-button" data-show-count="false">@dailyjs</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></li>
        <li><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Ffacebook.com%2Fdailyjs&amp;layout=button_count&amp;show_faces=true&amp;width=90&amp;action=like&amp;colorscheme=light&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90px; height:21px;" allowTransparency="true"></iframe></li>
        <li><script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script><div class="g-plusone" data-size="medium" data-annotation="none"></div></li>
        <li><a class="social-button" href="http://feeds.feedburner.com/dailyjs"><img src="/images/icons/feed24.png" alt="Feed" /></a></li>
      </ul>
      <div class="nav-collapse">
        <form class="navbar-search" action="http://www.google.com/search" method="get">
          <input name="sitesearch" type="hidden" value="dailyjs.com" />
          <input type="text" class="search-query" name="q" placeholder="Search">
        </form>
      </div>
    </div>
  </div>
  <div class="subnav">
    <ul class="nav nav-pills">
      <li><a href="/">Home</a></li>
      <li><a href="http://contact.dailyjs.com">Contact</a></li>
      <li><a href="/subscribe.html">Subscribe</a></li>
      <li><a href="/sponsored-content.html">Sponsorship</a></li>
    </ul>
  </div>
  <div id="container">
    <div id="content">
      <h2 class="post"><a href="/2010/11/26/linked-data-and-javascript">A Simple Linked Data and JavaScript Tutorial</a></h2>

<div class="meta">
  26 Nov 2010 |
  <span class="author">By Ric Roberts</span> |
  <span class="tags">
    <img alt="Tags" class="icon" src="/images/tag.gif" />
    
      <a href="/tags.html#linked-data">linked-data</a>
    
      <a href="/tags.html#tutorial">tutorial</a>
    
  </span>
</div>

<div id="post">
<p><img src="/images/posts/linked-data-and-javascript-map.png" alt="" /></p>
<div class="intro">
<p>Disclaimer: This article by Ric is a short tutorial on how to consume Linked Data using JavaScript. Some of the examples use Ric&#8217;s company&#8217;s new Linked Data publishing platform, <a href="http://publishmydata.com">PublishMyData</a>.</p>
</div>

<h3>Introduction</h3>
<p>Mention Linked Data or <span class="caps">RDF</span> and many developers run screaming.  The truth is that <a href="http://www.w3.org/standards/semanticweb/data">Linked Data</a> is really rather simple (and in many cases you don&#8217;t even need to use <a href="http://www.w3.org/RDF/"><span class="caps">RDF</span></a> if you don&#8217;t want to). In this tutorial we&#8217;re going to use jQuery to request some data from a Linked Data service, and then display the results in a table and on a map.  You can see the final result of the tutorial <a href="http://ricroberts.s3.amazonaws.com/linked-data-and-javascript-tutorial.html">here</a> (just view source to see all the code).</p>
<h3>Writing the <span class="caps">SPARQL</span> Query</h3>
<p>We&#8217;ll need to run some <span class="caps">SPARQL</span> to get the data we&#8217;re interested in (<a href="http://www.w3.org/TR/rdf-sparql-query/"><span class="caps">SPARQL</span></a> is a query language analogous to <span class="caps">SQL</span> for relational databases). The following query selects the names and locations (northing and easting) of all the secondary schools in the City of Manchester (<a href="http://statistics.data.gov.uk/id/local-authority-district/00BN">district &#8216;00BN&#8217;</a>).</p>
<div class="highlight"><pre><code class="sql"><span class="k">PREFIX</span> <span class="n">rdfs</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">w3</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="mi">2000</span><span class="o">/</span><span class="mi">01</span><span class="o">/</span><span class="n">rdf</span><span class="o">-</span><span class="k">schema</span><span class="o">#&gt;</span>

<span class="k">SELECT</span> <span class="o">?</span><span class="n">name</span> <span class="o">?</span><span class="n">northing</span> <span class="o">?</span><span class="n">easting</span> <span class="k">WHERE</span> <span class="err">{</span>
  <span class="o">?</span><span class="n">school</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">education</span><span class="p">.</span><span class="k">data</span><span class="p">.</span><span class="n">gov</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">def</span><span class="o">/</span><span class="n">school</span><span class="o">/</span><span class="n">districtAdministrative</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="k">statistics</span><span class="p">.</span><span class="k">data</span><span class="p">.</span><span class="n">gov</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">id</span><span class="o">/</span><span class="k">local</span><span class="o">-</span><span class="n">authority</span><span class="o">-</span><span class="n">district</span><span class="o">/</span><span class="mi">00</span><span class="n">BN</span><span class="o">&gt;</span> <span class="p">.</span>
  <span class="o">?</span><span class="n">school</span> <span class="n">rdfs</span><span class="p">:</span><span class="n">label</span> <span class="o">?</span><span class="n">name</span> <span class="p">.</span>
  <span class="o">?</span><span class="n">school</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">education</span><span class="p">.</span><span class="k">data</span><span class="p">.</span><span class="n">gov</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">def</span><span class="o">/</span><span class="n">school</span><span class="o">/</span><span class="n">phaseOfEducation</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">education</span><span class="p">.</span><span class="k">data</span><span class="p">.</span><span class="n">gov</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">def</span><span class="o">/</span><span class="n">school</span><span class="o">/</span><span class="n">PhaseOfEducation_Secondary</span><span class="o">&gt;</span> <span class="p">.</span>
  <span class="o">?</span><span class="n">school</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="k">data</span><span class="p">.</span><span class="n">ordnancesurvey</span><span class="p">.</span><span class="n">co</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">ontology</span><span class="o">/</span><span class="n">spatialrelations</span><span class="o">/</span><span class="n">northing</span><span class="o">&gt;</span> <span class="o">?</span><span class="n">northing</span> <span class="p">.</span>
  <span class="o">?</span><span class="n">school</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="k">data</span><span class="p">.</span><span class="n">ordnancesurvey</span><span class="p">.</span><span class="n">co</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">ontology</span><span class="o">/</span><span class="n">spatialrelations</span><span class="o">/</span><span class="n">easting</span><span class="o">&gt;</span> <span class="o">?</span><span class="n">easting</span> <span class="p">.</span>
<span class="err">}</span>
</code></pre>
</div>
<h3>Constructing the <span class="caps">URL</span> to call against the endpoint</h3>
<p>The <span class="caps">SPARQL</span> endpoint we&#8217;re using expects requests in the following format:</p>
<p><code>http://sparql.publishmydata.com?query=URL-ENCODED-SPARQL&amp;output=FORMAT</code></p>
<p>We could have used the <code>encodeURI</code> JavaScript function to encode the <span class="caps">SPARQL</span>, but I just copied and pasted the url from the browser&#8217;s address bar after clicking on the &#8220;<span class="caps">JSON</span>&#8221; link under the results on <a href="http://publishmydata.com/sparql?utf8=âœ“&amp;q=PREFIX+rdfs%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0D%0A%0D%0ASELECT+%3Fname+%3Fnorthing+%3Feasting+WHERE+%7B%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FdistrictAdministrative%3E+%3Chttp%3A%2F%2Fstatistics.data.gov.uk%2Fid%2Flocal-authority-district%2F00BN%3E+.+%0D%0A%0D%0A++%3Fschool+rdfs%3Alabel+%3Fname+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FphaseOfEducation%3E+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FPhaseOfEducation_Secondary%3E+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Fdata.ordnancesurvey.co.uk%2Fontology%2Fspatialrelations%2Fnorthing%3E+%3Fnorthing+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Fdata.ordnancesurvey.co.uk%2Fontology%2Fspatialrelations%2Feasting%3E+%3Feasting+.%0D%0A%7D&amp;commit=Execute+Query">this page</a>, where I originally wrote the <span class="caps">SPARQL</span>.</p>
<div class="highlight"><pre><code class="javascript"><span class="p">{</span>
  <span class="s2">&quot;head&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;vars&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span> <span class="p">,</span> <span class="s2">&quot;northing&quot;</span> <span class="p">,</span> <span class="s2">&quot;easting&quot;</span> <span class="p">]</span>
  <span class="p">}</span> <span class="p">,</span>
  <span class="s2">&quot;results&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;bindings&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;literal&quot;</span> <span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Parrs Wood High School&quot;</span> <span class="p">}</span> <span class="p">,</span>
        <span class="s2">&quot;northing&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;datatype&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.w3.org/2001/XMLSchema#integer&quot;</span> <span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;typed-literal&quot;</span> <span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;390094&quot;</span> <span class="p">}</span> <span class="p">,</span>
        <span class="s2">&quot;easting&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;datatype&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.w3.org/2001/XMLSchema#integer&quot;</span> <span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;typed-literal&quot;</span> <span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;385464&quot;</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">...</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The array in <code>head.vars</code> contains the variables that we selected in the <span class="caps">SPARQL</span> query, and <code>results.bindings</code> contains one object per row of results.</p>
<h3>Using jQuery to call the <span class="caps">URL</span></h3>
<p>We&#8217;ll just call the query against the endpoint using jQuery&#8217;s <code>ajax</code> function (but you could use any other framework if you prefer). Notice that we use <a href="http://en.wikipedia.org/wiki/JSON#JSONP"><span class="caps">JSONP</span></a> data type to avoid <a href="http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing"><span class="caps">CORS</span></a> issues.</p>
<div class="highlight"><pre><code class="html"> 
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  <span class="c1">//&lt;![CDATA[</span>
  <span class="kd">var</span> <span class="nx">queryUrl</span> <span class="o">=</span> <span class="s2">&quot;http://publishmydata.com/sparql.json?q=PREFIX+rdfs%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0D%0A%0D%0ASELECT+%3Fname+%3Fnorthing+%3Feasting+WHERE+%7B%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FdistrictAdministrative%3E+%3Chttp%3A%2F%2Fstatistics.data.gov.uk%2Fid%2Flocal-authority-district%2F00BN%3E+.+%0D%0A%0D%0A++%3Fschool+rdfs%3Alabel+%3Fname+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FphaseOfEducation%3E+%3Chttp%3A%2F%2Feducation.data.gov.uk%2Fdef%2Fschool%2FPhaseOfEducation_Secondary%3E+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Fdata.ordnancesurvey.co.uk%2Fontology%2Fspatialrelations%2Fnorthing%3E+%3Fnorthing+.%0D%0A%0D%0A++%3Fschool+%3Chttp%3A%2F%2Fdata.ordnancesurvey.co.uk%2Fontology%2Fspatialrelations%2Feasting%3E+%3Feasting+.%0D%0A%7D&quot;</span><span class="p">;</span>

  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="nx">dataType</span><span class="o">:</span> <span class="s2">&quot;jsonp&quot;</span><span class="p">,</span>  
    <span class="nx">url</span><span class="o">:</span> <span class="nx">queryUrl</span>
  <span class="p">});</span>             
  <span class="c1">//]]&gt;</span>
<span class="nt">&lt;/script&gt;</span>    
</code></pre>
</div>

<h3>Making an <span class="caps">HTML</span> table from the results</h3>
<p>Let&#8217;s create a table in the html:</p>
<div class="highlight"><pre><code class="html">            
<span class="nt">&lt;table</span> <span class="na">id=</span><span class="s">&quot;results&quot;</span><span class="nt">&gt;&lt;/table&gt;</span>   
</code></pre>
</div>
<p>&#8230; and add a <code>success</code> callback, to populate it with the results of the <span class="caps">SPARQL</span>.</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
  <span class="nx">dataType</span><span class="o">:</span> <span class="s2">&quot;jsonp&quot;</span><span class="p">,</span>
  <span class="nx">url</span><span class="o">:</span> <span class="nx">queryUrl</span>
  <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>    
    <span class="c1">// get the table element</span>
    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#results&quot;</span><span class="p">);</span>              

    <span class="c1">// get the sparql variables from the &#39;head&#39; of the data.</span>
    <span class="kd">var</span> <span class="nx">headerVars</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">vars</span><span class="p">;</span> 

    <span class="c1">// using the vars, make some table headers and add them to the table;</span>
    <span class="kd">var</span> <span class="nx">trHeaders</span> <span class="o">=</span> <span class="nx">getTableHeaders</span><span class="p">(</span><span class="nx">headerVars</span><span class="p">);</span>
    <span class="nx">table</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">trHeaders</span><span class="p">);</span>  

    <span class="c1">// grab the actual results from the data.                                          </span>
    <span class="kd">var</span> <span class="nx">bindings</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">bindings</span><span class="p">;</span>

    <span class="c1">// for each result, make a table row and add it to the table.</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">rowIdx</span> <span class="k">in</span> <span class="nx">bindings</span><span class="p">){</span>
      <span class="nx">table</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">getTableRow</span><span class="p">(</span><span class="nx">headerVars</span><span class="p">,</span> <span class="nx">bindings</span><span class="p">[</span><span class="nx">rowIdx</span><span class="p">]));</span>
    <span class="p">}</span> 
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>

<p>In the code above, I&#8217;ve used a few simple helper functions which just loop through the data from the <span class="caps">JSON</span>, and make table rows and cells from it.</p>
<div class="highlight"><pre><code class="javascript"><span class="kd">function</span> <span class="nx">getTableHeaders</span><span class="p">(</span><span class="nx">headerVars</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">trHeaders</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&lt;/tr&gt;&quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">headerVars</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">trHeaders</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&quot;</span> <span class="o">+</span> <span class="nx">headerVars</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/th&gt;&quot;</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">trHeaders</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getTableRow</span><span class="p">(</span><span class="nx">headerVars</span><span class="p">,</span> <span class="nx">rowData</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">tr</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&lt;/tr&gt;&quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">headerVars</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">tr</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">getTableCell</span><span class="p">(</span><span class="nx">headerVars</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">rowData</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">tr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getTableCell</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">,</span> <span class="nx">rowData</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">td</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&lt;/td&gt;&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">fieldData</span> <span class="o">=</span> <span class="nx">rowData</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">];</span>
  <span class="nx">td</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">fieldData</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]);</span>
  <span class="k">return</span> <span class="nx">td</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>
<h3>Plotting the schools on a map</h3>
<p>Now things start to get interesting. To draw the map, we&#8217;ll need to include a couple of external scripts:</p>
<div class="highlight"><pre><code class="html"><span class="c">&lt;!-- Google maps api--&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;http://maps.google.com/maps/api/js?sensor=false&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;/script&gt;</span>

<span class="c">&lt;!-- Ordnance survey Lat-long converter (from: http://mapki.com/wiki/Tools:Snippets) --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;http://www.bdcc.co.uk/LatLngToOSGB.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
</div>
<p>The <code>LatLngToOSGB.js</code> script is for converting northings/eastings into latitude/longitudes.  Frustratingly, Google uses the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System" title="WGS84">World Geodetic System</a>, for lat/long but the <code>NEtoLL</code> function from that library returns values using the <a href="http://en.wikipedia.org/wiki/OSGB36" title="OSGB36">Ordnance Survey National Grid</a>.  So we&#8217;ll need to do a 2-step process to convert them if we want accurate positions for the map points.  The functions below wrap up that conversion for you:</p>
<div class="highlight"><pre><code class="javascript"><span class="c1">// extra conversion functions: Google uses WGS84 whereas the National Grid uses OSGB36</span>
<span class="c1">// (thanks to: http://www.roxburgh.net/projects/googlemaps/)</span>

<span class="c1">// Returns object with attributes lat and lon</span>
<span class="kd">function</span> <span class="nx">ENtoLL84</span><span class="p">(</span><span class="nx">easting</span><span class="p">,</span> <span class="nx">northing</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">vlatlng</span> <span class="o">=</span> <span class="nx">NEtoLL</span><span class="p">(</span><span class="nx">easting</span><span class="p">,</span> <span class="nx">northing</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">OGBToWGS84</span><span class="p">(</span><span class="nx">vlatlng</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">vlatlng</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Returns object with attributes east and north</span>
<span class="kd">function</span> <span class="nx">LL84toEN</span><span class="p">(</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">lon</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">vlatlon</span> <span class="o">=</span> <span class="nx">WGS84ToOGB</span><span class="p">(</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">lon</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">LLtoNE</span><span class="p">(</span><span class="nx">vlatlon</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">vlatlon</span><span class="p">.</span><span class="nx">lon</span><span class="p">);</span>
<span class="p">}</span> 
</code></pre>
</div>
<p>Now we&#8217;ve got that out of the way, lets make a div for the map to live in:</p>
<div class="highlight"><pre><code class="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;map_canvas&quot;</span> <span class="na">style=</span><span class="s">&quot;width:500px; height:500px;&quot;</span><span class="nt">&gt;&lt;/div&gt;</span> 
</code></pre>
</div>

<p>&#8230; and a function to plot the schools&#8217; locations:</p>
<div class="highlight"><pre><code class="javascript"><span class="kd">function</span> <span class="nx">drawMap</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// make a map, centred on Manchester</span>
  <span class="kd">var</span> <span class="nx">manchesterLatLon</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="mf">53.480110</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.237940</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">myOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="nx">center</span><span class="o">:</span> <span class="nx">manchesterLatLon</span><span class="p">,</span>
    <span class="nx">mapTypeId</span><span class="o">:</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">MapTypeId</span><span class="p">.</span><span class="nx">ROADMAP</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;map_canvas&quot;</span><span class="p">),</span> <span class="nx">myOptions</span><span class="p">);</span>
 
  <span class="c1">// add a marker for each school </span>
  <span class="kd">var</span> <span class="nx">bindings</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">bindings</span><span class="p">;</span> 
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">bindings</span><span class="p">)</span> <span class="p">{</span>
  
    <span class="kd">var</span> <span class="nx">schoolData</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">bindings</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
   
    <span class="kd">var</span> <span class="nx">northing</span> <span class="o">=</span> <span class="nx">schoolData</span><span class="p">[</span><span class="s2">&quot;northing&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">easting</span> <span class="o">=</span> <span class="nx">schoolData</span><span class="p">[</span><span class="s2">&quot;easting&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">schoolData</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">];</span>
  
    <span class="c1">// call our 2-step conversion</span>
    <span class="kd">var</span> <span class="nx">latLng</span> <span class="o">=</span> <span class="nx">ENtoLL84</span><span class="p">(</span><span class="nx">easting</span><span class="p">,</span> <span class="nx">northing</span><span class="p">);</span>

    <span class="c1">// make a marker with the label as the school name</span>
    <span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
      <span class="nx">position</span><span class="o">:</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span> <span class="nx">latLng</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">latLng</span><span class="p">.</span><span class="nx">lon</span> <span class="p">),</span>
      <span class="nx">map</span><span class="o">:</span> <span class="nx">map</span><span class="p">,</span>
      <span class="nx">title</span><span class="o">:</span> <span class="nx">name</span>
    <span class="p">});</span>
  <span class="p">}</span> 
<span class="p">}</span> 
</code></pre>
</div>
<p>Now all that&#8217;s left to do is to add the call to <code>drawMap</code> to the ajax success callback.</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="nx">queryUrl</span>
  <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  
    <span class="c1">// ... existing code here</span>
  
    <span class="nx">drawMap</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>
<p>You should now have something that looks a bit like <a href="http://ricroberts.s3.amazonaws.com/linked-data-and-javascript-tutorial.html">this page</a>.</p>
<h3>Useful links</h3>
<ul>
	<li><a href="http://www.w3.org/TR/rdf-sparql-query/"><span class="caps">SPARQL</span> reference</a></li>
	<li><a href="http://www.w3.org/standards/semanticweb/data">Linked Data</a></li>
	<li><a href="http://code.google.com/apis/maps/documentation/javascript/basics.html">Google Maps <span class="caps">API</span></a></li>
	<li><a href="http://www.roxburgh.net/projects/googlemaps/">Converting map grid types</a></li>
	<li><a href="http://mapki.com/wiki/" title="Google Maps wiki">MapKi</a></li>
	<li><a href="http://api.jquery.com/jQuery.ajax/">JQuery Ajax Docs</a></li>
</ul>
</div>

<div id="related">
  <h2>Other Recent Posts</h2>
  <ul class="related-posts">
    
      <li>
        <div>22 Jul 2014</div>
        <a href="/2014/07/22/typescript">TypeScript Week</a>
      </li>
    
      <li>
        <div>21 Jul 2014</div>
        <a href="/2014/07/21/is">Simplifying Conditional Statements with Is</a>
      </li>
    
      <li>
        <div>18 Jul 2014</div>
        <a href="/2014/07/18/lazy-json-undo">Undo with Object.observe</a>
      </li>
    
  </ul>
</div>



<div><br clear="all" /></div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dailyjs';
    var disqus_url = 'http://dailyjs.com/2010/11/26/linked-data-and-javascript/';
    // var disqus_identifier = 'unique_dynamic_id_1234';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
    <div id="sidebar">
  <ul>
    <li>
      <div id="carbonads-container"><div class="carbonad"><div id="azcarbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/12104/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div>
    </li>
    <li class="itemlist">
      <h3>Support</h3>
      <ul class="support">
        <li class="if">
<script src="http://coinwidget.com/widget/coin.js"></script>
<script>
CoinWidgetCom.go({
  wallet_address: "1Gtov23WTQPbj4c6dMaXnXxbvFKc87Lutb"
  , currency: "bitcoin"
  , counter: "count"
  , alignment: "bl"
  , qrcode: true
  , auto_show: false
  , lbl_button: "Donate"
  , lbl_address: "DailyJS:"
  , lbl_count: "donations"
  , lbl_amount: "BTC"
});
</script>
          <p>Support the authors by donating Bitcoins!</p>
        </li>
        <li class="flattr if">
          <a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="http://dailyjs.com"></a>
          <noscript><a href="http://flattr.com/thing/456257/DailyJS" target="_blank">
          <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a></noscript>
        </li>
      </ul>
    </li>
    <li class="itemlist">
      <h3>Subscribe</h3>
      <ul class="subscribe">
        <li class="links">
          <a class="social-button" href="http://twitter.com/dailyjs"><img src="/images/icons/twitter.png" alt="Twitter" /></a>
          <a class="social-button" href="https://www.facebook.com/dailyjs"><img src="/images/icons/facebook.png" alt="Facebook Page" /></a>
          <a class="social-button" href="https://plus.google.com/110075199769457074728/?prsrc=3&rel=author"><img src="/images/icons/google.png" alt="Google+ Page" /></a>
          <a class="social-button" href="http://feeds.feedburner.com/dailyjs"><img src="/images/icons/feed.png" alt="Feed" /></a>
          <a class="social-button" href="http://feedburner.google.com/fb/a/mailverify?uri=dailyjs&amp;loc=en_US"><img src="/images/icons/mail.png" alt="Email" /></a>
        </li>
        <li class="rss">
          <p><a href="http://feeds.feedburner.com/dailyjs"><img src="http://feeds.feedburner.com/~fc/dailyjs?bg=000000&amp;fg=FFFFFF&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a></p>
        </li>
      </ul>
    </li>
    <li class="itemlist staff">
      <h3>Staff</h3>
      <ul>
        <li>
          <h4>Editor-in-Chief</h4>
          <div class="twitter">
            <a href="http://twitter.com/#!/alex_young">
              <img width="48" height="48" src="/images/twitter/alex_young.png" alt="Alex R. Young" />
              <span class="meta">
                <strong class="fullname">Alex R. Young</strong>
                <s>@</s>alex_young
              </span>
            </a>
          </div>
          <h4>Proof-Reading</h4>
          <div class="twitter">
            <a href="http://twitter.com/#!/YukaYoung">
              <img width="48" height="48" src="/images/twitter/YukaYoung.png" alt="Yuka Young" />
              <span class="meta">
                <strong class="fullname">Yuka Young</strong>
                <s>@</s>YukaYoung
              </span>
            </a>
          </div>
        </li>
      </ul>
    </li>
    <li class="itemlist">
      <h3>Buy the Book</h3>
      <ul>
        <li>
          <p style="margin-top: 10px"><a href="http://affiliate.manning.com/idevaffiliate.php?id=1259_343"><img src="/images/young_cover150.jpeg" alt="Node.js in Practice" /></a></p>
          <h4><a href="http://affiliate.manning.com/idevaffiliate.php?id=1259_343">Node.js in Practice</a></h4>
          <p><em>By Alex Young and Marc Harter</em></p>
        </li>
      </ul>
    </li>
    <li class="itemlist">
      <h3>Featured Series</h3>
      <ul>
        <li>
          <h4><a href="/sponsored-content.html">Sponsored Content</a></h4>
          <p>Advertise your JavaScript-related product or service through DailyJS.</p>
        <li>
          <h4><a href="/js101.html">JS101</a></h4>
          <p>New to JavaScript?  Get started here.</p>
        </li>
        <li>
          <h4><a href="/framework.html">Let's Make a Framework</a></h4>
          <p>Learn how client-side frameworks are built, and then build your own.</p>
        </li>
        <li>
          <h4><a href="/web-app.html">Let's Make a Web App</a></h4>
          <p>Build a Node web app.</p>
        </li>
        <li>
          <h4><a href="/history-of-javascript.html">History of JavaScript</a></h4>
          <p>Find out who created JavaScript, and why.</p>
        </li>
      </ul>
    </li>
  </ul>
</div>

    <div id="footer">
      <p>Copyright &copy; DailyJS. | <a href="http://github.com/alexyoung/dailyjs">Site Source</a> | <a href="http://www.glyphicons.com">Glyphicons</a>
      | <a href="/cookies.html">Cookies and Privacy</a></p>
    </div>
  </div>
<script type="text/javascript">
var _sf_async_config={uid:39178,domain:"dailyjs.com"};
(function(){
  function loadChartbeat() {
    window._sf_endpt=(new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src',
       (("https:" == document.location.protocol) ? "https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/" : "http://static.chartbeat.com/") +
       "js/chartbeat.js");
    document.body.appendChild(e);
  }
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
     loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();
</script>
</body>
</html>

